define("modules/clean/events/rollback",["require","exports","tslib","modules/clean/ajax","modules/clean/react/modal","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,r,n,s,o,a,i,l,c){"use strict";function u(e,t,r,n){var o=i.ungettext("Restore this file","Restore %(num)d files",n).format({num:n}),l=i.ungettext("Are you sure you want to restore this file?","Are you sure you want to restore these %(num)d files?",n).format({num:n});return function(){return s.SimpleModal.show({title_text:o,body_html:a.HTML.escape(l).toHTML(),cancel_text:i._("Cancel"),confirm_text:i._("Restore"),confirm_callback:function(){d(e,t,r)}})}}function d(e,t,r,s,a,u){var d,_={ns_to_cs:JSON.stringify((d={},d[t]=r,d))};n.WebProgressRequest({url:"/cmd/restore_changesets",data:_,subject_user:e,progress_text:i._("Restoring files..."),success:function(){l.Notify.success(i._("Finished restoring files.")),a&&a(),s&&(u?o.replace_location(u):o.redirect(new c.URI({path:"/browse_cs/"+e+"/"+t+"/"+r}).toString()))}})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importStar(s),o=r.__importStar(o),t.createRollbackHandler=u,t.rollback=d}),define("modules/clean/react/folder_selector_modal",["require","exports","tslib","react","spectrum/button","spectrum/modal","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/viewer","modules/core/i18n","modules/clean/ux_analytics_utils"],function(e,t,r,n,s,o,a,i,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var d=(function(e){function t(t){var r=e.call(this,t)||this;return r.onPathSelected=function(e){return r.setState({currentFolderSelection:e})},r.onModalAccept=function(){var e=r.state.currentFolderSelection;e&&r.props.onFolderSelected(e)},r.renderPrimaryActionButton=function(e){var t=r.props.primaryAction,o=r.state.currentFolderSelection;return n.default.createElement(s.Button,{variant:"primary",onClick:e,disabled:!o},t)},r.closeModal=function(){r.setState({isOpen:!1}),u.dispatchModalClosed()},r.openModal=function(){return u.dispatchModalOpened()},r.state={currentFolderSelection:"",isOpen:!0},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.secondaryAction,r=e.title,s=e.ariaLabel,a=e.user,u=e.forceRootSelectable;return n.default.createElement(o.UtilityModal,{primaryAction:this.renderPrimaryActionButton,secondaryAction:t,title:r,ariaLabel:s,onPrimaryAction:this.onModalAccept,onRequestClose:this.closeModal,onSecondaryAction:this.closeModal,onReady:this.openModal,open:this.state.isOpen,variant:"regular",shouldFocusAfterRender:!0,overlayClickClose:!0,appElement:document.getElementById("embedded-app")},n.default.createElement("div",{className:"uxa-modal",id:"folder-selector-modal"},n.default.createElement(i.UserFolderTreeView,{user:a,onFolderSelected:this.onPathSelected,treeRootName:l.Viewer.get_role_title(a)||c._("Dropbox"),is_paired:l.Viewer.get_viewer().is_paired,forceRootSelectable:u})))},t.show=function(e){a.Modal.showInstance(n.default.createElement(t,r.__assign({},e)))},t.defaultProps={initialFolderSelection:""},t})(n.default.Component);t.FolderSelectorModal=d}),define("modules/clean/react/trash/actions",["require","exports","tslib","external/immutable","external/lodash","modules/clean/analytics","modules/clean/js_client_stopwatch","modules/clean/react/snackbar","modules/clean/react/trash/api","modules/clean/react/trash/constants","modules/clean/react/trash/purge_confirmation_modal","modules/clean/react/trash/selectors","modules/clean/react/trash/utils","modules/clean/web_timing_logger","modules/constants/ajax_strings","modules/core/i18n","modules/core/notify"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h){"use strict";function g(){h.Notify.error(m.PROBLEM_COMPLETING_REQUEST)}function E(e){var t=e.start_ts,r=e.end_ts,n=e.actor_email,s=e.selected_host_ids,o=e.fq_path;return{start_ts:t||0,end_ts:_.determineMaxTs(r),actor_email:n,host_ids:s,fq_path:o}}function v(){return a.JSStopwatch.create_stopwatch_if_not_exist("maestro_trash_tracing"),function(e,t){return r.__awaiter(this,void 0,void 0,function(){var o,i,u,m,v,y,S,T,I,b,A,R,C,w,F;return r.__generator(this,function(r){switch(r.label){case 0:if(o=t(),i=o.fetchPhase,u=null,null!=i)return[2];m=o.user_id,v=d.getRootNsId(o),y=o.ns_id,S=y||v,r.label=1;case 1:return r.trys.push([1,7,8,9]),e({type:c.START_FETCH_PHASE1}),T=l.tryPrefetchDeletions(m).catch(function(){return l.fetchDeletionsForNamespace({userId:m,nsId:S,filters:E(o),nsIdToCursor:n.Map()})}),T.then(function(){a.JSStopwatch.recordTrace("received_initial_events",{stopwatchName:"maestro_trash_tracing"})}),I=l.tryPrefetchNamespaceList(m).catch(function(){return l.fetchNamespaceList(m)}),I.then(function(){a.JSStopwatch.recordTrace("received_namespace_list",{stopwatchName:"maestro_trash_tracing"})}),[4,Promise.all([T,I])];case 2:return b=r.sent(),A=b[0],R=b[1],p.log_js_modules_fetched_data_required_for_tti(),e({type:c.COMPLETE_FETCH_PHASE1,deletionEvents:A.events,mountedNamespaces:R,requestedNsIdToCursor:A.ns_id_to_cursor||null}),requestAnimationFrame(function(){u=h.Notify.info(f._("Loading deleted files..."),9999)}),[4,_.nextRAF()];case 3:return r.sent(),C=R.map(function(e){return e.ns_id}),y&&(C=s.without(C,y),C.push(v)),C.length>0?[4,l.fetchDeletionsForNamespaceMulti({userId:m,nsIds:C,filters:E(o),nsIdToCursor:n.Map()})]:[3,5];case 4:return w=r.sent(),e({type:c.COMPLETE_FETCH_PHASE2,deletionEvents:w.events,requestedNsIds:w.ns_ids,requestedNsIdToCursor:w.ns_id_to_cursor||null}),[3,6];case 5:e({type:c.COMPLETE_FETCH_PHASE2,deletionEvents:[],requestedNsIds:[],requestedNsIdToCursor:null}),r.label=6;case 6:return[3,9];case 7:throw F=r.sent(),g(),F;case 8:return h.Notify.current()&&h.Notify.current()===u&&h.Notify.clear(),[7];case 9:return[2]}})})}}function y(e){if(e.isLoadingMore||e.fetchPhase!==c.FetchPhase.PHASE3)return!1;var t=e.ns_id,r=e.events;if(t){if(!r.has(t)||r.get(t).done)return!1}else if(r.every(function(e){return e.done}))return!1;return!0}function S(){return function(e,t){return r.__awaiter(this,void 0,void 0,function(){var s,o,a,i,u,d,_;return r.__generator(this,function(r){switch(r.label){case 0:if(s=t(),!y(s))return[2];e({type:c.REQUEST_MORE_DATA}),o=s.ns_id,a=s.events,i=o?[o]:a.filter(function(e){return!e.done}).keySeq().toArray(),u=n.Map(i.map(function(e){return[e,a.has(e)?a.get(e).cursor:c.DELETED_FILES_CURSOR_FETCH_ALL]})),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l.fetchDeletionsForNamespaceMulti({userId:s.user_id,nsIds:i,filters:E(s),nsIdToCursor:u})];case 2:return d=r.sent(),e({type:c.RECEIVE_MORE_DATA,deletionEvents:d.events,requestedNsIds:d.ns_ids,requestedNsIdToCursor:d.ns_id_to_cursor||null}),[3,4];case 3:return _=r.sent(),g(),e({type:c.FAIL_REQUESTING_MORE_DATA}),[3,4];case 4:return[2]}})})}}function T(e,t){return{type:c.REMOVE_ROW,ns_id:e,pkey:t}}function I(e){return function(t){t({type:c.SET_NAMESPACE,ns_id:e}),t(S())}}function b(e,t){return{type:c.SET_USER_ID,userId:e,isNonUserRelativeContext:t}}function A(e){return{type:c.TRASH_INIT,data:r.__assign({},e)}}function R(){return function(e,t){var r=t().user_id;l.markRestoreFilesTipAsSeen(r),e({type:c.DISMISS_RESTORE_FILES_TIP})}}function C(e){return function(t){t({type:c.SET_TIMESTAMP,timestamp_ms:e}),t(S())}}function w(e){return function(t){t({type:c.SET_START_TS,ts:e}),t(S())}}function F(e){return function(t){t({type:c.SET_END_TS,ts:e}),t(S())}}function P(e){return function(t,r){t({type:c.SET_ACTOR_USER_EMAIL,user_email:e});var n=r();e&&!n.user_host_details_map.get(e)&&D(e)(t,r),t(S())}}function D(e){return function(t,r){l.getHostDetailsForActor(r().user_id,e).then(function(r){t({type:c.RECEIVE_HOST_DETAILS,host_details:r,email:e})})}}function N(e){return function(t){t({type:c.SET_HOST_IDS,host_ids:e}),t(S())}}function M(e){return function(t){t({type:c.SET_FQ_PATH,folder_path:e}),t(S())}}function O(){return function(e){e({type:c.CLEAR_FILTERS}),e(S())}}function L(e,t,r){return function(n){n({type:c.SET_TRASH_MODAL_DATA,deletedContentInfo:e,deletorInfo:r,permissions:t})}}function H(e){return function(t,n){return r.__awaiter(this,void 0,void 0,function(){var a,i,c,u,d,_,p,m,f,h,g;return r.__generator(this,function(E){switch(E.label){case 0:for(a=n().user_id,i={},c=0,u=e;c<u.length;c++)d=u[c],_=i[d.ns_id],i[d.ns_id]=_?_.concat(d.cs_info.sjids_for_display):d.cs_info.sjids_for_display;E.label=1;case 1:return E.trys.push([1,3,,4]),p=void 0,p=(function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,o,c,u,d,_;return r.__generator(this,function(r){switch(r.label){case 0:return[4,l.fetchDeletionEventDetailsByNsIdSjIdsBatch({userId:a,nsSjIds:i})];case 1:for(e=r.sent(),t={},n=0,o=e;n<o.length;n++)for(c=o[n],u=0,d=c.event_details;u<d.length;u++)_=d[u],t[_.fq_path]=c.has_acl_restore;return[2,{event_details:s.flatten(e.map(function(e){return e.event_details})),has_acl_restore:t}]}})})})(),[4,x(a,p,t)];case 2:return E.sent(),[3,4];case 3:return m=E.sent(),f=e.map(function(e){return e.ns_id}),h=e.map(function(e){return e.cs_info.cs_id}),g={requested_ns_ids:f.join(","),requested_cs_ids:h.join(","),requested_ns_id_count:f.length},o.WebMiscActivityLogger.log("trash-fetch-events-details-failure",g,a),[3,4];case 4:return[2]}})})}}function k(e,t){return function(n,s){return r.__awaiter(this,void 0,void 0,function(){var a,i,c,u,d;return r.__generator(this,function(r){switch(r.label){case 0:a=s().user_id,t?(i=t.map(function(e){return e.ns_path}),c=t[0].ns_id):(i=[e.currentNSPath],c=e.currentNSID),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,x(a,l.fetchDeletionEventDetailsByPaths({userId:a,nsId:c,nsPaths:i,isAdminConsole:e.isNonUserRelativeContext}),n)];case 2:return r.sent(),[3,4];case 3:return u=r.sent(),d={requested_ns_ids:""+e.currentNSID},o.WebMiscActivityLogger.log("trash-fetch-events-details-failure",d,a),[3,4];case 4:return[2]}})})}}function x(e,t,n){return r.__awaiter(this,void 0,Promise,function(){var e,s,o,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return e=r.sent(),s=e.event_details,o=!(1===s.length&&!s[0].can_display_content),n({type:c.RECEIVE_EVENT_DETAILS,deletionEventDetails:s,canDisplayContent:o,hasAclRestore:e.has_acl_restore}),[3,3];case 2:throw a=r.sent(),h.Notify.error(f._("We were unable to fetch deleted files details.")),n({type:c.FETCH_EVENT_DETAILS_ERROR}),a;case 3:return[2]}})})}function U(e,t){return function(r){r({type:c.SET_PURGE_MODAL_DATA,browseContentInfo:e,deletorInfo:t})}}function B(e,t){return function(n,s){return r.__awaiter(this,void 0,void 0,function(){var a,i,u,d;return r.__generator(this,function(r){switch(r.label){case 0:a=s().user_id,i=t?t.map(function(e){return{ns_id:e.ns_id,ns_path:e.ns_path}}):null!=e.currentNSPath?[{ns_id:e.currentNSID,ns_path:e.currentNSPath}]:[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,W(a,l.fetchPurgeModalEventDetailsByPaths({userId:a,nsPaths:i}),n)];case 2:return r.sent(),[3,4];case 3:return u=r.sent(),d={requested_ns_id:e.currentNSID},n({type:c.FETCH_EVENT_DETAILS_ERROR}),o.WebMiscActivityLogger.log("purge-fetch-event-details-failure",d,a),[3,4];case 4:return[2]}})})}}function W(e,t,n){return r.__awaiter(this,void 0,Promise,function(){var e,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return e=r.sent(),n({type:c.RECEIVE_PURGE_EVENT_DETAILS,purgeEventDetails:e}),[3,3];case 2:throw s=r.sent(),h.Notify.error(f._("We were unable to fetch deleted files details.")),n({type:c.FETCH_EVENT_DETAILS_ERROR}),s;case 3:return[2]}})})}function q(e){return function(t,n){return r.__awaiter(this,void 0,void 0,function(){var s,a,c,d,_,p,m,h,g;return r.__generator(this,function(r){switch(r.label){case 0:if(0===e.length)return[2];s=n().user_id,a=function(t){o.WebMiscActivityLogger.log("purge-deletion-events"+t,{num_paths:e.length},s)},c=function(e){a(e)},i.Snackbar.sync(f._("Deleting files...")),r.label=1;case 1:return r.trys.push([1,6,,7]),[4,l.purgeDeletionEventBatchv2(s,e,{".tag":"deleted_files"})];case 2:return d=r.sent(),void 0!==d&&".tag"in d&&"complete"===d[".tag"]?[4,J(d)]:[3,4];case 3:if(_=r.sent(),_&&_.length>0)i.Snackbar.close(),u.showPurgeConfirmationModal({items:_}),a("some-paths-failed");else{for(l.showDeletionSuccessSnackbar(e),p=0,m=e;p<m.length;p++)h=m[p],t(T(h.ns_id,h.pkey));a("success")}return[3,5];case 4:X(c,d),r.label=5;case 5:return[3,7];case 6:throw g=r.sent(),X(c,g),g;case 7:return[2]}})})}}function V(e){return{type:c.CREATE_SNACKBAR,state:"restoring",count:e}}function j(e,t){return{type:c.UPDATE_SNACKBAR,count:e,quotaStatus:t}}function Y(e){return{type:c.MARK_ROW_AS_RESTORING,pkey:e}}function G(e,t,n){return function(s,o){return r.__awaiter(this,void 0,void 0,function(){var a,i,u,d,_,p,m,f;return r.__generator(this,function(r){switch(r.label){case 0:return 0===e.length?[2]:(a=o(),i=a.user_id,u=a.fq_path,s(V(e.length)),[4,l.restoreDeletionEventBatch(i,e,u||void 0,t,n)]);case 1:return d=r.sent(),"quota_status"in d?(_=d.quota_status[".tag"],"other"===_?[3,3]:[4,s(j(e.length,_))]):[3,3];case 2:r.sent(),r.label=3;case 3:for(p=0,m=e;p<m.length;p++)f=m[p],s(Y(f.pkey));return setTimeout(function(){for(var t=0,r=e;t<r.length;t++){var n=r[t];s(T(n.ns_id,n.pkey))}},c.SNACKBAR_TIMEOUT_MS),[2]}})})}}function z(){return function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,s,o,a,i,u,d;return r.__generator(this,function(r){switch(r.label){case 0:if(n=t(),s=n.shareClient,o=n.currentModalInfo,!(s&&o&&o.eventDetails&&o.hasAclRestore))return[2];if(a=o.eventDetails.map(function(e){return e.fq_path}),!a||0===a.length)return e({type:c.RECEIVE_MEMBERSHIP,membershipInfo:{membershipByFQPath:{},noAccessPaths:[]}}),[2];i=a.filter(function(e){return o.hasAclRestore&&o.hasAclRestore[e]}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l.fetchMembershipForPaths(s,i)];case 2:return u=r.sent(),e({type:c.RECEIVE_MEMBERSHIP,membershipInfo:u}),[3,4];case 3:return d=r.sent(),[2,Promise.resolve()];case 4:return[2]}})})}}function K(e){return function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){return t(e).then(function(){return t(z())}).then(function(){return t({type:c.FINISH_LOADING_MODAL_DATA})}),[2]})})}}function Q(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var a,c,d,_,p;return r.__generator(this,function(r){switch(r.label){case 0:a=function(r){o.WebMiscActivityLogger.log("purge-deletion-paths"+r,{total_paths:t.length},e)},c=function(e){s&&"timed-out"!==e&&s(t),a(e)},i.Snackbar.sync(f._("Deleting files...")),r.label=1;case 1:return r.trys.push([1,6,,7]),[4,l.purgeByPathBatchv2(e,t.map(function(e){return e.fq_path}),{".tag":"trash_can_view"})];case 2:return d=r.sent(),void 0!==d&&".tag"in d&&"complete"===d[".tag"]?[4,J(d)]:[3,4];case 3:return _=r.sent(),_&&_.length>0?(i.Snackbar.close(),u.showPurgeConfirmationModal({items:_}),a("some-paths-failed")):(l.showDeletionSuccessByPathSnackbar(t.length),n&&n(t),a("success")),[3,5];case 4:X(c,d),r.label=5;case 5:return[3,7];case 6:throw p=r.sent(),X(c,p),p;case 7:return[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importStar(s),p=r.__importStar(p),m=r.__importStar(m),t.initiateFetchPhases=v,t.loadMore=S,t.removeRow=T,t.setNamespace=I,t.setUserId=b,t.initialize=A,t.dismissRestoreFilesTip=R,t.setTimestampMs=C,t.setMinDateTs=w,t.setMaxDateTs=F,t.setActorUserEmail=P,t.loadHostsForActorEmail=D,t.setActorHostIds=N,t.setDeletedContainingFqPath=M,t.clearFilters=O,t.initializeModal=L,t.getEventDetailsFromEvents=H,t.getEventDetailsFromBrowse=k,t.initializePurgeModal=U,t.getPurgeEventDetailsFromBrowse=B,t.purgeByDeletionEvents=q,t.showRestoreSnackbar=V,t.updateRestoreSnackbar=j,t.markRowAsRestoring=Y,t.restoreByDeletionEvents=G,t.fetchMembership=z,t.loadModalData=K;var J=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(r){return t=[],e&&"responses"in e&&(t=e.responses.filter(function(e){return"success"!==_.getPurgeState(e.state)&&void 0!==e.path_metadata}).map(function(e){var t=void 0!==e.error_on_path?_.getPurgeError(e.error_on_path):"unknown";return{path:e.fq_path,state:_.getPurgeState(e.state),error_type:t,icon:e.path_metadata.icon,is_folder:e.path_metadata.is_folder}})),[2,t]})})},X=function(e,t){if(null!=t&&t.toString().startsWith("Timed out"))return i.Snackbar.warn(f._("Delete may take more time to complete, please check back later.")),void e("timed-out");var r=void 0;void 0!==t&&".tag"in t&&"failed"===t[".tag"]&&(r=t.failed[".tag"]),"already_purged"===r?i.Snackbar.fail(f._("These files have already been purged.")):"insufficient_permissions"===r?i.Snackbar.fail(f._("You don’t have access to permanently delete the content.")):i.Snackbar.fail(f._("Unable to delete those files.")),e("failed")};t.purgeByPathBatch=Q}),define("modules/clean/react/trash/api",["require","exports","tslib","external/immutable","react","modules/clean/ajax_as_promised","modules/clean/react/trash/client","modules/clean/react/trash/constants","modules/clean/analytics","modules/clean/sharing/api/util/types","modules/clean/sharing/ui_util","modules/core/i18n","modules/clean/react/snackbar","modules/clean/react_format"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p){"use strict";function m(e,t,n){return void 0===n&&(n={}),function(s){"abort"!==s.jqXHR.statusText&&l.WebMiscActivityLogger.log(t,r.__assign({},n,{is_prefetch:!1}),e)}}function f(e,t,n){return void 0===n&&(n={}),function(){return l.WebMiscActivityLogger.log(t,r.__assign({},n,{is_prefetch:!0}),e)}}function h(e,t,r){void 0===r&&(r={}),l.WebMiscActivityLogger.log(t,r,e)}function g(e){return"async_job_id"===e[".tag"]}function E(e){var t=window.__REGISTER_TRASH_PRELOAD_HANDLER;if(t){var r=new Promise(function(e,r){t(function(t){try{e(JSON.parse(t))}catch(e){r()}},r)});return r.catch(f(e,"trash-fetch-deletions-failure",{requested_ns_count:1})),r}return Promise.reject(null)}function v(e,t){return t.namespaces.map(function(t){return{name:t.name,user_id:e,ns_id:t.nsId}})}function y(e){var t=window.__REGISTER_TRASH_NS_LIST_PRELOAD_HANDLER;if(t){var r=new Promise(function(r,n){t(function(t){try{r(v(e,JSON.parse(t)))}catch(e){n()}},n)});return r.catch(f(e,"trash-fetch-ns-list-failure")),r}return Promise.reject(null)}function S(e){var t=o.BackgroundRequest({type:"GET",url:"/trash/namespace_list",subject_user:e,dataType:"json"});return t.catch(m(e,"trash-fetch-ns-list-failure")),t.then(function(t){return v(e,t)})}function T(e){return I({userId:e.userId,nsIds:[e.nsId],filters:e.filters,nsIdToCursor:e.nsIdToCursor})}function I(e){var t={ns_ids:e.nsIds.join(","),ns_id_to_cursor:JSON.stringify(e.nsIdToCursor)};t.start_ts=e.filters.start_ts,t.end_ts=e.filters.end_ts,t.actor_email=e.filters.actor_email,t.host_ids=e.filters.host_ids?e.filters.host_ids.join(","):null,t.fq_path=e.filters.fq_path;var r=o.BackgroundRequest({type:"POST",url:"/deleted_files_with_mixed_cs/ajax",subject_user:e.userId,dataType:"json",data:t});return r.catch(m(e.userId,"trash-fetch-deletions-failure",{requested_ns_count:e.nsIds.length})),r}function b(e){return o.SilentBackgroundRequest({url:"/trash/seen_restore_files_tip",subject_user:e})}function A(e){return r.__awaiter(this,void 0,Promise,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object.keys(e.nsSjIds)[0],n={_subject_uid:e.userId,ns_id:Number(t),sjids:e.nsSjIds[Number(t)].join(",")},[4,o.BackgroundRequest({type:"POST",url:"/trash_details/ajax_by_sjids",dataType:"json",data:n})];case 1:return[2,r.sent()]}})})}function R(e){return r.__awaiter(this,void 0,Promise,function(){var t;return r.__generator(this,function(r){switch(r.label){case 0:return t={_subject_uid:e.userId,ns_sj_ids:JSON.stringify(e.nsSjIds)},[4,o.BackgroundRequest({type:"POST",url:"/trash_details/ajax_by_sjids_batch",dataType:"json",data:t})];case 1:return[2,r.sent()]}})})}function C(e){for(var t={},r=0,n=e.event_details;r<n.length;r++){t[n[r].fq_path]=e.has_acl_restore}return{event_details:e.event_details,has_acl_restore:t}}function w(e){return r.__awaiter(this,void 0,Promise,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t={_subject_uid:e.userId,ns_id:e.nsId,ns_paths:e.nsPaths,recursive:!0,admin_console:e.isAdminConsole||!1},[4,o.BackgroundRequest({type:"POST",url:"/trash_details/ajax_by_path",dataType:"json",data:t})];case 1:return n=r.sent(),[2,C(n)]}})})}function F(e){return r.__awaiter(this,void 0,Promise,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=new a.RestoreClient(e.userId),[4,t.getPurgeDetailsByPath(e.userId,e.nsPaths)];case 1:return n=r.sent(),[2,n.ns_details]}})})}function P(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var o,i,l,c,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return o=t.ns_id,i=t.cs_info.cs_id,l=new a.RestoreClient(e),[4,l.restoreTrueDeletions(o,i,n,s)];case 1:return c=r.sent(),"async_job_id"!==c[".tag"]?[3,3]:(d=(u=Promise).resolve,[4,l.pollAsyncRestoreStatus(c.async_job_id)]);case 2:return[2,d.apply(u,[r.sent()])];case 3:return[2,Promise.resolve(c)]}})})}function D(e,t,n,s,o){return r.__awaiter(this,void 0,Promise,function(){var i,l,c,u,d,_;return r.__generator(this,function(r){switch(r.label){case 0:for(i=[],l=0,c=t;l<c.length;l++)u=c[l],i.push({ns_id:u.ns_id,cs_id:u.cs_info.cs_id});return d=new a.RestoreClient(e),[4,d.restoreTrueDeletionBatch(i,n,s,o)];case 1:return _=r.sent(),g(_)?[2,d.pollAsyncRestoreStatus(_.async_job_id)]:[2,Promise.resolve(_)]}})})}function N(e,t,n){return r.__awaiter(this,void 0,Promise,function(){var s,o,a,l;return r.__generator(this,function(r){switch(r.label){case 0:(void 0===n||n<0)&&(n=i.ASYNC_JOB_POLL_TIMEOUT_MS),s=!1,setTimeout(function(){if(!s)throw new Error("Timed out in "+n+"ms.")},n),o=!0,a=void 0,r.label=1;case 1:r.trys.push([1,5,6,7]),r.label=2;case 2:return o?[4,e.getAsyncPurgeStatus(t)]:[3,4];case 3:return a=r.sent(),o="in_progress"===a[".tag"],[3,2];case 4:return void 0!==a&&"in_progress"!==a[".tag"]?[2,a]:[3,7];case 5:throw l=r.sent();case 6:return s=!0,[7];case 7:throw new Error("didn't return any result")}})})}function M(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var s,o,l,c,u,d;return r.__generator(this,function(r){switch(r.label){case 0:for(s=[],o=0,l=t;o<l.length;o++)c=l[o],s.push({ns_id:c.ns_id,cs_id:c.cs_info.cs_id});return u=new a.RestoreClient(e),[4,u.purgeTrueDeletionsBatch(s,n)];case 1:return d=r.sent(),g(d)?[4,N(u,d.async_job_id,i.ASYNC_JOB_POLL_TIMEOUT_MS)]:[3,3];case 2:return[2,r.sent()];case 3:return[2,d]}})})}function O(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var s,o;return r.__generator(this,function(r){switch(r.label){case 0:return s=new a.RestoreClient(e),[4,s.purgeByPathBatch(t,n)];case 1:return o=r.sent(),g(o)?[4,N(s,o.async_job_id,i.ASYNC_JOB_POLL_TIMEOUT_MS)]:[3,3];case 2:return[2,r.sent()];case 3:return[2,o]}})})}function L(e){if(0!==e.length){var t,r=e[0].reference_file_name,n=e.reduce(function(e,t){return e+(t.is_folder?1:t.file_count)},0);t=1===n?d._("<strong>%(filename)s</strong> was deleted successfully."):d.ungettext("<strong>%(filename)s</strong> and 1 other item were deleted successfully.","<strong>%(filename)s</strong> and %(num_other)d other items were deleted successfully.",n-1),_.Snackbar.generic(p.reactFormat(t.format({filename:r,num_other:n-1}),{strong:s.default.createElement("strong",null)}),"deletion-success")}}function H(e,t){return r.__awaiter(this,void 0,void 0,function(){var s,o,a,i,l,d,_,p,m;return r.__generator(this,function(r){switch(r.label){case 0:return 0===t.length?[2,{membershipByFQPath:{},noAccessPaths:[]}]:[4,e.ns("sharing").rpc("preview_restored_acl/batch_nsids",{entries:t},{subjectUserId:e.userId})];case 1:for(s=r.sent(),o={},a=[],i=0,l=s.entries;i<l.length;i++)d=l[i],_=d.result,"path_error"===_[".tag"]&&"no_access"===_.path_error[".tag"]&&a.push(d.path),"shared_folder"===_[".tag"]&&(o[d.path]=c.membershipApiToRecord(_.members));return[4,e._addAccountsToMembershipBatch(n.Map(o))];case 2:return p=r.sent(),m={},p.forEach(function(e,t){m[t]={groups:e.groups.valueSeq().map(u.apiGroupMemberToAvatarInfo).toArray(),invitees:e.invitees.valueSeq().map(u.apiInviteeMemberToAvatarInfo).toArray(),users:e.users.valueSeq().map(u.apiUserMemberToAvatarInfo).toArray()}}),[2,{membershipByFQPath:m,noAccessPaths:a}]}})})}function k(e,t){return r.__awaiter(this,void 0,Promise,function(){var n,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,o.BackgroundRequest({url:"/account/get_connected_devices_for_team_member",subject_user:e,data:{user_email:t},dataType:"json"})];case 1:return n=r.sent(),"ok"===n.status?[2,n.hosts]:[3,3];case 2:return s=r.sent(),[3,3];case 3:return[2,{}]}})})}function x(e){if(0!==e){var t;t=1===e?d._("Permanently deleted 1 item."):d.ungettext("Permanently deleted %(num)s item.","Permanently deleted %(num)s items.",e),_.Snackbar.generic(p.reactFormat(t.format({num:e})),"deletion-success")}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importDefault(s),u=r.__importStar(u),t.logPurgeModalActivity=h,t.tryPrefetchDeletions=E,t.tryPrefetchNamespaceList=y,t.fetchNamespaceList=S,t.fetchDeletionsForNamespace=T,t.fetchDeletionsForNamespaceMulti=I,t.markRestoreFilesTipAsSeen=b,t.fetchDeletionEventDetailsByNsIdSjIds=A,t.fetchDeletionEventDetailsByNsIdSjIdsBatch=R,t.fetchDeletionEventDetailsByPaths=w,t.fetchPurgeModalEventDetailsByPaths=F,t.restoreDeletionEvent=P,t.restoreDeletionEventBatch=D,t.pollAsyncPurgeStatus=N,t.purgeDeletionEventBatchv2=M,t.purgeByPathBatchv2=O,t.showDeletionSuccessSnackbar=L,t.fetchMembershipForPaths=H,t.getHostDetailsForActor=k,t.showDeletionSuccessByPathSnackbar=x}),define("modules/clean/react/trash/client",["require","exports","modules/clean/api_v2/user_client"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.client=new r.UserApiV2Client,this.userId=e}return e.prototype.restoreTrueDeletions=function(e,t,r,n){return this.client.ns("restorations").rpc("changeset/restore_true_deletions",{ns_id:e,cs_id:t,path:r,initiation_location:n},{subjectUserId:this.userId})},e.prototype.restoreTrueDeletionBatch=function(e,t,r,n){return this.client.ns("restorations").rpc("changeset/restore_true_deletions_batch",{ns_cs_ids:e,path:t,initiation_location:r,restore_id:n&&n.value},{subjectUserId:this.userId})},e.prototype.getPurgeDetailsByPath=function(e,t){return this.client.ns("restorations").rpc("purge/get_details_by_path",{ns_paths:t},{subjectUserId:this.userId})},e.prototype.pollAsyncRestoreStatus=function(e){var t=this.client,r=this.userId;return t.ns("restorations").rpc("changeset/restore_true_deletions/job_status/check",{async_job_id:e},{subjectUserId:r})},e.prototype.purgeTrueDeletionsBatch=function(e,t){return this.client.ns("restorations").rpc("changeset/purge_true_deletions_batch",{ns_cs_ids:e,initiation_location:t},{subjectUserId:this.userId})},e.prototype.purgeByPathBatch=function(e,t){return this.client.ns("restorations").rpc("purge/by_path_batch",{fq_paths:e,initiation_location:t},{subjectUserId:this.userId})},e.prototype.getAsyncPurgeStatus=function(e){return this.client.ns("restorations").rpc("purge/job_status/check",{async_job_id:e},{subjectUserId:this.userId})},e})();t.RestoreClient=n}),define("modules/clean/react/trash/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_DAY_MS=864e5;(function(e){e[e.PHASE1=1]="PHASE1",e[e.PHASE2=2]="PHASE2",e[e.PHASE3=3]="PHASE3"})(t.FetchPhase||(t.FetchPhase={})),t.MAX_FILE_COUNT_TO_DISPLAY=100,t.MODAL_ITEM_ROW_HEIGHT=64,t.ACL_RESTORE_MODAL_ROW_HEIGHT=72,t.MODAL_MAX_SHOWN_AVATARS=5,t.TRASH_VIEW_COLUMN_MULTISELECT_FLEX=["0 0 36px",3,2],t.TRASH_VIEW_COLUMN_FLEX=[3,2],t.DELETED_FILES_CURSOR_FETCH_ALL=0,t.DELETED_FILES_CURSOR_DONE=-1,t.SNACKBAR_TIMEOUT_MS=3e3,t.ASYNC_JOB_POLL_TIMEOUT_MS=3e4,t.START_FETCH_PHASE1="START_FETCH_PHASE1",t.COMPLETE_FETCH_PHASE1="COMPLETE_FETCH_PHASE1",t.COMPLETE_FETCH_PHASE2="COMPLETE_FETCH_PHASE2",t.REQUEST_MORE_DATA="REQUEST_MORE_DATA",t.RECEIVE_MORE_DATA="RECEIVE_MORE_DATA",t.FAIL_REQUESTING_MORE_DATA="FAIL_REQUESTING_MORE_DATA",t.SET_NAMESPACE="SET_NAMESPACE",t.SET_TIMESTAMP="SET_TIMESTAMP",t.SET_START_TS="SET_START_TS",t.SET_END_TS="SET_END_TS",t.SET_ACTOR_USER_EMAIL="SET_ACTOR_USER_EMAIL",t.RECEIVE_HOST_DETAILS="RECEIVE_HOST_DETAILS",t.SET_HOST_IDS="SET_HOST_IDS",t.SET_FQ_PATH="SET_FQ_PATH",t.CLEAR_FILTERS="CLEAR_FILTERS",t.TRASH_INIT="TRASH_INIT",t.REMOVE_ROW="REMOVE_ROW",t.MARK_ROW_AS_RESTORING="MARK_ROW_AS_RESTORING",t.DISMISS_RESTORE_FILES_TIP="DISMISS_RESTORE_FILES_TIP",t.SET_USER_ID="SET_USER_ID",t.UPDATE_SNACKBAR="UPDATE_SNACKBAR",t.CREATE_SNACKBAR="CREATE_SNACKBAR",t.SET_TRASH_MODAL_DATA="SET_TRASH_MODAL_DATA",t.RECEIVE_EVENT_DETAILS="RECEIVE_EVENT_DETAILS",t.FETCH_EVENT_DETAILS_ERROR="FETCH_EVENT_DETAILS_ERROR",t.RECEIVE_MEMBERSHIP="RECEIVE_MEMBERSHIP",t.FINISH_LOADING_MODAL_DATA="FINISH_LOADING_MODAL_DATA",t.RECEIVE_PURGE_EVENT_DETAILS="RECEIVE_PURGE_EVENT_DETAILS",t.SET_PURGE_MODAL_DATA="SET_PURGE_MODAL_DATA",t.PURGE_HELP_PAGE_LINK="https://www.dropbox.com/help/desktop-web/delete-files#permanent_delete",t.PERSONAL_ITEMS="personal_items",t.SHARED_FOLDERS_OWNED="shared_folders_owned",t.ITEMS_OWNED_WITHIN_SHARED="items_owned_within_shared_folders",t.SHARED_FOLDERS_WITH_ACCESS="shared_folders_with_access",t.ITEMS_NOT_OWNED_WITHIN_SHARED="items_not_owned_within_shared_folders",t.SHARED_FOLDERS_WITHOUT_ACCESS="shared_folders_without_access",t.OFF_TEAM="off_team",t.MEMBER="member",t.ADMIN="admin",t.NON_TEAM="non_team";(function(e){e.NONE="none",e.SOME="some",e.ALL="all"})(t.EventViewState||(t.EventViewState={})),t.BODY_BANNER="body_banner",t.SELECTABLE_LIST_TILES_PER_ROW=1,t.descriptionGenerator={personal_items:{one:r._("<strong>%(filename)s</strong> will be gone forever and you       won’t be able to restore it. Permanently deleting items       won’t free up space."),moreThanOne:function(e){return r.ungettext("<strong>%(filename)s</strong> and %(count)s more item will be gone forever and you       won’t be able to restore them. Permanently deleting these items       won’t free up space.","<strong>%(filename)s</strong> and %(count)s more items will be gone forever and you       won’t be able to restore them. Permanently deleting these items       won’t free up space.",e)}},shared_folders_owned:{one:r._("<strong>%(filename)s</strong> will be gone forever for       everyone, including for anyone still using the shared folder. Permanently       deleting folders won’t free up space."),moreThanOne:function(e){return r.ungettext("<strong>%(filename)s</strong> and %(count)s more item will be gone forever for       everyone, including for anyone still using the shared folders. Permanently       deleting folders won’t free up space.","<strong>%(filename)s</strong> and %(count)s more items will be gone forever for       everyone, including for anyone still using the shared folders. Permanently       deleting folders won’t free up space.",e)}},items_owned_within_shared_folders:{one:r._("<strong>%(filename)s</strong> will be gone forever for       everyone, including for anyone still using the file. Permanently deleting       items won’t free up space."),oneFolder:r._("<strong>%(filename)s</strong> will be gone forever for       everyone, including for anyone still using the folder. Permanently       deleting this folder won’t free up space."),moreThanOne:function(e){
return r.ungettext("<strong>%(filename)s</strong> and %(count)s more item will be gone forever for       everyone, including for anyone still using the items. Permanently deleting       items won’t free up space.","<strong>%(filename)s</strong> and %(count)s more items will be gone forever for       everyone, including for anyone still using the items. Permanently deleting       items won’t free up space.",e)}},shared_folders_with_access:{one:r._("<strong>%(filename)s</strong> is shared with       you, but you’re not the owner. It’ll be removed from your account, but not       deleted for anyone else. Removing your access won’t free up space."),moreThanOne:function(e){return r.ungettext("<strong>%(filename)s</strong> and %(count)s more item is shared with       you, but you’re not the owner. They’ll be removed from your account, but not       deleted for anyone else. Removing your access won’t free up space.","<strong>%(filename)s</strong> and %(count)s more items are shared with       you, but you’re not the owner. They’ll be removed from your account, but not       deleted for anyone else. Removing your access won’t free up space.",e)}},body_banner:{one:r._("<strong>%(filename)s</strong> will be gone forever and you       can’t undo this action. Keep in mind that permanently deleting this won’t       free up space. <a>Learn more</a>"),moreThanOne:function(e){return r.ungettext("<strong>%(filename)s</strong> and %(count)s more item will be gone forever and you       can’t undo this action. Keep in mind that permanently deleting these items won’t       free up space. <a>Learn more</a>","<strong>%(filename)s</strong> and %(count)s more items will be gone forever and you       can’t undo this action. Keep in mind that permanently deleting these items won’t       free up space. <a>Learn more</a>",e)}},shared_folders_without_access:{one:r._("You no longer have access to <strong>%(filename)s</strong>.       You can’t make any changes to it, but you can hide it from your view. Hiding       folders won’t free up space."),moreThanOne:function(e){return r.ungettext("You no longer have access to <strong>%(filename)s</strong>. and %(count)s more item.       You can’t make any changes to it, but you can hide it from your view. Hiding       folders won’t free up space.","You no longer have access to <strong>%(filename)s</strong>. and %(count)s more items.       You can’t make any changes to it, but you can hide it from your view. Hiding       folders won’t free up space.",e)}}},t.RestoreResultDescriptions={not_overquota:function(e){return r.ungettext("Successfully restored %(num)s item.","Successfully restored %(num)s items.",e)},normal_overquota:function(e){return r.ungettext("Restored but can’t sync until you free up space.","Restored %(num)s items, but can’t sync until you free up space.",e)},locked_state:function(e){return r.ungettext("Restored but can’t sync. Your team no longer has full use of %(trademark_business)s features.","Restored %(num)s items, but can’t sync. Your team no longer has full use of %(trademark_business)s features.",e)}}}),define("modules/clean/react/trash/purge_confirmation_modal",["require","exports","tslib","react","external/react-redux","spectrum/file_icon","spectrum/icon_content","spectrum/media_table","spectrum/table","spectrum/modal","modules/clean/react/icon/folder_icon","spectrum/icon_status","modules/clean/react/modal","modules/clean/react/trash/constants","modules/core/i18n","modules/clean/react/css","modules/clean/react/trash/store","modules/clean/filepath","modules/clean/react/file_path_breadcrumb"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h,g,E){"use strict";function v(e,t,r,s){return r?n.default.createElement(a.IconContent,{name:u.convertLegacyFolderIconToSpectrum(e,s)}):n.default.createElement(o.FileIcon,{path:t,variant:s})}function y(e){return"insufficient_permissions"===e||"unauthorized_namespace"===e?m._("Ask the owner to help permanently delete this",{comment:"Field in modal text, should be kept short."}):m._("Try permanently deleting this again",{comment:"Field in modal text, should be kept short."})}function S(){return n.default.createElement("div",{className:"purge-confirmation-modal__header"},n.default.createElement("div",{id:"title-name",className:"purge-confirmation-modal__header__name"},m._("Not permanently deleted")),n.default.createElement("div",{id:"title-reason"},m._("What can you do")))}function T(e){if(e){for(var t=[{name:"Dropbox",url:""}],r=0,s=e.split("/");r<s.length;r++){var o=s[r];t.push({name:o,url:""})}return t.pop(),n.default.createElement("span",{className:"purge-confirmation-path"},n.default.createElement(E.FilePathBreadcrumb,{paths:t,useLinks:!1,pathClassname:"purge-confirmation-path__item",maxWidth:25}))}}function I(e){_.Modal.showInstance(n.default.createElement(t.PurgeConfirmationModal,r.__assign({},e)))}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var b=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isModalOpen:!0},t.createSingleModalItem=function(e,r,s){var o=e.path,a=e.state,l=e.error_type,c=e.icon,u=e.is_folder,_=g.filename(o),p="success"!==a?y(l):void 0;return n.default.createElement(i.CulledMediaRow,{className:"mc-table-row-culled",key:o,topOffset:s,doubleLine:!0},function(){return[n.default.createElement(i.MediaCell,{key:"item_name",highlight:!1,icon:v(c,_,u,"small"),title:t.renderFileName(_),subtitle:T(o)}),n.default.createElement(i.MediaCell,{key:"error_icon",highlight:!1,icon:"success"!==a?n.default.createElement(d.IconStatus,{name:"warn"}):n.default.createElement(d.IconStatus,{name:"complete"}),title:t.renderWarnText(p),variant:"detail"})]})},t.onClose=function(){t.setState({isModalOpen:!1})},t}return r.__extends(t,e),t.prototype.renderPreviewUnavailable=function(){return n.default.createElement("div",{id:"modal-empty-state",className:"modal-empty"},n.default.createElement("h3",null,m._("Permanent deletion details are not available.")))},t.prototype.renderFileName=function(e){return n.default.createElement("span",{className:"item-row-name"},e)},t.prototype.renderWarnText=function(e){return n.default.createElement("span",{className:"purge-description-text"},e)},t.prototype.renderListView=function(){return n.default.createElement(l.CulledTableBody,{items:this.props.items,className:"mc-table-body mc-table-body-culled modal-table-contents",listItemHeight:p.ACL_RESTORE_MODAL_ROW_HEIGHT,renderRow:this.createSingleModalItem,shouldUseWindowAsScrollContainer:!1})},t.prototype.getTitle=function(){var e=this.props.items;return 1===e.length?m._("1 item couldn’t be permanently deleted"):m.ungettext("%(num)s item couldn’t be permanently deleted","%(num)s items couldn’t be permanently deleted",e.length).format({num:e.length})},t.prototype.renderTableContents=function(){return 0===this.props.items.length?this.renderPreviewUnavailable():this.renderListView()},t.prototype.render=function(){return n.default.createElement(c.UtilityModal,{displayCloseButton:!1,overlayClickClose:!0,ariaLabel:m._("Purge Confirmation"),className:"purge-confirmation-modal",open:this.state.isModalOpen,overlayClassName:"purge-confirmation-modal--overlay",onRequestClose:this.onClose,onPrimaryAction:this.onClose,primaryAction:m._("OK"),title:this.getTitle()},n.default.createElement("div",{className:"uxa-modal",id:"purge-confirmation-modal"},n.default.createElement("div",{className:"purge-confirmation-modal__border"},n.default.createElement(l.Table,null,n.default.createElement(S,null),this.renderTableContents()))))},t})(n.default.Component);t.InternalPurgeConfirmationModal=b;var A=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(s.Provider,{store:h.TrashStore},n.default.createElement(b,r.__assign({},this.props)))},t})(n.default.Component);t.PurgeConfirmationModal=f.requireCssWithComponent(A,["/static/css/trash-vflqvZ2WB.css"]),t.showPurgeConfirmationModal=I}),define("modules/clean/react/trash/purge_modal",["require","exports","tslib","react","spectrum/button","external/react-redux","spectrum/modal","modules/clean/em_string","modules/clean/ux_analytics_utils","modules/clean/react/css","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/trash/constants","modules/clean/react/trash/store","modules/core/i18n","modules/clean/react/trash/api","modules/clean/components/loading_indicator"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h){"use strict";function g(e){return _.descriptionGenerator[e]}function E(e){var t=e.currentModalInfo,r=t.deletedContentInfo,n=t.error,s=t.readyToDisplayContent,o=0;if(void 0!==r.ns_info)for(var a=0,i=r.ns_info;a<i.length;a++){var l=i[a];o+=l.isOneCompleteFolder?1:l.fileCount}else o=r.fileCount;return{error:n,totalFileCount:o,fileName:r.fileName,fqPaths:r.fqPaths,referenceFileName:r.referenceFileName,readyToDisplayContent:s,userId:e.user_id,namespacesInfo:void 0!==r.ns_info?r.ns_info:[]}}function v(e){d.Modal.showInstance(n.default.createElement(t.PurgeModal,r.__assign({},e)))}function y(e,t,r,n,s){var o=n!==_.NON_TEAM,a=r+t>0;return o?!a&&s:s}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement("fieldset",{id:"form-entry",className:"purge-info-form-entry"},n.default.createElement("div",{id:"entry-title",className:"purge-info-form-entry__title"},this.props.title),n.default.createElement("div",{id:"entry-description",className:"purge-info-form-entry__description"},this.props.description))},t.displayName="PurgeInfoEntry",t})(n.default.Component),T=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement("fieldset",{id:"simple-modal-content"},n.default.createElement("div",{id:"simple-modal-content"},this.props.description))},t.displayName="SimplePurgeInfo",t})(n.default.Component),I=c.requireCssWithComponent(S,["/static/css/trash-vflqvZ2WB.css"]),b=c.requireCssWithComponent(T,["/static/css/modal-vflYDGbgV.css"]),A=(function(e){function t(){var s=null!==e&&e.apply(this,arguments)||this;return s.state={isModalOpen:!0},s.onRequestClose=function(){s.props.error&&f.logPurgeModalActivity(s.props.userId,"purge-modal-error"),s.setState({isModalOpen:!1}),l.dispatchModalClosed()},s.onReady=function(){l.dispatchModalOpened()},s.onPrimary=function(){var e=s.getTabsWithPolicyInfo(),t=[];if(e.forEach(function(e,r){t=t.concat(e)}),void 0!==s.props.onPurge){s.props.onPurge();var r={policies:t.join(",")};f.logPurgeModalActivity(s.props.userId,"purge-modal-do-action",r)}},s._render_body_banner=function(){var e=s.props,r=e.referenceFileName,o=e.totalFileCount,a=s.isOneFolder();return n.default.createElement(b,{description:u.reactFormat(t.getDescription(_.BODY_BANNER,r,o,a),{a:n.default.createElement("a",{href:_.PURGE_HELP_PAGE_LINK,target:"_blank",rel:"noopener noreferrer"}),strong:n.default.createElement("strong",null)})})},s._renderListHeader=function(){return n.default.createElement(I,{title:t.getStrong(m._("You selected")),description:t.getStrong(m._("What will happen"))})},s._renderPolicyListEntry=function(e,s){var o=t.getPolicyInfo(e,s);return n.default.createElement(I,r.__assign({},o))},s._renderPolicy=function(e){var t=s.getSimpleDescription(e);return n.default.createElement(b,r.__assign({},t))},s.helpLinkCreator=function(){return n.default.createElement("span",null,u.reactFormat(m._("<a>Learn more</a>"),{a:n.default.createElement("a",{href:_.PURGE_HELP_PAGE_LINK,target:"_blank",rel:"noopener noreferrer"})}))},s}return r.__extends(t,e),t.renderError=function(){return n.default.createElement("div",{id:"modal-error-state"},n.default.createElement("h3",null,m._("Oops! An error occurred. Please try again later!")))},t.renderLoader=function(){return n.default.createElement("div",{id:"purge-modal-loading"},n.default.createElement(h.LoadingIndicator,{style:h.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER}))},t.prototype.renderDisabled=function(e){var t=this.props,r=t.referenceFileName,s=t.totalFileCount;switch(e.userType){case _.ADMIN:return n.default.createElement("div",null,u.reactFormat(m.ungettext("You can permanently delete %(filename)s only in the <a>admin console</a>.","You can permanently delete these items only in the <a>admin console</a>.",s).format({filename:r}),{a:n.default.createElement("a",{href:"/team/admin/content/home",target:"_blank",rel:"noopener noreferrer"})}));case _.MEMBER:return n.default.createElement("div",null,m.ungettext("Only an admin can permanently delete %(filename)s.","Only an admin can permanently delete these items.",s).format({filename:r}));default:return n.default.createElement("div",null,m.ungettext("You do not have permission to permanently delete %(filename)s.","You do not have permission to permanently delete these items.",s).format({filename:r}))}},t.getNonOwnedDesc=function(e){switch(e){case _.ADMIN:return u.reactFormat(m._("Nothing, they won’t be deleted forever or hidden. You can         permanently delete them in the <a>admin console</a>"),{a:n.default.createElement("a",{href:"/team/admin/content/home",target:"_blank",rel:"noopener noreferrer"})});case _.MEMBER:return u.reactFormat(m._("Nothing, they won’t be deleted forever or hidden. Only an admin           can permanently delete these items."));case _.OFF_TEAM:case _.NON_TEAM:default:return u.reactFormat(m._("Nothing, they won’t be deleted forever or hidden. Only the owner           can permanently delete these items."))}},t.getStrong=function(e){return u.reactFormat(m._("<strong>%(description)s</strong>"),{description:e,strong:n.default.createElement("strong",null)})},t.getPolicyInfo=function(e,r){var n=r.userType;switch(e){case _.PERSONAL_ITEMS:return{title:u.reactFormat(m._("Items only you can access")),description:u.reactFormat(m._("Deleted forever."))};case _.SHARED_FOLDERS_OWNED:return{title:u.reactFormat(m._("Shared folders you own")),description:u.reactFormat(m._("Deleted forever for everyone, including for anyone             still using them."))};case _.ITEMS_OWNED_WITHIN_SHARED:return{title:u.reactFormat(m._("Items you added to a shared folder")),description:u.reactFormat(m._("Deleted forever for everyone, including for anyone             still using them."))};case _.SHARED_FOLDERS_WITH_ACCESS:return{title:u.reactFormat(m._("Shared folders you don’t own")),description:u.reactFormat(m._("Your access will be removed, but they won’t be             deleted for anyone else"))};case _.ITEMS_NOT_OWNED_WITHIN_SHARED:return{title:u.reactFormat(m._("Items you don’t own in a shared folder")),description:t.getNonOwnedDesc(n)};case _.SHARED_FOLDERS_WITHOUT_ACCESS:return{title:u.reactFormat(m._("Shared folders you can no longer access")),description:u.reactFormat(m._("Hidden forever for you, but not deleted for anyone else."))};default:throw new Error("tabName not found"+e)}},t.prototype.isOneFolder=function(){var e=this.props.namespacesInfo;return 1===e.length&&e[0].isOneCompleteFolder},t.prototype.getSimpleDescription=function(e){var r=this.props,s=r.totalFileCount,o=r.referenceFileName,a=this.isOneFolder();if(e!==_.ITEMS_NOT_OWNED_WITHIN_SHARED){var i=t.getDescription(e,o,s,a);return{description:u.reactFormat(i,{strong:n.default.createElement("strong",null)})}}throw new Error("description not available")},t.getDescription=function(e,t,r,n){var s=g(e);if(void 0===s)throw new Error("description not defined");if(r>1&&!n){var o=r-1;return s.moreThanOne(o).format({filename:i.Emstring.em_snippet(t,30).toString(),count:o})}return(s.oneFolder&&n?s.oneFolder:s.one).format({filename:i.Emstring.em_snippet(t,30).toString()})},t.prototype.getPolicyValidator=function(e){return this.getPolicyValidatorForNsInfo(e,this.props.namespacesInfo[0])},t.prototype.getPolicyValidatorForNsInfo=function(e,t){switch(e){case _.PERSONAL_ITEMS:return function(){var e=t.fileCount,r=t.sfWithAccessCount,n=t.sfWithoutAccessCount,s=t.ownedSfCount,o=t.isHomeNsId;return e>r+n+s&&o};case _.SHARED_FOLDERS_OWNED:return function(){return t.ownedSfCount>0};case _.ITEMS_OWNED_WITHIN_SHARED:return function(){var e=t.fileCount,r=t.sfWithAccessCount,n=t.sfWithoutAccessCount,s=t.ownedSfCount,o=t.isUserOwnedNs,a=t.canPurge,i=t.userType,l=t.isHomeNsId,c=i===_.ADMIN||i===_.MEMBER;return e>r+n+s&&!l&&(c&&a||!c&&(o||a))};case _.SHARED_FOLDERS_WITH_ACCESS:return function(){return t.sfWithAccessCount>0};case _.ITEMS_NOT_OWNED_WITHIN_SHARED:return function(){var e=t.fileCount,r=t.sfWithAccessCount,n=t.sfWithoutAccessCount,s=t.ownedSfCount,o=t.isUserOwnedNs,a=t.userType,i=t.canPurge,l=e>r+n+s,c=a===_.ADMIN||a===_.MEMBER;return l&&(c&&!i||!c&&!o&&!i)};case _.SHARED_FOLDERS_WITHOUT_ACCESS:return function(){return t.sfWithoutAccessCount>0};default:throw new Error("policy not found")}},t.prototype.getTabsWithPolicyInfo=function(){var e=this,t=[_.PERSONAL_ITEMS,_.SHARED_FOLDERS_OWNED,_.ITEMS_OWNED_WITHIN_SHARED,_.SHARED_FOLDERS_WITH_ACCESS,_.ITEMS_NOT_OWNED_WITHIN_SHARED,_.SHARED_FOLDERS_WITHOUT_ACCESS],r=this.props.namespacesInfo,n=new Map;if(void 0===r)return n;for(var s=function(r){var s=t.filter(function(t){return e.getPolicyValidatorForNsInfo(t,r)()});s.length>0&&n.set(r,s)},o=0,a=r;o<a.length;o++){s(a[o])}return n},t.prototype.renderPolicies=function(e){var r=this,s=t.getUniquePolicies(e);if(1===s.length)return n.default.createElement("div",null,this._renderPolicy(s[0]));var o=[this._render_body_banner(),this._renderListHeader()];return t.getPoliciesWithNamespaceInfo(e).forEach(function(e,t){o.push(r._renderPolicyListEntry(t,e))}),n.default.createElement("div",null,o)},t.getPoliciesWithNamespaceInfo=function(e){var t=new Map;return e.forEach(function(e,r){for(var n=0,s=e;n<s.length;n++){var o=s[n];t.has(o)||t.set(o,r)}}),t},t.getUniquePolicies=function(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){t.indexOf(e)===-1&&t.push(e)})}),t},t.prototype.getTitle=function(){var e=this.props.totalFileCount;return m.ungettext("Permanently delete %(num)s item?","Permanently delete %(num)s items?",e).format({num:e})},t.getPrimaryAction=function(e){if(void 0===e||1!==e.length)return m._("Permanently delete");switch(e[0]){case _.PERSONAL_ITEMS:case _.SHARED_FOLDERS_OWNED:case _.ITEMS_OWNED_WITHIN_SHARED:return m._("Permanently delete");case _.SHARED_FOLDERS_WITH_ACCESS:return m._("Remove my access");case _.ITEMS_NOT_OWNED_WITHIN_SHARED:return m._("Ok");case _.SHARED_FOLDERS_WITHOUT_ACCESS:return m._("Hide folders");default:throw new Error("policy not found")}},t.is_purge_disallowed=function(e){return 1===e.length&&e[0]===_.ITEMS_NOT_OWNED_WITHIN_SHARED},t.prototype.getModalContent=function(e,t){return void 0!==t?this.renderDisabled(t):this.renderPolicies(e)},t.prototype.render=function(){var e,r=this.props,o=r.readyToDisplayContent,i=r.namespacesInfo,l=null,c=void 0,u=t.getPrimaryAction(),d=function(){};if(this.props.error)l=t.renderError(),u=m._("Ok");else if(o){for(var _=0,p=i;_<p.length;_++){var f=p[_];if(!y(f.isHomeNsId,f.sfWithAccessCount,f.sfWithoutAccessCount,f.userType,f.canPurge)){e=f;break}}var h=this.getTabsWithPolicyInfo(),g=t.getUniquePolicies(h);c=1===g.length?this.helpLinkCreator:void 0,l=this.getModalContent(h,e),u=void 0===e?t.getPrimaryAction(g):m._("Ok"),d=void 0!==e||t.is_purge_disallowed(g)?function(){}:this.onPrimary}else l=t.renderLoader();var E=this.getTitle(),v=function(e){return n.default.createElement(s.Button,{variant:"primary",onClick:e,"aria-label":u,disabled:!o},u)};return n.default.createElement(a.UtilityModal,{displayCloseButton:!1,overlayClickClose:!0,className:"purge-modal",primaryAction:v,secondaryAction:m._("Cancel"),ariaLabel:u,onPrimaryAction:d,onSecondaryAction:this.onRequestClose,onReady:this.onReady,link:c,title:E,overlayClassName:"purge-modal--overlay",onRequestClose:this.onRequestClose,open:this.state.isModalOpen},n.default.createElement("div",{className:"uxa-modal",id:"purge-modal"},l))},t})(n.default.Component);t.InternalPurgeModal=A;var R=o.connect(E)(A),C=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(o.Provider,{store:p.TrashStore},n.default.createElement(R,r.__assign({},this.props)))},t})(n.default.Component);t.PurgeModal=c.requireCssWithComponent(C,["/static/css/modal-vflYDGbgV.css"]),t.showPurgeModal=v,t.isPurgeModalActionAllowed=y}),define("modules/clean/react/trash/reducer",["require","exports","tslib","external/lodash","external/immutable","modules/clean/react/trash/constants","modules/clean/sharing/api/client","external/react-addons-update","modules/clean/react/trash/selectors"],function(e,t,r,n,s,o,a,i,l){"use strict";function c(e,t,r,s,a){if(0===t.length&&0===r.length)return e;var i=n.groupBy(t,"ns_id");return e.withMutations(function(e){Object.keys(i).forEach(function(t){var r=parseInt(t,10),n=i[t];if(e.has(r)){var s=e.get(r);n=n.filter(function(e){return e.timestamp<s.earliest});var a=s.events.concat(n);e.set(r,{earliest:Math.min.apply(Math,a.map(function(e){return e.timestamp})),events:a,done:!1,cursor:s.cursor})}else e.set(r,{earliest:Math.min.apply(Math,n.map(function(e){return e.timestamp})),events:n,done:!1,cursor:o.DELETED_FILES_CURSOR_FETCH_ALL})});for(var t=0,n=r;t<n.length;t++){var a=n[t];if(s&&s[a]){var l=e.get(a);l?l.cursor=s[a]:(l={earliest:Number.MAX_VALUE,events:[],done:!1,cursor:s[a]},e.set(a,l)),s[a]===o.DELETED_FILES_CURSOR_DONE&&(l.done=!0)}}return e})}function u(e,t,n,a){return r.__assign({},e,{events:c(s.Map(),t,[e.root_ns_ids[e.user_id]],a,e.user_id),namespaces:s.List(n),fetchPhase:o.FetchPhase.PHASE2})}function d(e,t,n,s){return r.__assign({},e,{events:c(e.events,t,n,s,e.user_id),fetchPhase:o.FetchPhase.PHASE3})}function _(e,t,n,s){return r.__assign({},e,{events:c(e.events,t,n,s,e.user_id),isLoadingMore:!1})}function p(e){return{earliest:Number.MAX_VALUE,events:[],done:!1,cursor:o.DELETED_FILES_CURSOR_FETCH_ALL}}function m(e){var t=s.Map().withMutations(function(t){e.namespaces.forEach(function(r){r.user_id===e.user_id&&t.set(r.ns_id,p(r.ns_id))});var r=e.root_ns_ids[e.user_id];t.set(r,p(r))});return r.__assign({},e,{events:t})}function f(e,t,n){return r.__assign({},e,{snackbarState:r.__assign({},e.snackbarState,{fileCountForSnackbarToDisplay:t,quotaState:n})})}function h(e,t){return r.__assign({},e,{snackbarState:{state:"restoring",fileCountForSnackbarToDisplay:t,quotaState:null}})}function g(e,t){var n=new Set;return e.filesCurrentlyBeingRestored.forEach(function(e){return n.add(e)}),n.add(t),r.__assign({},e,{filesCurrentlyBeingRestored:n})}function E(e){var t=e.ns_id,r=null!=t?e.events.get(t):null;return r?[r]:e.events.toArray()}function v(e){return Math.max.apply(Math,E(e).map(function(e){return e.earliest}))}function y(e,t){var n=1e3*v(e),s=r.__assign({},e,{timestamp_ms:t});return(n<0||t<n||t>e.latest_ms)&&(s=m(r.__assign({},s,{latest_ms:t}))),s}function S(e,t,s){var o=e.events,a=o.get(t),l=a?n.findIndex(a.events,function(e){return e.pkey===s}):-1;return l!==-1&&(o=o.update(t,function(e){return i.default(e,{events:{$splice:[[l,1]]}})})),r.__assign({},e,{events:o})}function T(e,t){return m(r.__assign({},e,{namespaces:s.List(t.ns_entries),root_ns_ids:t.root_ns_ids,home_ns_ids:t.home_ns_ids,timestamp_ms:t.date,latest_ms:t.date,ns_id:t.active_ns_id,seenRestoreFilesTip:Boolean(t.seenRestoreFilesTip),restoreId:t.restoreId,start_ts:t.start_ts||null,end_ts:t.end_ts||null,actor_email:t.actor_email||null,selected_host_ids:t.selected_host_ids||[],fq_path:t.fq_path||null}))}function I(e,t,n,s){var o={deletorInfo:s,deletedContentInfo:t,permissions:n,canDisplayContent:!0,error:!1,readyToDisplayContent:!1};return r.__assign({},e,{currentModalInfo:o})}function b(e,t,n,s){var o=r.__assign({},e.currentModalInfo,{eventDetails:t,canDisplayContent:n,hasAclRestore:s});return r.__assign({},e,{currentModalInfo:o})}function A(e,t,n){var s=r.__assign({},void 0!==e.currentModalInfo?e.currentModalInfo.deletedContentInfo:void 0,{fileName:t.fileName,referenceFileName:t.referenceFileName,fileCount:t.fileCount,eventCount:t.fileCount,readOnlyEventCount:0,fqPaths:t.fqPaths,isSingleFile:t.isSingleFile,displayPath:t.displayPath,sharedFolderPurgeInfo:void 0}),o=r.__assign({},e.currentModalInfo,{deletedContentInfo:s,deletorInfo:n,error:!1,readyToDisplayContent:!1});return r.__assign({},e,{currentModalInfo:o})}function R(e,t){for(var n=t.map(function(e){var t=l.getUserType(e.user_type);return{nsId:e.ns_id,isUserOwnedNs:e.is_user_owned_ns_id,userType:t,isOneCompleteFolder:e.is_one_complete_folder,isHomeNsId:e.is_home_ns_id,sfWithAccessCount:e.sf_with_access_count-e.owned_sf_count,sfWithoutAccessCount:e.sf_without_access_count,ownedSfCount:e.owned_sf_count,canPurge:e.can_purge,fileCount:e.file_count}}),s=0,o=0,a=n;o<a.length;o++){s+=a[o].fileCount}var i={ownedSfCount:t[0].owned_sf_count,sfWithAccessCount:t[0].sf_with_access_count,sfWithoutAccessCount:t[0].sf_without_access_count,isUserOwnedNs:t[0].is_user_owned_ns_id,userType:t[0].user_type,isOneCompleteFolder:t[0].is_one_complete_folder},c=r.__assign({},e.currentModalInfo.deletedContentInfo,{ns_info:n,sharedFolderPurgeInfo:i,fileCount:s}),u={canPurge:t[0].can_purge,canRollback:!1,isReadOnly:!1},d=r.__assign({},e.currentModalInfo,{deletedContentInfo:c,error:!1,permissions:u});return r.__assign({},e,{currentModalInfo:d})}function C(e,t,n){var s=r.__assign({},e.currentModalInfo,{membershipByFQPath:t,noAccessPaths:n});return r.__assign({},e,{currentModalInfo:s})}function w(e,t){switch(t.type){case o.START_FETCH_PHASE1:return r.__assign({},e,{fetchPhase:o.FetchPhase.PHASE1});case o.COMPLETE_FETCH_PHASE1:return u(e,t.deletionEvents,t.mountedNamespaces,t.requestedNsIdToCursor);case o.COMPLETE_FETCH_PHASE2:return d(e,t.deletionEvents,t.requestedNsIds,t.requestedNsIdToCursor);case o.REQUEST_MORE_DATA:return r.__assign({},e,{isLoadingMore:!0});case o.RECEIVE_MORE_DATA:return _(e,t.deletionEvents,t.requestedNsIds,t.requestedNsIdToCursor);case o.FAIL_REQUESTING_MORE_DATA:return r.__assign({},e,{isLoadingMore:!1});case o.SET_NAMESPACE:return r.__assign({},e,{ns_id:t.ns_id});case o.SET_TIMESTAMP:return y(e,t.timestamp_ms);case o.SET_START_TS:return m(r.__assign({},e,{start_ts:t.ts}));case o.SET_END_TS:return m(r.__assign({},e,{end_ts:t.ts}));case o.SET_ACTOR_USER_EMAIL:var n=e.actor_email===t.user_email,s=n?e.selected_host_ids:[];return m(r.__assign({},e,{actor_email:t.user_email,selected_host_ids:s}));case o.RECEIVE_HOST_DETAILS:return r.__assign({},e,{user_host_details_map:e.user_host_details_map.set(t.email,t.host_details)});case o.SET_HOST_IDS:return m(r.__assign({},e,{selected_host_ids:t.host_ids}));case o.SET_FQ_PATH:return m(r.__assign({},e,{fq_path:t.folder_path}));case o.UPDATE_SNACKBAR:return f(e,t.count,t.quotaStatus);case o.CREATE_SNACKBAR:return h(e,t.count);case o.CLEAR_FILTERS:return m(r.__assign({},e,{start_ts:null,end_ts:null,actor_email:null,selected_host_ids:[],fq_path:null}));case o.TRASH_INIT:return T(e,t.data);case o.MARK_ROW_AS_RESTORING:return g(e,t.pkey);case o.REMOVE_ROW:return S(e,t.ns_id,t.pkey);case o.DISMISS_RESTORE_FILES_TIP:return r.__assign({},e,{seenRestoreFilesTip:!0});case o.SET_USER_ID:return r.__assign({},e,{user_id:t.userId,shareClient:new a.ShareApiClient({userId:t.userId,isNonUserRelativeContext:t.isNonUserRelativeContext})});case o.SET_TRASH_MODAL_DATA:return I(e,t.deletedContentInfo,t.permissions,t.deletorInfo);case o.RECEIVE_EVENT_DETAILS:return b(e,t.deletionEventDetails,t.canDisplayContent,t.hasAclRestore);case o.RECEIVE_PURGE_EVENT_DETAILS:return R(e,t.purgeEventDetails);case o.SET_PURGE_MODAL_DATA:return A(e,t.browseContentInfo,t.deletorInfo);case o.FETCH_EVENT_DETAILS_ERROR:return r.__assign({},e,{currentModalInfo:r.__assign({},e.currentModalInfo,{error:!0})});case o.RECEIVE_MEMBERSHIP:return C(e,t.membershipInfo.membershipByFQPath,t.membershipInfo.noAccessPaths);case o.FINISH_LOADING_MODAL_DATA:return r.__assign({},e,{currentModalInfo:r.__assign({},e.currentModalInfo,{readyToDisplayContent:!0})});default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),i=r.__importDefault(i),t.reducer=w}),define("modules/clean/react/trash/restorations_education",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls","spectrum/icon_action","modules/clean/react/css"],function(e,t,r,n,s,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var l=function(e){var t=e.icon,r=e.text,s=e.link;return n.default.createElement("div",{className:"restorations-education__other-option"},n.default.createElement("a",{href:s,className:"restorations-education__link"},n.default.createElement("div",{className:"restorations-education__other-option__icon"},n.default.createElement(a.IconAction,{name:t})),n.default.createElement("div",null,r)))},c=function(e){var t=e.olderFileVersion,r=e.olderFolderVersion,o=e.deletedFile;return n.default.createElement("div",{className:"restorations-education__other-options-container"},n.default.createElement("div",{className:"restorations-education__smaller-title"},s._("Looking for something else?")),n.default.createElement("div",{className:"restorations-education__other-options"},r&&n.default.createElement(l,{link:"https://help.dropbox.com/security/rewind",icon:"revert-folder",text:s._("An older version of a folder")}),t&&n.default.createElement(l,{link:"https://help.dropbox.com/security/version-history-overview",icon:"view-version-history",text:s._("An older version of a file")}),o&&n.default.createElement(l,{link:"https://www.dropbox.com/deleted_files",icon:"delete",text:s._("A deleted file")})))},u=function(e){var t,r=e.daysOfVersionHistory;return t=void 0===r?s._("Get your deleted files back, or delete them forever"):s.ungettext("Restore any file deleted in the last %(days_of_version_history)d day","Restore any file deleted in the last %(days_of_version_history)d days",r).format({days_of_version_history:r}),n.default.createElement("div",{className:"restorations-education__explanation-container"},n.default.createElement("div",{className:"restorations-education__title"},t),n.default.createElement("div",{className:"restorations-education__help"},n.default.createElement("a",{href:"https://help.dropbox.com/security/recover-deleted-files-folders",className:"restorations-education__link"},s._("How to recover deleted files")),n.default.createElement("img",{className:"restorations-education__df-help__image",src:o.static_url("/static/images/empty_states/illo-trash-vflwBmpyb.png"),alt:""})))},d=function(e){var t,r=e.daysOfVersionHistory;return t=void 0===r?s._("Restore an older version of this file"):s.ungettext("Restore any version from the past %(days_of_version_history)d day","Restore any version from the past %(days_of_version_history)d days",r).format({days_of_version_history:r}),n.default.createElement("div",{className:"restorations-education__explanation-container"},n.default.createElement("div",{className:"restorations-education__title"},t),n.default.createElement("div",{className:"restorations-education__help"},n.default.createElement("a",{href:"https://help.dropbox.com/security/version-history-overview",className:"restorations-education__link"},s._("How version history works")),n.default.createElement("img",{className:"restorations-education__help__image",src:o.static_url("/static/images/prompt/illustrations/dropbox-business-more-space-vflPA79lL.png"),alt:""})))},_=function(e){var t=e.daysOfVersionHistory;return n.default.createElement("div",{className:"restorations-education",key:"restorations-education"},n.default.createElement(u,{daysOfVersionHistory:t}),n.default.createElement(c,{olderFolderVersion:!0,olderFileVersion:!0}))};t.DeletedFilesEducation=i.requireCssWithComponent(_,["/static/css/restorations-education-vfl9fnrFx.css"]);var p=function(e){var t=e.daysOfVersionHistory;return n.default.createElement("div",{className:"restorations-education",
key:"restorations-education"},n.default.createElement(d,{daysOfVersionHistory:t}),n.default.createElement(c,{olderFolderVersion:!0,deletedFile:!0}))};t.VersionHistoryEducation=i.requireCssWithComponent(p,["/static/css/restorations-education-vfl9fnrFx.css"]),t.RestorationOptions=i.requireCssWithComponent(c,["/static/css/restorations-education-vfl9fnrFx.css"])}),define("modules/clean/react/trash/selectors",["require","exports","modules/clean/react/trash/constants"],function(e,t,r){"use strict";function n(e,t){return null==t?c:e.get(t,c)}function s(e){return e.root_ns_ids[e.user_id]}function o(e){return e.home_ns_ids[e.user_id]}function a(e){switch(e){case r.OFF_TEAM:return r.OFF_TEAM;case r.MEMBER:return r.MEMBER;case r.ADMIN:return r.ADMIN;case r.NON_TEAM:default:return r.NON_TEAM}}function i(e){return e.fetchPhase!==r.FetchPhase.PHASE3||e.isLoadingMore}function l(e){var t=e.fetchPhase;return null===t||t===r.FetchPhase.PHASE1||i(e)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.freeze({earliest:+(1/0),events:Object.freeze([]),done:!0,cursor:r.DELETED_FILES_CURSOR_DONE});t.getEventsForNs=n,t.getRootNsId=s,t.getHomeNsId=o,t.getUserType=a,t.isLoading=i,t.eventFetchInProgress=l}),define("modules/clean/react/trash/store",["require","exports","tslib","external/immutable","external/redux","external/redux-thunk","modules/clean/react/trash/reducer","modules/clean/redux/unsupported"],function(e,t,r,n,s,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var l=s.compose,c=i.createStore(a.reducer,{user_id:0,shareClient:null,ns_id:void 0,root_ns_ids:{},home_ns_ids:{},events:n.Map(),namespaces:n.List(),latest_ms:Number.MAX_VALUE,timestamp_ms:null,start_ts:null,end_ts:null,actor_email:null,user_host_details_map:n.Map(),selected_host_ids:[],fq_path:null,fetchPhase:null,isLoadingMore:!1,seenRestoreFilesTip:!1,filesCurrentlyBeingRestored:new Set,snackbarState:{state:"none",fileCountForSnackbarToDisplay:0,quotaState:null}},l(s.applyMiddleware(o.default)));t.TrashStore=c}),define("modules/clean/react/trash/trash",["require","exports","tslib","react","external/react-redux","external/immutable","external/lodash","spectrum/scroll_monitor","modules/clean/analytics","modules/clean/history","modules/clean/pagelet_logger","modules/clean/viewer","modules/clean/web_timing_logger","modules/clean/react/trash/actions","modules/clean/react/trash/selectors","modules/clean/react/trash/store","modules/clean/react/trash/trash_view","modules/clean/react/trash/utils","modules/clean/react/trash/trash_filter_util","modules/clean/web_timing_logger","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/store","modules/clean/react/snackbar","modules/clean/react_format","modules/core/i18n","modules/clean/search/search_bar/experiments","modules/clean/react/trash/constants","modules/constants/trademark"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h,g,E,v,y,S,T,I,b,A,R,C){"use strict";function w(e){var t,r=e.ns_id;return t=r?[m.getEventsForNs(e.events,r)]:e.events.toList().toJS(),{namespaces:e.namespaces,restoringFiles:e.filesCurrentlyBeingRestored,root_ns_ids:e.root_ns_ids,home_ns_ids:e.home_ns_ids,active_ns_id:e.ns_id,loading:m.isLoading(e),timestamp_ms:e.timestamp_ms,seenRestoreFilesTip:e.seenRestoreFilesTip,filterViewDisabled:m.eventFetchInProgress(e),start_ts:e.start_ts,end_ts:e.end_ts,restoreId:e.restoreId,actor_email:e.actor_email,user_host_details:E.HostDetailsWrapper.fromUserHostMap(e.user_host_details_map),selected_host_ids:e.selected_host_ids,fq_path:e.fq_path,snackbarState:e.snackbarState,valid_nss:t}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importStar(o),a=r.__importStar(a),c=r.__importDefault(c),_=r.__importStar(_),p=r.__importStar(p),y=r.__importStar(y);var F=(function(t){function s(){var e=null!==t&&t.apply(this,arguments)||this;return e.pageletLogger=new u.PageletLogger("trash",["TrashView"]),e._currentFromBottom=null,e.loggedFilterTypes=o.Set(),e.state={user:d.Viewer.get_viewer().get_user_by_id(e.props.user_id)},e.handleComponentReady=function(t){e.pageletLogger.componentReady(t)},e.handleDateChange=function(t){var r=Number(t);e.props.dispatch(p.setTimestampMs(r))},e.handleRestoreFilesTipDismiss=function(){e.props.dispatch(p.dismissRestoreFilesTip())},e.handleScroll=function(t){var r=t.fromBottom;e._currentFromBottom=r,e.loadMoreIfNearBottom()},e.purgeDeletionEvent=function(t){return r.__awaiter(e,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.props.dispatch(p.purgeByDeletionEvents(t))];case 1:return e.sent(),l.WebMiscActivityLogger.log("trash-purge",{source:"modal",with_mixed_cs:!0}),[2]}})})},e.restoreDeletionEvent=function(t){return r.__awaiter(e,void 0,void 0,function(){var e;return r.__generator(this,function(r){switch(r.label){case 0:this.props.restoreId&&l.RestorationStepsLogger.log_entry({userId:this.props.user_id,restoreId:this.props.restoreId,step:"user clicked restore button",entry_point:"deleted_files"}),T.Snackbar.show(n.default.createElement(T.Snackbar,{key:"restore-snackbar",syncProgressLoop:!0,title:b._("Restoring files..."),variant:"sync"})),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.props.dispatch(p.restoreByDeletionEvents(t,{".tag":"deleted_files"},this.props.restoreId))];case 2:switch(r.sent(),T.Snackbar.close(),this.props.restoreId&&l.RestorationStepsLogger.log_success({userId:this.props.user_id,restoreId:this.props.restoreId,step:"displayed success to user",success:"displayed success"}),this.props.snackbarState.quotaState){case"normal_overquota":T.Snackbar.warn(I.reactFormat(R.RestoreResultDescriptions.normal_overquota(this.props.snackbarState.fileCountForSnackbarToDisplay).format({num:this.props.snackbarState.fileCountForSnackbarToDisplay}),{strong:n.default.createElement("strong",null)}));break;case"locked_state":T.Snackbar.warn(I.reactFormat(R.RestoreResultDescriptions.locked_state(this.props.snackbarState.fileCountForSnackbarToDisplay).format({num:this.props.snackbarState.fileCountForSnackbarToDisplay,trademark_business:C.TRADEMARK_BUSINESS}),{strong:n.default.createElement("strong",null)}));break;case"not_overquota":case null:default:T.Snackbar.generic(I.reactFormat(R.RestoreResultDescriptions.not_overquota(this.props.snackbarState.fileCountForSnackbarToDisplay).format({num:this.props.snackbarState.fileCountForSnackbarToDisplay}),{strong:n.default.createElement("strong",null)}))}return[3,4];case 3:return e=r.sent(),"timeout"===e?(T.Snackbar.generic(b._("Large restorations may take a few hours to complete, please check back later.")),this.props.restoreId&&l.RestorationStepsLogger.log_step({userId:this.props.user_id,restoreId:this.props.restoreId,step:"displayed timeout to user"})):e&&e.error&&e.error[".tag"]&&"too_many_writes"===e.error[".tag"]?(T.Snackbar.fail(b._("Someone else is making a change right now. Try again in a few minutes.")),this.props.restoreId&&l.RestorationStepsLogger.log_failure({userId:this.props.user_id,restoreId:this.props.restoreId,step:"displayed lock contention to user",failure:"displayed lock contention to user"})):(T.Snackbar.fail(b._("We were unable to restore those files.")),this.props.restoreId&&l.RestorationStepsLogger.log_failure({userId:this.props.user_id,restoreId:this.props.restoreId,step:"displayed failure to user",failure:"displayed failure to user"})),[3,4];case 4:return l.WebMiscActivityLogger.log("trash-restore",{source:"modal",with_mixed_cs:!0}),this.logRestoreWithFilter(),[2]}})})},e.updateNSFilter=function(t){var r="all"===t?null:t;e.props.dispatch(p.setNamespace(r))},e.handleMinTsUpdate=function(t){e.logFilterUsed("calender_from"),e.props.dispatch(p.setMinDateTs(t))},e.handleMaxTsUpdate=function(t){e.logFilterUsed("calender_to"),e.props.dispatch(p.setMaxDateTs(t))},e.handleUserFilterUpdate=function(t){e.logFilterUsed("user"),t!==e.props.actor_email&&e.props.dispatch(p.setActorUserEmail(t||null))},e.handleHostFilterUpdate=function(t){e.logFilterUsed("host"),e.props.dispatch(p.setActorHostIds(t))},e.handleParentFolderSettingUpdate=function(t){e.logFilterUsed("parent_folder"),e.props.dispatch(p.setDeletedContainingFqPath(t))},e.handleFilterClear=function(){e.props.dispatch(p.clearFilters())},e.logFilterUsed=function(t){0===e.loggedFilterTypes.size&&l.WebMiscActivityLogger.log("trash-session-filter-used"),e.loggedFilterTypes.has(t)||(e.loggedFilterTypes=e.loggedFilterTypes.add(t),l.WebMiscActivityLogger.log("trash-filter-used-%(filter)s".format({filter:t})))},e.logRestoreWithFilter=function(){e.loggedFilterTypes.size>0&&l.WebMiscActivityLogger.log("trash-restore-with-filters")},e}return r.__extends(s,t),s.prototype.componentWillMount=function(){_.log_js_modules_application_code_start(),A.isInDeletedFilterRightRailExperiment(this.props.searchBarExperiments)&&(S.getStoreForSearchBar().dispatch(y.setDeletedChipEnabled({enabled:!0})),S.getStoreForSearchBar().dispatch(y.setDeletedChip({deletedChip:!0})))},s.prototype.componentDidMount=function(){var t=this;this.props.dispatch(p.initiateFetchPhases()),v.waitForTTI().then(function(){new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar).then(function(e){e.OverquotaHelper.maybeShowSubgrowthProOQRecurringModal("wb_oq_ups_recur_fb")})}),v.waitForTTI().then(function(){t.props.restoreId&&l.RestorationStepsLogger.log_step({userId:t.props.user_id,restoreId:t.props.restoreId,step:"load deleted files"})})},s.prototype.componentDidUpdate=function(){this.setUrlWithFilters()},s.prototype.setUrlWithFilters=function(){var e=this.props,t=e.start_ts,r=e.end_ts,n=e.actor_email,s=e.selected_host_ids,o=e.fq_path,a={};null!==t&&(a.start_ts=String(t)),null!==r&&(a.end_ts=String(r)),null!==n&&(a.actor_email=n),s&&s.length&&(a.host_ids=s.join(",")),null!==o&&(a.fq_path=o),c.default.push_state("/deleted_files",a)},s.prototype.getFilteredEvents=function(){var e=a.flattenDeep(this.props.valid_nss.map(function(e){return e.events}));return g.getFilteredEventsWithFilters(e,this.props)},s.prototype.getFilteredNamespaces=function(){var e=this;return this.props.namespaces.filter(function(t){return t.user_id===e.props.user_id})},s.prototype.loadMoreIfNearBottom=function(){null!==this._currentFromBottom&&this._currentFromBottom>=0&&this._currentFromBottom<=400&&this.props.dispatch(p.loadMore())},s.prototype.getFilterStatus=function(){return{calendarFilterSettings:{onMinTsUpdated:this.handleMinTsUpdate,onMaxTsUpdated:this.handleMaxTsUpdate,minTs:this.props.start_ts||void 0,maxTs:this.props.end_ts||void 0},userFilterSettings:{onUserSelected:this.handleUserFilterUpdate,selectedUserEmail:this.props.actor_email||null},hostFilterSettings:{userHostDetails:this.props.user_host_details,onHostSelected:this.handleHostFilterUpdate,selectedHostIds:this.props.selected_host_ids||void 0},parentFolderSettings:{selectedPath:this.props.fq_path||void 0,onPathSelected:this.handleParentFolderSettingUpdate},onFilterClear:this.handleFilterClear}},s.prototype.render=function(){return n.default.createElement("div",null,n.default.createElement(h.TrashView,{user:this.state.user,onDateChange:this.handleDateChange,calendarInitDate:new Date(this.props.initial_timestamp),calendarLastDay:new Date,activeNS:this.props.active_ns_id,defaultNS:this.props.initial_active_ns_id,events:this.getFilteredEvents(),namespaces:this.getFilteredNamespaces(),homeNsIds:this.props.home_ns_ids,userVersionHistoryLength:this.props.user_version_history_length,expRestorationsEducation:this.props.exp_restorations_education,onNamespaceChange:this.updateNSFilter,onPurgeDeletionEvent:this.purgeDeletionEvent,onRestoreDeletionEvent:this.restoreDeletionEvent,loading:this.props.loading,evhUserType:this.props.evh_user_type,handleComponentReady:this.handleComponentReady,seenRestoreFilesTip:this.props.seenRestoreFilesTip,onRestoreFilesTipDismiss:this.handleRestoreFilesTipDismiss,filterViewDisabled:this.props.filterViewDisabled,searchBarExperiments:this.props.searchBarExperiments,deletionFilterStatus:this.getFilterStatus(),filesCurrentlyBeingRestored:this.props.restoringFiles,snackbarState:this.props.snackbarState,restoreId:this.props.restoreId}),n.default.createElement(i.WindowScrollMonitor,{onScroll:this.handleScroll}))},s})(n.default.Component);t.InnerTrash_TESTING=F;var P=s.connect(w)(F),D=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillMount=function(){f.TrashStore.dispatch(p.setUserId(this.props.user_id)),f.TrashStore.dispatch(p.initialize({date:this.getInitialTimestamp(),ns_entries:this.props.namespaces,root_ns_ids:this.props.root_ns_ids,home_ns_ids:this.props.home_ns_ids,active_ns_id:this.props.initial_active_ns_id,seenRestoreFilesTip:this.props.seenRestoreFilesTip,start_ts:this.props.start_ts,end_ts:this.props.end_ts,actor_email:this.props.actor_email,selected_host_ids:this.getHostIds(),fq_path:this.props.fq_path,restoreId:this.props.restoreId&&l.RestorationStepsLogger.restore_id_from_string(this.props.restoreId)||void 0})),this.props.actor_email&&f.TrashStore.dispatch(p.loadHostsForActorEmail(this.props.actor_email))},t.prototype.getHostIds=function(){var e=this.props.selected_host_ids;return"string"==typeof e?e.split(",").map(function(e){return parseInt(e,10)}):[]},t.prototype.getInitialTimestamp=function(){var e=this.props.date_str;return e?g.parseDateFromString(e)||Date.now():Date.now()},t.prototype.render=function(){var e=this.props,t=e.initial_active_ns_id,r=e.exp_restorations_education,o=e.evh_user_type,a=e.user_id,i=e.searchBarExperiments,l=e.user_version_history_length,c=this.getInitialTimestamp();return n.default.createElement(s.Provider,{store:f.TrashStore},n.default.createElement(P,{evh_user_type:o,initial_active_ns_id:t,initial_timestamp:c,exp_restorations_education:r,user_id:a,searchBarExperiments:i,user_version_history_length:l}))},t})(n.default.Component);t.Trash=D}),define("modules/clean/react/trash/trash_filter_sidebar",["require","exports","tslib","react","external/classnames","spectrum/dropdown_button","spectrum/dropdown_menu","spectrum/tertiary_link","modules/core/i18n","modules/clean/react/title_bubble","modules/clean/static_urls","modules/clean/contacts/types","modules/clean/contacts/tokenizer","modules/clean/contacts/contact","modules/clean/react/calendar","modules/clean/react/folder_selector_modal","modules/clean/react/css","modules/clean/react/sprite","modules/clean/react/trash/trash_filter_util","modules/clean/react/path_filter_button"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h,g,E,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importDefault(s),d=r.__importDefault(d);var y=(function(e){function t(t){var r=e.call(this,t)||this;return r.onMinDateSelected=function(e){return r.props.calendarFilter.onMinTsUpdated(E.jsDateToUnixSeconds(e))},r.onMaxDateSelected=function(e){return r.props.calendarFilter.onMaxTsUpdated(E.jsDateToUnixSeconds(E.lastSecondOfDay(e)))},r.renderCalendarFilter=function(){var e=[];return e.push(n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("From date")),n.default.createElement("div",{className:"filter-item__filter filter-item__filter--minDate"},n.default.createElement(m.Calendar,{placeholderText:l._("Any day"),disabled:r.props.disabled,firstDay:E.unixSecondToJsDate(1167609600),lastDay:E.unixSecondToJsDate(r.props.calendarFilter.maxTs)||new Date,initDate:E.unixSecondToJsDate(r.props.calendarFilter.minTs),isMaestroDesign:!0,alignAtLeft:!1,onDateChange:r.onMinDateSelected}))))),e.push(n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("To date")),n.default.createElement("div",{className:"filter-item__filter filter-item__filter--maxDate"},n.default.createElement(m.Calendar,{placeholderText:l._("Any day"),disabled:r.props.disabled,firstDay:E.unixSecondToJsDate(r.props.calendarFilter.minTs)||E.unixSecondToJsDate(1167609600),lastDay:new Date,initDate:E.unixSecondToJsDate(r.props.calendarFilter.maxTs),isMaestroDesign:!0,alignAtLeft:!1,onDateChange:r.onMaxDateSelected}))))),e},r.onTokenizerContentsChange=function(e,t){var n=null;e.length&&(n=e[0].email),n!==r.props.userFilter.selectedUserEmail&&(r.props.userFilter.onUserSelected(n),r.setState({emailFromUrl:null}))},r.getPopulatedInputData=function(){var e=r.state.emailFromUrl,t=[];return e&&t.push(new p.Contact({email:e,invalid:!1,name:e,type:d.default.EMAIL})),{tokens:t}},r.renderUserFilter=function(){var e=function(e){return e.type!==d.default.NEW_STYLE_GROUP};return n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("Deleted by")),n.default.createElement(_.ContactsTokenizer,{customClass:"filter-item__filter filter-item__filter--actorEmail",customContactFilter:e,ref:"tokenizer",context:"deleted_files",focusOnMount:!1,onContentsChange:r.onTokenizerContentsChange,placeholder:l._("Email or name"),showContactImport:!1,user:r.props.user,disabled:r.props.disabled,disableAdditionalInput:!!r.props.userFilter.selectedUserEmail,populatedInputData:r.getPopulatedInputData(),resetTokenData:!r.props.userFilter.selectedUserEmail})))},r.onHostSelected=function(e){r.props.hostFilter.onHostSelected(e?[e]:[])},r.renderHostFilterLoading=function(){return n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("Device")),n.default.createElement("div",{className:"filter-item__filter filter-item__filter--hostId filter-item__filter--loading"},n.default.createElement("img",{src:u.static_url("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),alt:l._("Loading")}))))},r.renderNoHosts=function(e){var t=e?l._("Can only filter by your team’s devices"):l._("Can only filter by your devices");return n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("From device")),n.default.createElement("div",{className:"filter-item__filter filter-item__filter--hostId filter-item__filter--disabled"},n.default.createElement(c.TitleBubble,{content:t,position:c.TitleBubble.POSITIONS.BOTTOM},n.default.createElement(o.DropdownButton,{disabled:!0},l._("Any device"))))))},r.renderHostFilterWithItems=function(e,t){var s=function(t){var r=null!==t&&e.getHostIcon(t),s=null!==t?e.getHostShortName(t):l._("All devices");return n.default.createElement("div",{className:"host-name host-name__row"},r&&n.default.createElement(g.Sprite,{className:"host-name__sprite",alt:"",group:"web",name:r}),n.default.createElement("span",{className:"host-name__description"},s))},o=t&&t.length?t[0]:null,i=n.default.createElement(a.DropdownMenu,{className:"filter-item__filter filter-item__filter--hostId",onSelection:r.onHostSelected},n.default.createElement(a.DropdownMenuButton,{disabled:r.props.disabled},s(o)),n.default.createElement(a.Menu,null,n.default.createElement(a.MenuItem,{value:null},s(null)),e.getHostIdsOrderedByType().map(function(e,t){return n.default.createElement(a.MenuItem,{key:t,value:e},s(e))})));return n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("Device")),i))},r.renderHostFilter=function(e){var t=r.props.hostFilter,n=t.userHostDetails,s=t.selectedHostIds,o=n.get(e);return void 0===o?r.renderHostFilterLoading():o.hasHosts()?r.renderHostFilterWithItems(o,s):r.renderNoHosts(!!r.props.user.is_team)},r.onPathSelected=function(e){var t="/"===e?null:e;r.props.parentFolderFilter.onPathSelected(t)},r.showFolderFilterModal=function(){return f.FolderSelectorModal.show({primaryAction:l._("Select"),secondaryAction:l._("Cancel"),title:l._("Folder filter selector"),ariaLabel:l._("Folder selector"),user:r.props.user,onFolderSelected:r.onPathSelected})},r.renderFolderFilter=function(){return n.default.createElement("div",{className:"filter-item__row"},n.default.createElement("div",{className:"filter-item__column"},n.default.createElement("div",{className:"filter-item__desc"},l._("In folder")),n.default.createElement(v.PathFilterButton,{path:r.props.parentFolderFilter.selectedPath,defaultText:l._("Any folder"),dropdownClasses:"filter-item__filter filter-item__filter--fqPath",onClick:r.showFolderFilterModal})))},r.renderResetButton=function(){return n.default.createElement("div",{className:"filter-item__resetRow"},n.default.createElement(i.TertiaryLink,{onClick:r.props.onFilterClear,className:"filter-item__resetButton"},l._("Reset filters")))},r.state={emailFromUrl:r.props.userFilter.selectedUserEmail},r}return r.__extends(t,e),t.prototype.render=function(){var e=s.default({"filter-item-container":!0,"filter-item-container--disabled":this.props.disabled});return n.default.createElement("div",{className:e},this.renderCalendarFilter(),this.renderUserFilter(),this.props.userFilter.selectedUserEmail&&this.renderHostFilter(this.props.userFilter.selectedUserEmail),this.renderFolderFilter(),E.filtersHaveValue(this.props)&&this.renderResetButton())},t})(n.default.Component);t.TrashFilterViewWithoutCSS=y,t.DeletedFilesFilterView=h.requireCssWithComponent(y,["/static/css/spectrum/index.web-vflI9cXf0.css","/static/css/trash/filter-vflmEAZ-L.css","/static/css/react/contacts_tokenizer-vflQsfYaG.css","/static/css/sprites/web_sprites-vflv2MHAO.css"])}),define("modules/clean/react/trash/trash_filter_util",["require","exports","external/immutable","modules/core/i18n"],function(e,t,r,n){"use strict";function s(e){return!!(e.calendarFilter.minTs||e.calendarFilter.maxTs||e.userFilter.selectedUserEmail||e.hostFilter.selectedHostIds&&e.hostFilter.selectedHostIds.length||e.parentFolderFilter.selectedPath)}Object.defineProperty(t,"__esModule",{value:!0}),t.lastSecondOfDay=function(e){var t=new Date(e.getTime());return t.setDate(t.getDate()+1),new Date(t.getTime()-1)},t.jsDateToUnixSeconds=function(e){return Math.floor(e.getTime()/1e3)},t.unixSecondToJsDate=function(e){return e?new Date(1e3*e):void 0};var o=(function(){function e(t){this.UNKNOWN_HOST_STRING=n._("Unknown"),this.HOST_TYPE_DISPLAY_NAME={iphone:n._("iPhone"),android:n._("Android"),blackberry:n._("Blackberry"),ipad:n._("iPad"),windows_phone:n._("Windows Phone"),win:n._("Windows PC"),mac:n._("Mac"),lnx:n._("Linux"),web:n._("Web")},this.HOST_TYPE_DISPLAY_ICON={iphone:"s_device_mobile_iphone",android:"s_device_mobile_android",blackberry:"s_device_mobile_blackberry",ipad:"s_device_mobile_ipad",windows_phone:"s_device_windows",win:"s_device_windows",mac:"s_device_mac",lnx:"s_device_linux",web:"s_browser_generic"},this.allHostDetails=t,this.groupedHosts=e.groupHostByType(t)}return e.fromUserHostMap=function(t){return r.Map(t.map(function(t){return new e(t)}))},e.groupHostByType=function(e){var t=r.Map().withMutations(function(t){for(var r in e)if(e.hasOwnProperty(r)){var n=e[r].type,s=t.get(n,[]);s.push(parseInt(r,10)),t.set(n,s)}});return r.Map(t.map(function(e){return e.sort()}))},e.prototype.hasHosts=function(){return 0!==Object.keys(this.allHostDetails).length},e.prototype.hasDetailsForHost=function(e){return void 0!==this.allHostDetails[e]},e.prototype.getHostShortName=function(e){if(this.hasDetailsForHost(e)){var t=this.allHostDetails[e].type,r=this.allHostDetails&&this.HOST_TYPE_DISPLAY_NAME[t],n=this.groupedHosts.get(t,[]);if(n.length>1){return r+" ("+(n.indexOf(e)+1)+")"}return r}return this.UNKNOWN_HOST_STRING},e.prototype.getHostDisplayName=function(e){return this.hasDetailsForHost(e)?this.allHostDetails[e].name:this.UNKNOWN_HOST_STRING},e.prototype.getHostIcon=function(e){return this.hasDetailsForHost(e)?this.HOST_TYPE_DISPLAY_ICON[this.allHostDetails[e].type]:null},e.prototype.getHostIdsOrderedByType=function(){var e=[];return this.groupedHosts.forEach(function(t){e=e.concat(t)}),e},e})();t.HostDetailsWrapper=o,t.filtersHaveValue=s}),define("modules/clean/react/trash/trash_modal",["require","exports","tslib","react","external/react-redux","spectrum/button","spectrum/file_icon","spectrum/icon_content","spectrum/media_table","spectrum/modal","spectrum/table","spectrum/tertiary_link","modules/clean/components/loading_indicator","modules/clean/em_string","modules/clean/ux_analytics_utils","modules/clean/react/css","modules/clean/react/icon/folder_icon","modules/clean/react/modal","modules/clean/react/tooltip","modules/clean/react/trash/constants","modules/clean/react/trash/selectors","modules/clean/react/trash/store","modules/clean/sharing/member_avatars","modules/core/browser","modules/core/i18n","modules/clean/react/trash/purge_modal","modules/clean/react/trash/api","modules/clean/react_format"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h,g,E,v,y,S,T,I,b,A,R,C){"use strict";function w(e,t,r){return h.isLegacyFolderIcon(e)?n.default.createElement(i.IconContent,{name:h.convertLegacyFolderIconToSpectrum(e,r),"aria-label":t,role:"img"}):n.default.createElement(a.FileIcon,{path:t,variant:r})}function F(e){var t,r=e.currentModalInfo,n=r.canDisplayContent,s=r.deletedContentInfo,o=r.deletorInfo,a=r.error,i=r.eventDetails,l=r.hasAclRestore,c=r.membershipByFQPath,u=r.noAccessPaths,d=r.permissions,_=r.readyToDisplayContent,p=e.currentModalInfo.deletedContentInfo.sharedFolderPurgeInfo;if(p){t={hasUnmountFromHome:!!(p.sfWithAccessCount+p.sfWithoutAccessCount>0&&s.ns_info&&s.ns_info.map(function(e){return e.nsId}).includes(y.getHomeNsId(e))),sharedFolderWithAccessCount:p.sfWithAccessCount,sharedFolderWithoutAccessCount:p.sfWithoutAccessCount,isOneCompleteFolder:p.isOneCompleteFolder,isUserOwnedNs:p.isUserOwnedNs,userType:y.getUserType(p.userType)}}return{canDisplayContent:n,canPurge:d.canPurge,canRollback:d.canRollback,deletorInfo:o,displayPath:s.displayPath,error:a,eventDetailsURI:s.eventDetailsURI,eventCount:s.eventCount,readOnlyEventCount:s.readOnlyEventCount,fileCount:s.fileCount,fileName:s.fileName,fqPaths:s.fqPaths,referenceFileName:s.referenceFileName,hasAclRestore:l,isReadOnly:d.isReadOnly,isSingleFile:s.isSingleFile,items:i,membershipByFQPath:c,noAccessPaths:u,readyToDisplayContent:_,userId:e.user_id,sharedFolderPurgeInfo:t}}function P(e){g.Modal.showInstance(n.default.createElement(t.TrashModal,r.__assign({},e)))}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),I=r.__importStar(I),t.SingleModalView=function(e){return n.default.createElement("div",{id:"modal-single-container"},n.default.createElement("div",null,w(e.icon,e.text,"large"),n.default.createElement("div",{id:"modal-single-name"},p.Emstring.em_snippet(e.text,34)),n.default.createElement("div",{id:"modal-single-path"},p.Emstring.em_snippet(e.src_path,34,0)),n.default.createElement("div",{id:"modal-single-size"},e.size),n.default.createElement("div",{id:"modal-single-time"},e.deletionString||"")))};var D=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TableHeader=function(){return n.default.createElement("div",{id:"modal-table-header"},n.default.createElement("div",{id:"modal-path",className:"lfloat"},p.Emstring.em_snippet(t.props.displayPath,13,0)),n.default.createElement("div",{id:"modal-timestamp",className:"rfloat"},t.props.deletionString))},t.createSingleModalItem=function(e,r,s){var o=t.props.membershipByFQPath&&t.props.membershipByFQPath[e.fq_path],a=o&&T.buildGroupsAndMembersText(o.groups,o.users,o.invitees,v.MODAL_MAX_SHOWN_AVATARS,"trash-modal__tooltip");return t.props.noAccessPaths&&t.props.noAccessPaths.includes(e.fq_path)&&(a=b._("You don’t have access to this content")),n.default.createElement(l.CulledMediaRow,{key:e.fq_path,topOffset:s,doubleLine:!!t.props.hasAclRestore&&t.props.hasAclRestore[e.fq_path],className:"trash-modal__item-row"},function(){return[n.default.createElement(l.MediaCell,{key:"item_name",highlight:!1,icon:w(e.icon,e.name,"small"),title:p.Emstring.em_snippet(e.name,25),subtitle:a}),n.default.createElement(l.MediaCell,{className:"trash-modal__item-size",key:"item_size",title:e.size,variant:"detail"})]})},t}return r.__extends(t,e),t.prototype.renderEmptyState=function(){return n.default.createElement("div",{id:"modal-empty-state"},n.default.createElement("h3",null,b._("This folder is empty")))},t.prototype.renderPreviewUnavailable=function(){return n.default.createElement("div",{id:"modal-empty-state"},n.default.createElement("h3",null,b._("Preview not available")))},t.prototype.renderTableContents=function(){var e=this.props,t=e.canDisplayContent,r=e.items;return t?0===r.length?this.renderEmptyState():this.renderListView():this.renderPreviewUnavailable()},t.prototype.renderListView=function(){return n.default.createElement(u.CulledTableBody,{items:this.props.items,className:"mc-table-body mc-table-body-culled modal-table-contents",listItemHeight:this.props.hasAclRestore?v.ACL_RESTORE_MODAL_ROW_HEIGHT:v.MODAL_ITEM_ROW_HEIGHT,renderRow:this.createSingleModalItem,shouldUseWindowAsScrollContainer:!1})},t.prototype.render=function(){return n.default.createElement(u.Table,{columnFlex:["1 1 75%","1 1 25%"]},n.default.createElement(this.TableHeader,null),this.renderTableContents())},t})(n.default.Component);t.GroupModalView=D;var N=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isModalOpen:!0},t.onRequestClose=function(){t.props.canPurge&&!t.canShowPurgeModal()&&R.logPurgeModalActivity(t.props.userId,"purge-modal-action-disallowed"),t.setState({isModalOpen:!1}),m.dispatchModalClosed()},t.onReady=function(){return m.dispatchModalOpened()},t.redirectToEventDetails=function(){t.props.eventDetailsURI&&I.redirect(t.props.eventDetailsURI)},t.confirmRestore=function(){var e,r=t.props,n=r.referenceFileName,o=r.fileCount,a=t.props.sharedFolderPurgeInfo&&t.props.sharedFolderPurgeInfo.sharedFolderWithAccessCount||0,i=t.props.sharedFolderPurgeInfo&&t.props.sharedFolderPurgeInfo.sharedFolderWithoutAccessCount||0,l=t.props.sharedFolderPurgeInfo&&t.props.sharedFolderPurgeInfo.isOneCompleteFolder||!1,c=b._("Restore"),u=!0;a>0?e=b._("Some of these items are shared. You no longer have access to some of them,          and others might have changed them since you removed them."):o>i?e=b._("Some of these items are shared. You no longer have access to any of them, so you         can’t restore or permanently delete those items."):(e=b._("Your access to these items was removed, so you can’t restore or permanently         delete them."),c=b._("OK"),u=!1),g.SimpleModal.show({title_text:s.getRestoreConfirmationTitle(n,o,l),body_html:e,confirm_text:c,confirm_callback:u?t.props.onRestore:function(){},cancel_text:b._("Cancel")})},t.confirmPurge=function(){var e=t.props.onPurge;A.showPurgeModal({onPurge:e}),R.logPurgeModalActivity(t.props.userId,"purge-modal-show",{location:"deleted_files"})},t.purgeLinkCreator=function(e){var r=b._("Permanently delete"),s=t.canShowPurgeModal(),o=s?n.default.createElement("span",{className:"trash-modal__purge-link"},r):n.default.createElement(E.Tooltip,{position:E.TooltipPosition.TOP,tooltip_contents:t.getPurgeLinkToolTipText(),tooltip_classname:"trash-modal__tooltip"},r);return n.default.createElement(d.TertiaryLink,{onClick:e,disabled:!s},o)},t.restoreButtonCreator=function(e){var r=b._("Go to Event Details");if(t.props.isReadOnly||t.props.canRollback){r=t.props.fileCount>1||t.props.items&&t.props.items.length>1?b._("Restore all files"):b._("Restore")}var s=1===t.props.fileCount?b._("Only people who can edit this item can restore it."):b._("Only people who can edit these items can restore them."),a=t.props.isReadOnly?n.default.createElement(E.Tooltip,{position:E.TooltipPosition.TOP,tooltip_contents:s,
tooltip_classname:"trash-modal__tooltip"},r):r;return n.default.createElement(o.Button,{variant:"primary",onClick:e,disabled:t.props.isReadOnly},a)},t}return r.__extends(s,e),s.getRestoreConfirmationTitle=function(e,t,r){return t>1&&!r?b.ungettext("Restore %(filename)s and %(count)s more item.","Restore %(filename)s and %(count)s more items.",t-1).format({filename:p.Emstring.em_snippet(e,30).toString(),count:t-1}):b._("Restore %(filename)s?").format({filename:p.Emstring.em_snippet(e,30).toString()})},s.prototype.getDeletionTimeString=function(){if(!this.props.deletorInfo)return"";var e={deletor:"",ago:this.props.deletorInfo.timestamp};if(this.props.deletorInfo.actorName){var t=this.props.isSingleFile?25:15;return e.deletor=p.Emstring.em_snippet(this.props.deletorInfo.actorName,t),b._("%(deletor)s deleted %(ago)s").format(e)}return b._("You deleted %(ago)s").format(e)},s.prototype.renderError=function(){return n.default.createElement("div",{id:"modal-error-state"},n.default.createElement("h3",null,b._("Oops! An error occurred. Please try again later!")))},s.prototype.renderLoader=function(){return n.default.createElement("div",{id:"modal-loading"},n.default.createElement(_.LoadingIndicator,{style:_.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER}))},s.prototype.renderSingleModal=function(){var e=this.props.items;if(e&&e.length)return n.default.createElement(t.SingleModalView,{icon:e[0].icon,text:this.props.referenceFileName,src_path:this.props.displayPath,size:e[0].size,deletionString:this.getDeletionTimeString()})},s.prototype.renderGroupModal=function(){var e=this;if(this.props.items){var t=[];if(t=1===this.props.fqPaths.length?this.props.items.filter(function(t){var r=t.fq_path;return e.props.fqPaths.indexOf(r)===-1}):this.props.items.slice(),this.props.fileCount>v.MAX_FILE_COUNT_TO_DISPLAY){var r=void 0;if(this.props.canRollback){var s=this.props.fileCount-v.MAX_FILE_COUNT_TO_DISPLAY;r=b.ungettext("And %(num)d more file.","And %(num)d more files.",s).format({num:s})}else r=b._("To view or restore all %(file_count)d files, visit Event Details page.").format({file_count:this.props.fileCount});t=t.slice(v.MAX_FILE_COUNT_TO_DISPLAY-1),t.push({icon:"",can_display_content:!0,name:r,size:"",src_path:"",fq_path:""})}return n.default.createElement(D,{items:t,displayPath:this.props.displayPath,membershipByFQPath:this.props.membershipByFQPath,noAccessPaths:this.props.noAccessPaths,deletionString:this.getDeletionTimeString(),canDisplayContent:this.props.canDisplayContent,hasAclRestore:this.props.hasAclRestore})}},s.prototype.renderNoAccessModal=function(){return 1===this.props.fileCount?n.default.createElement("div",{className:"trash-modal__acl-restore-section"},b._("You don’t have permission to view the contents of ‘%(folder_name)s’.               Please note that restoring this folder will reinstate access according to its original members,               including any members of child content. ‘%(folder_name)s’ will remain confidential to you,               but will be accessible by other users.").format({folder_name:this.props.fileName})):n.default.createElement("div",{className:"trash-modal__acl-restore-section"},b._("You don’t have permission to view those items.               Please note that restoring will reinstate access according to its original members,               including any members of child content. ‘%(folder_name)s’ will remain confidential to you,               but will be accessible by other users.").format({folder_name:this.props.fileName}))},s.prototype.renderSomeAccessModal=function(){return n.default.createElement("div",{className:"trash-modal__acl-restore-section"},b._("You don’t have permission to view some of the contents of some of these files.             Please note that restoring these folders will reinstate access according to its original members,             including any members of child content. The folders you lack permission to view will remain             confidential to you, but will be accessible by other users."))},s.prototype.renderModalContainerContents=function(){return this.props.error?this.renderError():this.props.readyToDisplayContent?this.props.isSingleFile?this.renderSingleModal():this.renderGroupModal():this.renderLoader()},s.prototype.getPurgeLinkToolTipText=function(){if(!this.props.sharedFolderPurgeInfo)return"";switch(this.props.sharedFolderPurgeInfo.userType){case v.ADMIN:return b._("Permanently delete in the admin console");case v.MEMBER:return b._("Only an admin can permanently delete");default:return b._("Only the owner can permanently delete")}},s.prototype.canShowPurgeModal=function(){if(!this.props.sharedFolderPurgeInfo)return!1;var e=this.props.canPurge,t=this.props.sharedFolderPurgeInfo,r=t.isUserOwnedNs,n=t.sharedFolderWithAccessCount,s=t.sharedFolderWithoutAccessCount,o=t.userType;return A.isPurgeModalActionAllowed(r,n,s,o,e)},s.prototype.renderSingleAvatar=function(e){return e.hasOwnProperty("gid")?T.renderGroup({group:e}):e.hasOwnProperty("user_id")?T.renderJoinedMember({arePairedUsersInSF:!1,member:e}):e.hasOwnProperty("invitation_id")?T.renderInvitedPerson({invited_member:e}):null},s.prototype.renderAvatars=function(){var e=this.props,t=e.fqPaths,r=e.membershipByFQPath;if(t.length>1)return null;var s=this.props.fqPaths[0];if(!r||!r[s])return null;var o,a=r[s],i=[],l=a.groups.concat(a.users,a.invitees),c=0;l.length>v.MODAL_MAX_SHOWN_AVATARS?(o=l.slice(0,v.MODAL_MAX_SHOWN_AVATARS-1),c=l.length-o.length):o=l;for(var u=0,d=o;u<d.length;u++){var _=d[u],p=this.renderSingleAvatar(_);p&&i.push(p)}return c>0&&i.push(T.renderOverflowCount()({overflowCount:c})),n.default.createElement("div",{className:"trash-modal__avatar-list"},i)},s.prototype.renderACLRestoreTextIfNeeded=function(){if(!this.props.hasAclRestore||!this.props.readyToDisplayContent)return null;if(this.props.isReadOnly)return null;for(var e=0,t=Object.keys(void 0!==this.props.hasAclRestore&&null!==this.props.hasAclRestore?this.props.hasAclRestore:{});e<t.length;e++){var r=t[e];if(this.props.hasAclRestore[r])return n.default.createElement("div",{className:"trash-modal__acl-restore-section"},b._("Everyone who had access to this content before will have access again."))}return null},s.prototype.renderSharedFolderTextIfNeeded=function(){var e=this.props.sharedFolderPurgeInfo;if(!e)return null;var t;return t=e.sharedFolderWithAccessCount===this.props.fileCount?C.reactFormat(b.ungettext("This shared folder will be added back to your Dropbox account.<br/><br/> Because           this folder is shared, other people might have made changes to it since it was           removed from your account.","These shared folders will be added back to your Dropbox account.<br/><br/> Because           these folders are shared, other people might have made changes to them since they were           removed from your account.",this.props.fileCount),{br:n.default.createElement("br",null)}):b._("Some of these items are shared, so other people might have made changes since             they were removed from your account."),e&&e.sharedFolderWithAccessCount>0?n.default.createElement("div",{className:"trash-modal__acl-restore-section"},t):null},s.prototype.renderUnselectSuggestionIfNeeded=function(){return this.props.isReadOnly?this.props.eventCount<=1?null:this.props.eventCount===this.props.readOnlyEventCount?null:n.default.createElement("div",{className:"trash-modal__acl-restore-section"},b._("You don’t have access to some of those files. To perform a restore, uncheck the             files you don’t have access to and try again.")):null},s.prototype.howManyEventsCanWeView=function(){var e=this.props,t=e.noAccessPaths,r=e.fqPaths;if(!t)return v.EventViewState.ALL;var n=r.filter(function(e){return!t.includes(e)}).length;return n===this.props.fqPaths.length?v.EventViewState.ALL:0===n?v.EventViewState.NONE:v.EventViewState.SOME},s.prototype.getTitle=function(){var e=this.props,t=e.fileCount,r=e.referenceFileName,n=e.sharedFolderPurgeInfo,s=n&&n.isOneCompleteFolder||!1;return t>1&&!s?p.Emstring.em_snippet(b.ungettext("%(filename)s and %(num)s more item","%(filename)s and %(num)s more items",t-1).format({filename:r,num:t-1}),30):p.Emstring.em_snippet(r,30)},s.prototype.render=function(){var e=this.props,t=e.canPurge,r=e.canRollback,s=e.sharedFolderPurgeInfo,o=s&&s.hasUnmountFromHome,a=this.redirectToEventDetails;r&&(a=o&&s&&s.sharedFolderWithoutAccessCount>0?this.confirmRestore:this.props.onRestore);var i=t?this.purgeLinkCreator:void 0,l=this.props.referenceFileName&&this.getTitle(),u=n.default.createElement("div",null,l,this.renderAvatars()),d=void 0,_=this.howManyEventsCanWeView();return d=_===v.EventViewState.NONE?this.renderNoAccessModal():n.default.createElement("div",null,n.default.createElement("div",{id:"modal-table-container"},this.renderModalContainerContents()),this.renderACLRestoreTextIfNeeded(),this.renderSharedFolderTextIfNeeded(),this.renderUnselectSuggestionIfNeeded(),_===v.EventViewState.SOME&&this.renderSomeAccessModal()),n.default.createElement(c.UtilityModal,{displayCloseButton:!1,overlayClickClose:!0,ariaLabel:b._("Restore content"),className:"trash-modal",link:i,onPrimaryAction:a,onSecondaryAction:this.onRequestClose,onLink:this.confirmPurge,onRequestClose:this.onRequestClose,onReady:this.onReady,open:this.state.isModalOpen,overlayClassName:"trash-modal--overlay",primaryAction:this.restoreButtonCreator,secondaryAction:b._("Cancel"),title:this.props.hasAclRestore?u:l},n.default.createElement("div",{className:"uxa-modal",id:"trash-modal"},d))},s})(n.default.Component);t.InternalTrashModal=N;var M=s.connect(F)(N),O=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(s.Provider,{store:S.TrashStore},n.default.createElement(M,r.__assign({},this.props)))},t})(n.default.Component);t.TrashModal=f.requireCssWithComponent(O,["/static/css/trash-vflqvZ2WB.css"]),t.showTrashModal=P}),define("modules/clean/react/trash/trash_modal_util",["require","exports","tslib","modules/clean/filepath","modules/clean/react/trash/actions","modules/clean/react/trash/constants","modules/clean/react/trash/store","modules/clean/react/trash/trash_modal","modules/clean/viewer","modules/core/i18n","modules/core/uri","modules/clean/react/trash/purge_modal","modules/clean/react/trash/selectors","modules/clean/react/trash/api","modules/clean/react/trash/selectors"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m){"use strict";function f(e,t,r,n,s){h(e,t,s),i.showTrashModal({onRestore:r,onPurge:n})}function h(e,t,r){a.TrashStore.dispatch(s.setUserId(e)),a.TrashStore.dispatch(s.loadModalData(s.getEventDetailsFromEvents(t)));var n=g({userId:e,events:t}),o=n.deletedContentInfo,i=n.permissions,l=n.deletorInfo;a.TrashStore.dispatch(s.initializeModal(o,i,l))}function g(e){var t=e.userId,n=e.events;if(n.length<1)throw new Error("At least one event expected");var s={fqPaths:n.map(function(e){return e.containing_deletion_path}),isSingleFile:1===n.length&&1===n[0].file_count&&!n[0].is_folder,fileCount:n.reduce(function(e,t){return e+t.file_count},0),eventCount:n.length,readOnlyEventCount:n.reduce(function(e,t){return e+(t.cs_info.is_read_only?1:0)},0),ns_info:n.map(function(e){return{nsId:e.ns_id,isUserOwnedNs:e.is_user_owned_ns_id,userType:_.getUserType(e.user_type),ownedSfCount:e.owned_sf_count,isHomeNsId:e.ns_id===m.getHomeNsId(a.TrashStore.getState()),sfWithAccessCount:e.sf_with_access_count-e.owned_sf_count,sfWithoutAccessCount:e.sf_without_access_count,canPurge:e.cs_info.can_purge,fileCount:e.file_count,isOneCompleteFolder:e.is_folder}}),referenceFileName:n[0].reference_file_name};if(1===n.length){var o=n[0],i=new u.URI({path:"/event_details/"+t+"/"+o.ns_id+"/"+o.cs_info.cs_id+"/0"}).toString(),l=r.__assign({displayPath:o.src_path,eventDetailsURI:i,fileName:o.file_name,ns_id:o.ns_id,sharedFolderPurgeInfo:{sfWithAccessCount:o.sf_with_access_count,sfWithoutAccessCount:o.sf_without_access_count,isOneCompleteFolder:o.is_folder,ownedSfCount:o.owned_sf_count,isUserOwnedNs:o.is_user_owned_ns_id,userType:o.user_type}},s),c={actorName:o.name,timestamp:o.ago},d={canRollback:o.cs_info.can_rollback,canPurge:!1,isReadOnly:o.cs_info.is_read_only||!1};return{deletedContentInfo:l,permissions:d,deletorInfo:c}}var c=void 0,l=r.__assign({fileName:n[0].file_name,displayPath:"Selected items",sharedFolderPurgeInfo:{sfWithAccessCount:n.reduce(function(e,t){return e+t.sf_with_access_count},0),sfWithoutAccessCount:n.reduce(function(e,t){return e+t.sf_without_access_count},0),isOneCompleteFolder:!1,ownedSfCount:n.reduce(function(e,t){return e+t.owned_sf_count},0),isUserOwnedNs:n.reduce(function(e,t){return e&&t.is_user_owned_ns_id},!0),userType:n.reduce(function(e,t){if("off_team"===e)return"off_team";if("non_team"===e)return"non_team";var r=t.user_type;return"admin"===e?"admin"!==r?r:e:"member"===e?"member"!==r&&"admin"!==r?r:e:"non_team"},n[0].user_type)}},s),d={canRollback:!0,canPurge:!1,isReadOnly:n.reduce(function(e,t){return e||t.cs_info.is_read_only},!1)||!1};return{deletedContentInfo:l,permissions:d,deletorInfo:c}}function E(e){var t=e.userId,r=e.context,n=e.files,u=e.onRestore;a.TrashStore.dispatch(s.setUserId(t,r.isNonUserRelativeContext)),a.TrashStore.dispatch(s.loadModalData(s.getEventDetailsFromBrowse(r,n&&n.slice(0,o.MAX_FILE_COUNT_TO_DISPLAY))));var d=n?n.length:1,_=l.Viewer.get_root_name(l.Viewer.get_viewer().get_user_by_id(t)),p=y(n,r,_),m={fileCount:d,fqPaths:[p.fqPath],eventCount:d,readOnlyEventCount:0,fileName:n&&d>1?c._("Restore %(file_count)s items…").format({file_count:d}):p.fileName,referenceFileName:p.fileName,displayPath:(p.fqPath.startsWith("/")?p.fqPath.slice(1):p.fqPath)||_,isSingleFile:!(!n||1!==d||n[0].is_dir),sharedFolderPurgeInfo:void 0},f={canRollback:!0,canPurge:!1,isReadOnly:!1};a.TrashStore.dispatch(s.initializeModal(m,f,p.deletorInfo)),i.showTrashModal({onRestore:u})}function v(e){var t=e.userId,r=e.context,i=e.files,u=e.onPurge;a.TrashStore.dispatch(s.setUserId(t,r.isNonUserRelativeContext));var _=i?i.length:1,m=l.Viewer.get_root_name(l.Viewer.get_viewer().get_user_by_id(t)),f=y(i,r,m),h=i&&_>1?c._("%(filename)s and %(file_count)s other %(item)s").format({filename:n.filename(i[0].fq_path,m),file_count:_-1,item:_-1>1?c._("items"):c._("item")}):f.fileName,g=(f.fqPath.startsWith("/")?f.fqPath.slice(1):f.fqPath)||m,E={fileCount:_,fqPaths:[f.fqPath],fileName:h,displayPath:g,referenceFileName:i&&_>1?n.filename(i[0].fq_path,m):f.fileName,isSingleFile:!(!i||1!==_||i[0].is_dir)};a.TrashStore.dispatch(s.initializePurgeModal(E,f.deletorInfo)),a.TrashStore.dispatch(s.loadModalData(s.getPurgeEventDetailsFromBrowse(r,i&&i.slice(0,o.MAX_FILE_COUNT_TO_DISPLAY)))),d.showPurgeModal({onPurge:u}),p.logPurgeModalActivity(t,"purge-modal-show",{location:"browse"})}function y(e,t,r){var s,o,a,i=e?e.length:1;if(e&&1===i){var l=e[0];a=l.ago?{actorName:l.last_modified_name,timestamp:l.ago}:void 0,o=n.filename(l.fq_path,r),s=l.is_dir?l.fq_path:n.parent_dir(l.fq_path)}else s=t.currentFQPath,o=n.filename(s,r);return{fileName:o,fqPath:s,deletorInfo:a}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importStar(s),o=r.__importStar(o),t.openTrashModalFromDeletionEvent=f,t.initializeTrashStore=h,t.getTrashStoreProps=g,t.openTrashModalFromBrowseFiles=E,t.openPurgeModalFromBrowseFiles=v}),define("modules/clean/react/trash/trash_view",["require","exports","tslib","spectrum/table","react","modules/clean/analytics","modules/clean/react/maestro/header","modules/clean/react/maestro/layout","modules/clean/react_format","modules/clean/react/selection","modules/clean/static_urls","modules/clean/react/trash/trash_modal_util","modules/constants/trademark","modules/core/i18n","modules/clean/react/trash/trash_filter_sidebar","modules/clean/react/trash/trash_filter_util","modules/clean/react/trash/trash_view_row","modules/clean/react/selectable_list","modules/clean/react/trash/constants","modules/clean/account_page/components/sidebar","spectrum/button","external/reselect","spectrum/tertiary_link","modules/clean/react/trash/purge_modal","modules/clean/react/trash/api","modules/clean/search/search_bar/experiments","modules/clean/react/trash/restorations_education","spectrum/tip_card","spectrum/vertically_fixed"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m,f,h,g,E,v,y,S,T,I,b,A,R,C,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s);var F=(function(e){function t(t){var r=e.call(this,t)||this;return r.launchModal=function(e){var t=e.reduce(function(e,t){return e+t.file_count},0);o.WebMiscActivityLogger.log("trash-modal-launch",{file_count:t}),d.openTrashModalFromDeletionEvent(r.props.user.id,e,r.makeRestoreCallback(e),r.makePurgeCallback(e)),r.props.restoreId&&o.RestorationStepsLogger.log_step({userId:r.props.user.id,restoreId:r.props.restoreId,step:"user opened restore modal"})},r.launchModalWithSelection=function(){r.launchModal(r.getSelectedEvents())},r.updateOnScroll=function(){var e=window.pageYOffset;if(Math.abs(e-r.state.scrollPosition)>r.props.listItemHeight)return r.setState({scrollPosition:e})},r.clickOnRow=function(e){if(!r.isInSelectMode())return r.launchModal([e])},r.isInSelectMode=function(){return r.state.selection.selected.size>0},r.numSelected=function(){return r.state.selection.selected.size},r.makeRowSelectCallback=function(e,t){return function(r,n,s){n?e(r.pkey,s):t(r.pkey,s)}},r.renderRow=function(e,t,n){var o=e.event,a=e.isSelected,i=e.handleSelect,l=e.deletionFilterStatus,c=e.isInSelectionMode,u=e.isFocused,d=r.isInSelectMode(),_=r.props.filesCurrentlyBeingRestored.has(o.pkey);return s.default.createElement(h.TrashViewRow,{isInSelectionMode:c,onClick:r.clickOnRow,isFocused:u,isSelected:a,isRestoring:_,onSelect:i,deletionFilterStatus:l,isInSelectMode:d,event:o,index:t,topOffset:n})},r.handleSelectionChange=function(e){r.setState({selection:e})},r.handleTabbingStart=function(){},r.getTrashViewRowItems=S.createSelector(function(e){return e.events},function(e){return e.selection},function(e){return e.handleSelect},function(e){return e.handleDeselect},function(e){return e.deletionFilterStatus},function(e){return e.selection.selected.size>0},function(e,t,n,s,o,a){return e.map(function(e){var i=t.selected.last()===e.pkey;return{event:e,isSelected:t.selected.has(e.pkey),isFocused:i,handleSelect:r.makeRowSelectCallback(n,s),deletionFilterStatus:o,isInSelectionMode:a}})}),r.renderTrashContentTable=function(e){var t=(e.focusedFileId,e.handleDeselect),o=(e.handleDeselectAll,e.handleFocusFile,e.handleSelect),a=(e.handleSelectAll,e.isSelectableListEvent,E.TRASH_VIEW_COLUMN_MULTISELECT_FLEX);return s.default.createElement(n.Table,{columnFlex:a,key:"trash-content"},r.makeTableHeader(),r.props.expRestorationsEducation&&s.default.createElement(R.DeletedFilesEducation,{daysOfVersionHistory:r.props.userVersionHistoryLength}),s.default.createElement(n.CulledTableBody,{items:r.getTrashViewRowItems({events:r.props.events,handleDeselect:t,handleSelect:o,selection:r.state.selection,deletionFilterStatus:r.props.deletionFilterStatus}),listItemHeight:r.props.listItemHeight,renderRow:r.renderRow}))},r.filtersHaveValue=function(e){var t=e.calendarFilterSettings,r=e.userFilterSettings,n=e.hostFilterSettings,s=e.parentFolderSettings;return f.filtersHaveValue({calendarFilter:t,userFilter:r,hostFilter:n,parentFolderFilter:s})},r.hasEventsToRender=function(){return r.props.events.length>0},r.getSelectedEvents=function(){var e=r.state.selection.selected,t=r.eventsByPKey();return e.toArray().map(function(e){return t[e]})},r.confirmPurge=function(){var e=r.getSelectedEvents(),t=r.makePurgeCallback(e);d.initializeTrashStore(r.props.user.id,r.getSelectedEvents()),I.showPurgeModal({onPurge:t}),b.logPurgeModalActivity(r.props.user.id,"purge-modal-show",{location:"deleted_files"})},r.state={scrollPosition:0,selection:c.createSelection()},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this.updateOnScroll),this.updateOnScroll()},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.updateOnScroll)},t.prototype.makeRestoreCallback=function(e){var t=this;return function(){t.props.onRestoreDeletionEvent(e),t.setState({selection:c.createSelection()})}},t.prototype.makePurgeCallback=function(e){var t=this;return function(){t.props.onPurgeDeletionEvent(e),t.setState({selection:c.createSelection()})}},t.prototype.makeTableHeader=function(){return s.default.createElement(n.FixedTableHead,null,s.default.createElement(n.TableHeadCell,{className:"trash-checkbox-cell"}),s.default.createElement(n.TableHeadCell,null,p._("Name")),s.default.createElement(n.TableHeadCell,null,p._("Deleted")))},t.prototype.renderTrashContent=function(){return s.default.createElement(g.SelectableList,{itemIds:this.props.events.map(function(e){return e.pkey}),keyScope:g.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:this.handleSelectionChange,onTabbingStart:this.handleTabbingStart,selection:this.state.selection,tilesPerRow:E.SELECTABLE_LIST_TILES_PER_ROW},this.renderTrashContentTable)},t.prototype.maybeRenderEVHUpsellBanner=function(){var e=this.props.user;return e.is_team?null:e.paid||"basic_biz_domain"===this.props.evhUserType?!e.paid&&"basic_biz_domain"===this.props.evhUserType||e.paid&&"plus_biz_domain_can_have_evh"===this.props.evhUserType?s.default.createElement("div",{className:"trash-evh-upsell-banner",key:"evhupsell"},s.default.createElement("span",null,p._("You have up to 30 days to restore a deleted file.")),s.default.createElement("br",null),l.reactFormat(p._("To keep deleted files for up to 120 days, <a>upgrade to %(trademark)s</a>."),{a:s.default.createElement("a",{href:"/plans",target:"_blank",rel:"noopener noreferrer"}),trademark:_.TRADEMARK_BUSINESS})):null:s.default.createElement("div",{className:"trash-evh-upsell-banner",key:"evhupsell"},s.default.createElement("span",null,p._("You have up to 30 days to restore a deleted file.")),s.default.createElement("br",null),l.reactFormat(p._("To keep deleted files for up to 120 days, <a>upgrade to Dropbox %(trademark)s</a>."),{a:s.default.createElement("a",{href:"/plans",target:"_blank",rel:"noopener noreferrer"}),trademark:_.TRADEMARK_PROFESSIONAL}))},t.prototype.renderNoTrash=function(){var e,t;return e=this.filtersHaveValue(this.props.deletionFilterStatus)?p._("No deleted files found. Try adjusting your filters"):p._("You don’t have any recently deleted files"),t=u.static_url("/static/images/empty_states/illo-trash-vflwBmpyb.png"),s.default.createElement("div",{className:"tab-empty-state",id:"trash-empty-state",key:"notrash"},s.default.createElement("img",{src:t,alt:""}),s.default.createElement("div",{className:"empty-explanation"},s.default.createElement("div",{className:"page-header-text"},e),this.maybeRenderEVHUpsellBanner()))},t.prototype.renderFetchingTrash=function(){return s.default.createElement("div",{className:"maestro-loading-spinner-wrapper",key:"fetchingtrash"},s.default.createElement("div",{className:"maestro-loading-spinner"}))},t.prototype.renderFetchingMore=function(){return s.default.createElement("div",{className:"maestro-loading-spinner-more-data",key:"fetchingmore"},s.default.createElement("div",{className:"maestro-loading-spinner"}))},t.prototype.renderRestoreFilesTip=function(){return s.default.createElement("div",{className:"trash-restore-files-tip__shadow",key:"trash-restore-files-tip"},s.default.createElement(w.VerticallyFixed,{className:"trash-restore-files-tip"},s.default.createElement(C.TipCard,{onDismiss:this.props.onRestoreFilesTipDismiss,dismissAriaLabel:p._("dismiss"),dismissible:!0},l.reactFormat(p._("Need help restoring deleted files? <a>Learn more</a>",{project:"maestro"}),{a:s.default.createElement("a",{href:"/help/9217"})}))))},t.prototype.renderBody=function(){var e=[];return this.props.expRestorationsEducation||this.props.seenRestoreFilesTip||e.push(this.renderRestoreFilesTip()),this.hasEventsToRender()?(e.push(this.renderTrashContent()),this.props.handleComponentReady("TrashView"),this.props.loading?e.push(this.renderFetchingMore()):e.push(this.maybeRenderEVHUpsellBanner())):this.props.loading?e.push(this.renderFetchingTrash()):(e.push(this.renderNoTrash()),this.props.handleComponentReady("TrashView")),s.default.createElement("div",{className:"trash-body"},e)},t.prototype.renderFilterView=function(){var e=this.props.deletionFilterStatus,t=e.calendarFilterSettings,r=e.userFilterSettings,n=e.hostFilterSettings,o=e.parentFolderSettings,a=e.onFilterClear,i=!!this.props.filterViewDisabled||!this.hasEventsToRender()&&!this.filtersHaveValue(this.props.deletionFilterStatus);return s.default.createElement(m.DeletedFilesFilterView,{user:this.props.user,disabled:i,calendarFilter:t,userFilter:r,hostFilter:n,parentFolderFilter:o,onFilterClear:a})},t.prototype.eventsByPKey=function(){for(var e={},t=0,r=this.props.events;t<r.length;t++){var n=r[t];e[n.pkey]=n}return e},t.prototype.renderSelectModeSidebarView=function(){return s.default.createElement(v.Sidebar,{content:s.default.createElement("div",null,s.default.createElement("span",{className:"primary-action-menu__header-text"},p.ungettext("%(file_count)d item selected","%(file_count)d items selected",this.numSelected()).format({file_count:this.numSelected()})),s.default.createElement(y.Button,{onClick:this.launchModalWithSelection,fullWidth:!0},p._("Restore")),s.default.createElement("ul",{className:"mc-tertiary-list secondary-action-menu"},s.default.createElement("li",{className:"mc-tertiary-list-element"},s.default.createElement(T.TertiaryLink,{onClick:this.confirmPurge,icon:"delete"},p._("Permanently delete")))))})},t.prototype.renderSidebar=function(){return this.isInSelectMode()?this.renderSelectModeSidebarView():this.renderFilterView()},t.prototype.render=function(){var e={searchBarExperiments:this.props.searchBarExperiments,enableDeletedChip:A.isInDeletedFilterRightRailExperiment(this.props.searchBarExperiments),currentPath:this.props.deletionFilterStatus.parentFolderSettings.selectedPath};return s.default.createElement(i.MaestroChrome,{user:this.props.user,titleRegion:s.default.createElement(a.MaestroHeaderTitle,null,p._("Deleted files")),embeddedAppRegion:this.renderBody(),actionSidebarRegion:this.renderSidebar(),searchBarProps:e})},t.defaultProps={filterViewDisabled:!1,listItemHeight:72,loading:!1,seenRestoreFilesTip:!1,handleComponentReady:function(e){return null}},t})(s.default.Component);t.TrashView=F}),define("modules/clean/react/trash/trash_view_row",["require","exports","tslib","react","external/react-dom","external/classnames","spectrum/checkbox","modules/clean/react/tooltip","modules/core/i18n","spectrum/media_table","modules/clean/react/file_path_breadcrumb","spectrum/file_icon","spectrum/icon_content","modules/clean/react/icon/folder_icon","spectrum/icon_status"],function(e,t,r,n,s,o,a,i,l,c,u,d,_,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),o=r.__importDefault(o);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.handleClick=function(e){var r=t.props.event;if(!(t.props.isRestoring||t.checkboxRef&&s.findDOMNode(t.checkboxRef).contains(e.target)))return t.props.isInSelectionMode&&t.props.onSelect?void t.props.onSelect(t.props.event,!t.props.isSelected,!1):t.props.onClick(r)},t.handleSelectionChange=function(e,r,n){t.props.onSelect&&t.props.onSelect(t.props.event,"checked"===e,r.shiftKey)},t.setCheckboxRef=function(e){t.checkboxRef=e},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){if(this.props.isFocused){var e=s.findDOMNode(this.checkboxRef);e&&e.focus()}},t.prototype.renderLeftmostColumn=function(e){var t=this.props,r=t.isInSelectMode,s=t.isRestoring,o=e||r;return s?n.default.createElement("div",{className:"trash-vertically-center"},n.default.createElement(m.IconStatus,{name:"sync",rotating:!0})):e||r?n.default.createElement("div",{className:"trash-vertically-center"},n.default.createElement(a.Checkbox,{ref:this.setCheckboxRef,checked:this.props.isSelected?"checked":"unchecked",ariaLabel:"selected",variant:o?"default":"invisible",onChange:this.handleSelectionChange})):void 0},t.prototype.render=function(){var e=this,t=this.props,r=t.event,s=t.topOffset,a=t.isSelected,u=t.isRestoring,d=t.deletionFilterStatus,_=r.is_folder,p=_||r.file_count>1,m=void 0;if(r.actor_email&&d.userFilterSettings.selectedUserEmail){var f=d.hostFilterSettings.userHostDetails.get(r.actor_email);f&&(m=n.default.createElement(i.Tooltip,{position:i.TooltipPosition.RIGHT,tooltip_contents:f.getHostDisplayName(r.host_id),tooltip_classname:"trash-row__tooltip"},f.getHostShortName(r.host_id)))}else r.name&&(m=l._("by %(event_name)s").format({event_name:r.name}));return n.default.createElement(c.CulledMediaRow,{key:r.pkey,doubleLine:!0,variant:a?"selected":"default",className:o.default("mc-table-row-culled",{"trash-group-item":!!p,"trash-row-restoring":u}),onClick:this.handleClick,topOffset:s},function(t){var s=t.isHovered,o=s&&!e.props.isRestoring;return[n.default.createElement(c.MediaCell,{key:"checkboxCell",className:"trash-checkbox-cell"},e.renderLeftmostColumn(s)),n.default.createElement(c.MediaCell,{key:"event_title",highlight:o,icon:e.renderEventIcon(r,_),title:r.file_name,subtitle:e.renderDeletionPath(r.src_path)}),n.default.createElement(c.MediaCell,{key:"event_meta",title:r.ago,subtitle:m,variant:"detail"})]})},t.prototype.renderEventIcon=function(e,t){return t?n.default.createElement(_.IconContent,{name:p.convertLegacyFolderIconToSpectrum(e.icon,"small")}):n.default.createElement(d.FileIcon,{path:e.file_name})},t.prototype.renderDeletionPath=function(e){if(e){for(var t=[{name:"Dropbox",url:""}],r=0,s=e.split("/");r<s.length;r++){var o=s[r];t.push({name:o,url:""})}return n.default.createElement("span",{className:"deletion-path"},n.default.createElement(u.FilePathBreadcrumb,{paths:t,useLinks:!1,pathClassname:"deletion-path__item",maxWidth:25}))}},t})(n.default.Component);t.TrashViewRow=f}),define("modules/clean/react/trash/utils",["require","exports","tslib"],function(e,t,r){"use strict";function n(e){var t=e.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(null==t)return null;var r=t[1],n=t[2],s=t[3];1===r.length&&(r="0"+r),1===n.length&&(n="0"+n);var o=Date.parse(s+"-"+n+"-"+r);return isNaN(o)?null:Number(new Date(Number(s),Number(n)-1,Number(r)))}function s(){return r.__awaiter(this,void 0,Promise,function(){return r.__generator(this,function(e){return[2,new Promise(function(e){requestAnimationFrame(function(){return e()})})]})})}function o(e){return Math.floor(Math.min(e||+(1/0),Date.now()/1e3))}function a(e,t){var r=function(e){var t=a||Number.MIN_VALUE,r=i||Number.MAX_VALUE;return e.timestamp>=t&&e.timestamp<=r},n=function(e){return null===l||e.actor_email===l},s=function(e){return null===c||0===c.length||c.includes(e.host_id)},o=function(e){return null===u||e.containing_deletion_path.startsWith(u)},a=t.start_ts,i=t.end_ts,l=t.actor_email,c=t.selected_host_ids,u=t.fq_path;return e.sort(function(e,t){return t.timestamp-e.timestamp}).filter(function(e){return r(e)&&n(e)&&s(e)&&o(e)})}function i(e,t){return e[".tag"]===t}function l(e,t){return e[".tag"]===t}function c(e){return i(e,"success")?"success":i(e,"partial_success")?"partial_success":"failed"}function u(e){return l(e,"invalid_arguments")?"invalid_arguments":l(e,"not_deleted")?"not_deleted":l(e,"unauthorized_namespace")?"unauthorized_namespace":l(e,"insufficient_permissions")?"insufficient_permissions":l(e,"too_many_writes")?"too_many_writes":l(e,"already_purged")?"already_purged":l(e,"transient_error")?"transient_error":"unknown"}Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateFromString=n,t.nextRAF=s,t.determineMaxTs=o,t.getFilteredEventsWithFilters=a,t.isPurgeStateType=i,t.isPurgeErrorType=l,t.getPurgeState=c,t.getPurgeError=u});
//# sourceMappingURL=pkg-deleted_files.min.js-vflCgiaN6.map