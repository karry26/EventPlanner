define(["require","exports","tslib","spectrum_comments/comment_editor/core/class_decorators","spectrum_comments/folder_overview_editor/layers/scaffold","spectrum_comments/comment_editor/core/types","draft-js","spectrum_comments/folder_overview_editor/utils"],function(e,t,o,n,r,a,i,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMentionShareFlowHandlers={onShare:function(){},onMention:function(){return new Promise(function(e){return e({userInFolder:!0,shouldShowSharePopup:!1})})}};var u=(function(e){function t(t){var o=e.call(this)||this;return o.options=t,o}return o.__extends(t,e),t.prototype.addPendingFlagToMention=function(e){var t=e.status.draft.editorState,o=e.innerProps.evt,n=o.mentionKey,r=o.mentionData,a=o.user,i=this.options.onMention(r),u=p.mergeMentionEntityData(t,n,!0);e.triggers.draft.change(u),i.then(function(o){if(o.shouldShowSharePopup)e.triggers.mentionShareFlow.updatePopupProps({mentionKey:n,mentionData:r,user:a});else if(o.userInFolder){var i=p.mergeMentionEntityData(t,n,!1);e.triggers.draft.change(i)}})},t.prototype.updatePopupProps=function(e){return e.triggers.draft.readOnly(!!e.innerProps.evt),e.innerProps.evt},t.prototype.onShare=function(e){var t=e.innerProps.evt,o=t.mentionKey,n=t.mentionData,r=t.user,a=function(){e.triggers.mentionShareFlow.onShareCompleted({mentionKey:o,mentionData:n,user:r})};this.options.onShare(n,o,a)},t.prototype.onShareCompleted=function(e){var t=e.innerProps.evt.mentionKey,o=e.status.draft.editorState,n=p.updateMentionEntityState(t,o),r=i.EditorState.forceSelection(n,n.getSelection());e.triggers.draft.change(r)},t.prototype.updateReadonly=function(e){return e.innerProps.evt},t.prototype.closePopupOnChange=function(e){e.innerProps.prevStatus.draft.editorState.getCurrentContent()!==e.status.draft.editorState.getCurrentContent()&&e.status.mentionShareFlow.popupProps&&e.triggers.mentionShareFlow.updatePopupProps(null)},o.__decorate([n.plug(r.intoFolderOverview.mentionSuggestions.on.onApplyMentionToRange)],t.prototype,"addPendingFlagToMention",null),o.__decorate([n.plug(r.intoFolderOverview.mentionShareFlow.on.updatePopupProps.update.popupProps)],t.prototype,"updatePopupProps",null),o.__decorate([n.plug(r.intoFolderOverview.mentionShareFlow.on.onShare)],t.prototype,"onShare",null),o.__decorate([n.plug(r.intoFolderOverview.mentionShareFlow.on.onShareCompleted)],t.prototype,"onShareCompleted",null),o.__decorate([n.plug(r.intoFolderOverview.draft.on.readOnly.update.readOnly)],t.prototype,"updateReadonly",null),o.__decorate([n.plug(r.intoFolderOverview.draft)],t.prototype,"closePopupOnChange",null),t})(a.BaseLayer);t.MentionShareFlowLayer=u});
//# sourceMappingURL=mention_share_flow.min.js-vflbQGDx1.map