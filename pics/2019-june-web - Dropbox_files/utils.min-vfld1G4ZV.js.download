define(["require","exports","tslib","modules/clean/open_with","modules/clean/file_store/utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/types","modules/clean/react/file_viewer/unity/unity_utils","modules/clean/react/file_viewer/open_with_helpers","modules/clean/react/paper/utils","modules/clean/react/file_viewer/data/actions","modules/core/i18n","modules/clean/react/extensions/utils","modules/clean/react/extensions/connect_flow","modules/clean/cloud_docs/open_with_utils"],function(e,n,t,i,r,o,l,s,u,a,p,c,d,f,_){"use strict";function h(e){var n=e.file,i=t.__rest(e,["file"]);return r.isBrowseFile(n)?m(t.__assign({file:n},i)):r.isSharedFile(n)?O(t.__assign({file:n},i)):[]}function O(e){for(var n=e.file,t=e.user,i=e.isOpenWithDisabled,r=[],o={gdd:!e.isCloudEditorDisabled,wopi:v({file:n,isOpenWithDisabled:i,user:t})},l=e.actionSource,s=_.getOpenWithCloudEditorInfo(n,t,o,l),u=function(e){r.push({handler:function(){return e.handler(n,t,l)},spriteName:e.spriteName||null,iconUrl:e.iconUrl,text:e.text,type:e.type,userAction:e.userAction})},a=0,p=s;a<p.length;a++){u(p[a])}return r}function m(e){var n=e.file,t=e.hasOpenInPaperSupport,i=e.isUnityDisabled,r=e.isOpenWithDisabled,s=e.isCloudEditorDisabled,a=e.unityInfo,h=e.extraOptions,O=e.user,m=e.sharingServiceInfo,D=e.refreshSharingServiceInfo,N=e.showOpenWithShare,F=e.onPresentInZoom,g=e.isCloudBasedDoc,E=e.actionSource,W=e.landingPagesEnabled;if(!a)return[];var x=[];t&&x.push({handler:S({file:n,user:O}),spriteName:"paper",text:c._("Copy to Paper"),type:l.OpenButtonAction.OPEN_IN_PAPER,userAction:o.UserAction.CopyToPaper}),!g&&A({isUnityDisabled:i,unityInfo:a})&&x.push({handler:U({file:n,user:O,isFolder:!1}),spriteName:"ow_desktop",text:w(a),type:l.OpenButtonAction.UNITY_FILE,userAction:o.UserAction.OpenInUnity});var P=v({file:n,isOpenWithDisabled:r,user:O}),B=u.OpenWithHelpers.getOpenWithHandlerData(n,O),H=_.isSingleFileEditingForWopiEnabled(O.id);P&&B&&!H&&x.push({handler:b({file:n,user:O}),spriteName:B.icon,text:B.name,type:l.OpenButtonAction.OPEN_WITH,userAction:o.UserAction.OpenInOfficeOnline});for(var C={gdd:!s,wopi:P},T=_.getOpenWithCloudEditorInfo(n,O,C,E),k=function(e){x.push({handler:function(){return e.handler(n,O,E)},spriteName:e.spriteName||null,iconUrl:e.iconUrl,text:e.text,type:e.type,userAction:e.userAction})},Z=0,L=T;Z<L.length;Z++){k(L[Z])}y({isUnityDisabled:i,unityInfo:a})&&x.push({handler:U({file:n,user:O,isFolder:!0}),spriteName:"ow_folder",text:I(a),type:l.OpenButtonAction.UNITY_FOLDER,userAction:o.UserAction.OpenInUnityFolder}),h&&h.forEach(function(e){e&&x.push(e)}),x.length||g||x.push({handler:function(){return p.download(n)},spriteName:null,text:c._("Download"),type:l.OpenButtonAction.DOWNLOAD,userAction:o.UserAction.Download});var R=!1,Y=!1;return N&&m&&(R=d.isSlackAvailable(m),Y=d.isZoomAvailable(m)),R&&m&&D&&x.push({handler:function(){return f.shareInSlackFlow(O,m,D,n,"open_with_button",void 0!==W?W:null)},spriteName:null,text:c._("Slack"),type:l.OpenButtonAction.SHARE_TO_SLACK,userAction:o.UserAction.ShareToSlack}),Y&&m&&F&&D&&x.push({handler:function(){return f.presentInZoomFlow(O,m,D,n,F,"open_with_button",void 0!==W?W:null)},spriteName:null,text:c._("Zoom"),type:l.OpenButtonAction.PRESENT_IN_ZOOM,userAction:o.UserAction.PresentInZoom}),x}function y(e){var n=e.isUnityDisabled,t=e.unityInfo;return null!=t&&!n&&s.UnityHelpers.isUnityFolderSupported(t)}function A(e){var n=e.isUnityDisabled,t=e.unityInfo;return null!=t&&!n&&s.UnityHelpers.isUnityFileSupported(t)}function v(e){var n=e.file,t=e.isOpenWithDisabled,i=e.user;return!t&&u.OpenWithHelpers.canOpenWith(n,i)}function w(e){var n=(e?e.open_application_name:void 0)||c._("Desktop");return c._("Open in %(app_name)s").format({app_name:n})}function I(e){var n=(null!==e?e.file_browser_display_name:void 0)||c._("File Browser");return c._("Show in %(file_browser)s").format({file_browser:n})}function U(e){var n=e.file,t=e.isFolder,i=e.user;return function(){s.UnityHelpers.openFile(n.ns_id,n.ns_path,i.id,t)}}function b(e){var n=e.file,t=e.user;return function(){u.OpenWithHelpers.openWith(n,t)}}function S(e){var n=e.file,t=e.user;return function(){a.openFileInPaper({file:n,user:t})}}function D(e,n){var t=e.map(function(e){return e.type}).includes(l.OpenButtonAction.UNITY_FILE),r=n&&i.default.is_adobe_app(n.open_application_identifier),o=e.map(function(e){return e.type}).includes(l.OpenButtonAction.OPEN_WITH);return t&&r||o}Object.defineProperty(n,"__esModule",{value:!0}),i=t.__importDefault(i),n.getOpenOptions=h,n.getOpenOptionsSharedFile=O,n.shouldShowCoachmark=D});
//# sourceMappingURL=utils.min.js-vflfXS6MQ.map