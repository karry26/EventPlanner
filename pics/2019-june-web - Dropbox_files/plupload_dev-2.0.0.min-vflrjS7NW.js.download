define(["external/moxie"],function(e){return(function(e,t,r){function i(e){function t(e,t,r){var n={chunks:"slice_blob",resize:"send_binary_string",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",max_file_size:"access_binary",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};n[e]?i[n[e]]=t:r||(i[e]=t)}var r=e.required_features,i={};return"string"==typeof r?a.each(r.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==typeof r?a.each(r,function(e,r){t(r,e)}):r===!0&&(e.multipart||(i.send_binary_string=!0),e.chunk_size>0&&(i.slice_blob=!0),a.each(e,function(e,r){t(r,!!e,!0)})),i}var n=e.setTimeout,s={},a={VERSION:"2.0.0beta",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,OVER_QUOTA_ERROR:-708,BLOCKS_MISSING_ERROR:-703,COMMIT_HTTP_ERROR:-704,UPLOAD_BLOCK_ERROR:-705,CHUNKS_NOT_ENABLED_ERROR:-706,SERVER_HASH_RESPONSE_ERROR:-707,BLOCK_RUNTIME_ID_MISSING:-709,CLIENT_HASH_EMPTY_ERROR:-710,SERVER_HASH_EMPTY_ERROR:-711,HASHES_NOT_EQUAL_ERROR:-712,BLOCK_INDEX_ERROR:-713,BLOCK_EMPTY_ERROR:-714,BLOB_EMPTY_ERROR:-715,CLIENT_HASH_DIGEST_ERROR:-716,FILE_READER_NULL_RESULT_ERROR:-717,COMMIT_READINESS_ERROR:-718,SERVER_RESPONSE_ERROR:-719,SERVER_TOKEN_EMPTY_ERROR:-720,BLOB_MISSING_ERROR:-721,SERVER_TOKENS_MISSING_ERROR:-722,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"};return e?(""+e).replace(/[<>&\"\']/g,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,r;for(r=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<r.length;t+=2)e=e.replace(r[t],r[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var r="";return a.each(t,function(e,t){r+=(r?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),r&&(e+=(e.indexOf("?")>0?"&":"?")+r),e},formatSize:function(e){return void 0===e||/\D/.test(e)?a.translate("N/A"):e>1099511627776?Math.round(e/1099511627776,1)+" "+a.translate("tb"):e>1073741824?Math.round(e/1073741824,1)+" "+a.translate("gb"):e>1048576?Math.round(e/1048576,1)+" "+a.translate("mb"):e>1024?Math.round(e/1024,1)+" "+a.translate("kb"):e+" "+a.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,t){var r,i;return t&&(e.runtimes=t),r=new a.Uploader(e),i=r.runtime,r.destroy(),i},addFileFilter:function(e,t){s[e]=t}};a.addFileFilter("mime_types",(function(){function e(e){var t=[];return a.each(e,function(e){a.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}var t,r;return function(i,n,s){r&&i==t||(r=e(i),t=[].slice.call(i)),r.test(n.name)?s(!0):(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:n}),s(!1))}})()),a.addFileFilter("max_file_size",function(e,t,r){void 0!==t.size&&e&&t.size>e?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:t}),r(!1)):r(!0)}),a.addFileFilter("prevent_duplicates",function(e,t,r){if(e)for(var i=this.files.length;i--;)if(t.name===this.files[i].name&&t.size===this.files[i].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:t}),void r(!1);r(!0)}),a.Uploader=function(r){function o(){var e,t,i=0;if(r.waterfall_parallel_uploads)for(t=0;t<h.length;t++)if(h[t].status==a.UPLOADING)return;if(this.state==a.STARTED){for(t=0;t<h.length;t++)e||h[t].status!=a.QUEUED?i++:(e=h[t],this.trigger("BeforeUpload",e)&&(e.status=a.UPLOADING,this.trigger("UploadFile",e)));i==h.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",h))}}function l(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,u()}function u(){var e,t;for(p.reset(),e=0;e<h.length;e++)t=h[e],void 0!==t.size?(p.size+=t.origSize,p.loaded+=t.loaded*t.origSize/t.size):p.size=void 0,t.status==a.DONE?p.uploaded++:t.status==a.FAILED?p.failed++:p.queued++;void 0===p.size?p.percent=h.length>0?Math.ceil(p.uploaded/h.length*100):0:(p.bytesPerSec=Math.ceil(p.loaded/((+new Date-g||1)/1e3)),p.percent=p.size>0?Math.ceil(p.loaded/p.size*100):0)}function d(){var e=this,i=0,n={accept:r.filters.mime_types,runtime_order:r.runtimes,required_caps:S,swf_url:r.flash_swf_url,xap_url:r.silverlight_xap_url};a.each(r.runtimes.split(/\s*,\s*/),function(e){r[e]&&(n[e]=r[e])}),t.inSeries([function(s){r.browse_button?(R=new t.FileInput(a.extend({},n,{name:r.file_data_name,multiple:r.multi_selection,container:r.container,browse_button:r.browse_button})),R.onready=function(){var r=t.Runtime.getInfo(this.ruid);t.extend(e.features,{chunks:r.can("slice_blob"),multipart:r.can("send_multipart"),multi_selection:r.can("select_multiple")}),i++,s()},R.onchange=function(){e.trigger("BeforeFilesAdded",this.files)&&e.addFile(this.files)},R.bind("mouseenter mouseleave mousedown mouseup",function(e){if(!y){var i=t.get(r.browse_button);i&&(r.browse_button_hover&&("mouseenter"===e.type?t.addClass(i,r.browse_button_hover):"mouseleave"===e.type&&t.removeClass(i,r.browse_button_hover)),r.browse_button_active&&("mousedown"===e.type?t.addClass(i,r.browse_button_active):"mouseup"===e.type&&t.removeClass(i,r.browse_button_active)),i=null)}}),R.bind("mousedown",function(){e.trigger("Browse")}),R.bind("error runtimeerror",function(){R=null,s()}),R.init()):s()},function(s){r.drop_element?(m=new t.FileDrop(a.extend({},n,{drop_zone:r.drop_element})),m.onready=function(){var r=t.Runtime.getInfo(this.ruid);e.features.dragdrop=r.can("drag_and_drop"),i++,s()},m.ondrop=function(){e.trigger("DragAndDrop"),e.addFile(this.files)},m.bind("error runtimeerror",function(){m=null,s()}),m.init()):s()}],function(){"function"==typeof r.init?r.init(e):a.each(r.init,function(t,r){e.bind(r,t)}),i?e.trigger("PostInit"):e.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})})}function c(e,r){if(e.ruid){var i=t.Runtime.getInfo(e.ruid);if(i)return i.can(r)}return!1}function f(e,r,i){var n=new t.Image;try{n.onload=function(){n.downsize(r.width,r.height,r.crop,r.preserve_headers)},n.onresize=function(){i(this.getAsBlob(e.type,r.quality)),this.destroy()},n.onerror=function(){i(e)},n.load(e)}catch(t){i(e)}}var _,g,p,R,m,E,h=[],v={},b=!1,O={},S={},y=!1;p=new a.QueueProgress,r=a.extend({runtimes:t.Runtime.order,max_retries:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",send_chunk_number:!0},r),r.resize&&(r.resize=a.extend({preserve_headers:!0,crop:!1},r.resize)),"array"===a.typeOf(r.filters)&&(r.filters={mime_types:r.filters}),r.filters=a.extend({mime_types:[],prevent_duplicates:!!r.prevent_duplicates,max_file_size:r.max_file_size},r.filters),r.filters.max_file_size=a.parseSize(r.filters.max_file_size)||0,r.chunk_size=a.parseSize(r.chunk_size)||0,r.required_features=S=i(a.extend({},r)),a.extend(this,{id:a.guid(),state:a.STOPPED,features:{},runtime:t.Runtime.thatCan(S,r.runtimes),files:h,settings:r,total:p,init:function(){function i(e){Object.keys(e).forEach(function(t){e[t].abort()})}function s(){i(v),v={}}var p=this;if(r.browse_button=t.get(r.browse_button),r.drop_element=t.get(r.drop_element),"function"==typeof r.preinit?r.preinit(p):a.each(r.preinit,function(e,t){p.bind(t,e)}),!r.browse_button||!r.url)return void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")});p.bind("FilesAdded",function(e,t){[].push.apply(h,t),n(function(){p.trigger("QueueChanged"),p.refresh()},1)}),p.bind("CancelUpload",function(){r.waterfall_parallel_uploads?(_&&_.abort(),b=!0,s()):E&&E.abort()}),r.unique_names&&p.bind("BeforeUpload",function(e,t){var r=t.name.match(/\.([^.]+)$/),i="part";r&&(i=r[1]),t.target_name=t.id+"."+i}),p.bind("UploadFile",function(o,l){function u(){507!==E.status&&O-- >0?n(d,1):(l.loaded=y,o.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:l,response:E.responseText,status:E.status,responseHeaders:E.getAllResponseHeaders()}))}function d(){var e,i,s,c;l.status!=a.DONE&&l.status!=a.FAILED&&o.state!=a.STOPPED&&(s={name:l.target_name||l.name},h&&m.chunks&&p.size>h?(c=Math.min(h,p.size-y),e=p.slice(y,y+c)):(c=p.size,e=p),h&&m.chunks?r.send_chunk_number?(s.chunk=Math.ceil(y/h),s.chunks=Math.ceil(p.size/h)):(s.offset=y,s.total=p.size):(s.chunk=0,s.chunks=1),E=new t.XMLHttpRequest,E.withCredentials=!0,E.upload&&(E.upload.onprogress=function(e){l.loaded=Math.min(l.size,y+e.loaded),o.trigger("UploadProgress",l,!0)}),E.onload=function(){if(E.status>=400)return void u();c<p.size?(e.destroy(),y+=c,l.loaded=Math.min(y,p.size),o.trigger("ChunkUploaded",l,{offset:l.loaded,total:p.size,response:E.responseText,status:E.status,responseHeaders:E.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&o.trigger("UploadProgress",l,!0)):l.loaded=l.size,e=i=null,!y||y>=p.size?(l.size!=l.origSize&&(p.destroy(),p=null),o.trigger("UploadProgress",l,!0),l.status=a.DONE,o.trigger("FileUploaded",l,{response:E.responseText,status:E.status,responseHeaders:E.getAllResponseHeaders()})):(O=r.max_retries,n(d,1))},E.onerror=function(){u()},E.onloadend=function(){this.destroy(),E=null},o.settings.multipart&&m.multipart?(s.name=l.target_name||l.name,E.open("post",R,!0),a.each(o.settings.headers,function(e,t){E.setRequestHeader(t,e)}),i=new t.FormData,a.each(a.extend(s,o.settings.multipart_params),function(e,t){i.append(t,e)}),i.append(o.settings.file_data_name,e),E.send(i,{runtime_order:o.settings.runtimes,required_caps:S,swf_url:o.settings.flash_swf_url,xap_url:o.settings.silverlight_xap_url})):(R=a.buildUrl(o.settings.url,a.extend(s,o.settings.multipart_params)),E.open("post",R,!0),E.setRequestHeader("Content-Type","application/octet-stream"),a.each(o.settings.headers,function(e,t){E.setRequestHeader(t,e)}),E.send(e,{runtime_order:o.settings.runtimes,required_caps:S,swf_url:o.settings.flash_swf_url,xap_url:o.settings.silverlight_xap_url})))}function g(){function r(e){var t;if(w<=h)t=p;else{var r=e*h,i=Math.min(h,w-r);t=p.slice(r,r+i)}return t&&0!==t.size?t:(s(),void o.trigger("Error",{code:a.BLOCK_EMPTY_ERROR,message:a.translate("Block is empty."),file:l,blockIndex:e}))}function u(){return P===C&&x.length===C&&!x.includes(void 0)}function d(e){for(;e.endsWith("=");)e=e.slice(0,-1);return e}function c(e){return e.replace(/\//g,"_").replace(/\+/g,"-")}function f(e){function t(i){var n=r(i);if(!n.ruid)return s(),void o.trigger("Error",{code:a.BLOCK_RUNTIME_ID_MISSING_ERROR,message:a.translate("Block ruid missing."),file:l});n.connectRuntime(n.ruid);var u=new FileReader;_=u,u.onloadend=function(r){if(!r.target.result&&!b)return s(),void o.trigger("Error",{code:a.FILE_READER_NULL_RESULT_ERROR,message:a.translate("File reader null result."),file:l,blockIndex:i,domException:u.error});var f=crypto.subtle.digest("SHA-256",r.target.result);n.disconnectRuntime(),f.then(function(r){var n=btoa(String.fromCharCode.apply(null,new Uint8Array(r))),u=c(n);if(u=d(u),!u&&!b)return s(),void o.trigger("Error",{code:a.CLIENT_HASH_EMPTY_ERROR,message:a.translate("Client hash empty or undefined error."),file:l});L[i]=u,i++,l.loaded+=1e4,o.trigger("UploadProgress",l,!1),i>=C?(l.loaded=0,e()):t(i)}).catch(function(e){if(!b)return s(),void o.trigger("Error",{code:a.CLIENT_HASH_DIGEST_ERROR,message:a.translate(e),file:l,blockIndex:i})})};var f=n.getSource();u.readAsArrayBuffer(f)}t(0)}function g(){for(var e=0;e<6&&e<C;e++)A=e,O(e)}function E(e,t){if(!(507!==t.status&&N[e]<o.settings.max_retries))return l.loaded=0,s(),void o.trigger("Error",{code:a.UPLOAD_BLOCK_ERROR,message:a.translate("Upload block HTTP error."),file:l,response:t.responseText,status:t.status,responseHeaders:t.getAllResponseHeaders()});n(function(){O(e)},2e3),N[e]++}function O(e){var i=r(e),n=new t.XMLHttpRequest;n.withCredentials=!0;var d={};o.settings.multipart_params.file_request?d.owner_id=o.settings.multipart_params.owner_id:(d.owner_id=o.settings.multipart_params._subject_uid,d._subject_uid=o.settings.multipart_params._subject_uid),d.t=o.settings.multipart_params.t,d.reported_block_size=i.size,d.num_blocks=C,d.ns_id_for_routing=o.settings.multipart_params.ns_id_for_routing;var c=0;n.upload?n.upload.onprogress=function(e){e.loaded&&(l.loaded+=e.loaded-c,c=e.loaded,o.trigger("UploadProgress",l,!0))}:n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&200===n.status&&(l.loaded+=i.size,o.trigger("UploadProgress",l,!0))},n.onload=function(){if(n.status>=400)return void E(e,n);var t,r,i;try{t=JSON.parse(n.response),r=t.block_hash,i=t.token}catch(t){return s(),void o.trigger("Error",{code:a.SERVER_RESPONSE_ERROR,message:a.translate("Server response error."),file:l,blockIndex:e})}if(!r)return s(),void o.trigger("Error",{code:a.SERVER_HASH_EMPTY_ERROR,message:a.translate("Server hash empty or undefined error."),file:l,blockIndex:e});if(!i)return s(),void o.trigger("Error",{code:a.SERVER_TOKEN_EMPTY_ERROR,message:a.translate("Server token empty or undefined error."),file:l,blockIndex:e});if(D){if(r!==L[e])return s(),void o.trigger("Error",{code:a.HASHES_NOT_EQUAL_ERROR,message:a.translate("Client and server hashes not equal error."),file:l,blockIndex:e});x[e]=i,P++,delete v[e]}else x[e]=i,P++,delete v[e];if(A<U)A++,O(A);else{if(A>U)return s(),void o.trigger("Error",{code:a.BLOCK_INDEX_ERROR,message:a.translate("Block index error."),file:l,blockIndex:e});if(u())z(x);else if(A===U&&!Object.keys(v).length&&!u())return s(),void o.trigger("Error",{code:a.COMMIT_READINESS_ERROR,message:a.translate("Done iterating over blocks, but no requests in progress or outstanding and not ready to commit."),file:l})}},n.onerror=function(){E(e,n)},n.onloadend=function(){delete v[e],this.destroy(),n=null},R=a.buildUrl(o.settings.waterfall_upload_block_url,d),n.open("post",R,!0),n.setRequestHeader("Content-Type","application/octet-stream"),a.each(o.settings.headers,function(e,t){n.setRequestHeader(t,e)}),v[e]=n,n.send(i),N[e]++}function S(e,t){y(t,e.responseText,e.status,e.getAllResponseHeaders())}function y(e,t,r,s){if(!(507!==r&&M<o.settings.max_retries))return l.loaded=0,i(v),v={},void o.trigger("Error",{code:a.COMMIT_HTTP_ERROR,message:a.translate("Commit HTTP error."),file:l,response:t,status:r,responseHeaders:s});n(function(){z(e)},8e3),M++}function I(e){T(e.responseText,e.status,e.getAllResponseHeaders())}function T(e,t,r){l.size!=l.origSize&&(p.destroy(),p=null),o.trigger("UploadProgress",l,!0),l.status=a.DONE,o.trigger("FileUploaded",l,{response:e,status:t,responseHeaders:r}),v={}}function z(e){if("function"==typeof o.settings.send_commit_request)return o.settings.send_commit_request(o,l,e).then(function(e){T()}).catch(function(t){t.raw?y(e,t.raw.responseBody,t.raw.status):y(e)}),void M++;var r=new t.XMLHttpRequest;r.withCredentials=!0;var i={};if(o.settings.multipart_params.file_request?(i.ut=o.settings.multipart_params.ut,i.token=o.settings.multipart_params.token,i.submitted_email=o.settings.multipart_params.submitted_email,i.submitted_user_name=o.settings.multipart_params.submitted_user_name,i.user_id=o.settings.multipart_params.owner_id):(i._subject_uid=o.settings.multipart_params._subject_uid,i.dest=o.settings.multipart_params.dest,i.overwrite=o.settings.multipart_params.overwrite),i.reported_total_size=o.settings.multipart_params.reported_total_size,i.name=l.target_name||l.name,i.t=o.settings.multipart_params.t,r.onload=function(){if(r.status>=400)return void S(r,e);r.readyState===XMLHttpRequest.DONE&&200===r.status&&I(r)},r.onerror=function(){S(r,e)},r.onloadend=function(){v={},this.destroy(),r=null},R=a.buildUrl(o.settings.waterfall_commit_upload_url,i),r.open("post",R,!0),r.setRequestHeader("Content-Type","application/octet-stream"),a.each(o.settings.headers,function(e,t){r.setRequestHeader(t,e)}),v.commitRequest=r,1!==Object.keys(v).length||!v.hasOwnProperty("commitRequest"))return s(),void o.trigger("Error",{code:a.COMMIT_READINESS_ERROR,message:a.translate("In commitFile call, but more than 1 request in progress or requestsInProgress map lacks the commit request."),file:l});r.send(JSON.stringify(e)),M++}if(!p)return void o.trigger("Error",{code:a.BLOB_MISSING_ERROR,message:a.translate("Blob is missing."),file:l});var w=p.size;if(!p.size)return void o.trigger("Error",{code:a.BLOB_EMPTY_ERROR,message:a.translate("Blob size is 0 bytes."),file:l});if(l.status!=a.DONE&&l.status!=a.FAILED&&o.state!=a.STOPPED){if(!m.chunks)return void o.trigger("Error",{code:a.CHUNKS_NOT_ENABLED_ERROR,message:a.translate("Chunks not enabled error."),file:l});for(var A,D=!!(e.crypto&&e.crypto.subtle&&e.crypto.subtle.digest),C=Math.ceil(w/h),P=0,N=[],M=0,L=[],x=[],U=C-1,H=0;H<C;H++)x.push(void 0),L.push(void 0),N.push(0);D?f(function(){g()}):g()}}var p,R=o.settings.url,m=o.features,h=r.chunk_size,O=r.max_retries,y=0;l.loaded&&(y=l.loaded=h*Math.floor(l.loaded/h)),p=l.getSource(),!t.isEmptyObj(o.settings.resize)&&c(p,"send_binary_string")&&~t.inArray(p.type,["image/jpeg","image/png"])?f.call(this,p,o.settings.resize,function(e){p=e,l.size=e.size,r.waterfall_parallel_uploads?g():d()}):r.waterfall_parallel_uploads?g():d()}),p.bind("UploadProgress",function(e,t,r){l(t)}),p.bind("StateChanged",function(e){if(e.state==a.STARTED)g=+new Date;else if(e.state==a.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==a.UPLOADING&&(e.files[t].status=a.QUEUED,u())}),p.bind("QueueChanged",u),p.bind("Error",function(e,t){t.file&&(t.file.status=a.FAILED,l(t.file),e.state==a.STARTED&&n(function(){o.call(p)},1))}),p.bind("FileUploaded",function(){u(),n(function(){o.call(p)},1)}),p.trigger("Init",{runtime:this.runtime}),d.call(this)},refresh:function(){R&&R.trigger("Refresh"),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),o.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){y=void 0===arguments[0]||arguments[0],R&&R.disable(y),this.trigger("DisableBrowse",y)},getFile:function(e){var t;for(t=h.length-1;t>=0;t--)if(h[t].id===e)return h[t]},addFile:function(e,r){function i(){var e=m||R;return!!e&&e.getRuntime().uid}function o(e,r){var i=[];t.each(d.settings.filters,function(t,r){s[r]&&i.push(function(i){s[r].call(d,t,e,function(e){i(!e)})})}),t.inSeries(i,r)}function l(e){var i=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!u)return!1;e.ruid=u,e.connectRuntime(u)}const s=new a.File(e);s.batchId=e.batchId,l(s)}else if(e instanceof t.Blob)l(e.getSource()),e.destroy();else if(e instanceof a.File)r&&(e.dest=r),c.push(function(t){o(e,function(r){r||f.push(e),n(t,1)})});else if(t.inArray(i,["file","blob"])!==-1){const d=new t.File(null,e);d.batchId=e.batchId,l(d)}else"node"===i&&"filelist"===t.typeOf(e.files)?t.each(e.files,l):"array"===i&&t.each(e,l)}var u,d=this,c=[],f=[];u=i(),l(e),c.length&&t.inSeries(c,function(){f.length&&d.trigger("FilesAdded",f)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,r=h.length-1;r>=0;r--)if(h[r].id===t)return this.splice(r,1)[0]},renameFile:function(e,t){for(var r="string"==typeof e?e:e.id,i=h.length-1;i>=0;i--)if(h[i].id===r)return void(h[i].name=t)},splice:function(e,t){var r=h.splice(void 0===e?0:e,void 0===t?h.length:t);return this.trigger("FilesRemoved",r),this.trigger("QueueChanged"),a.each(r,function(e){e.destroy()}),r},trigger:function(e){var t,r,i=O[e.toLowerCase()];if(i)for(r=Array.prototype.slice.call(arguments),r[0]=this,t=0;t<i.length;t++)if(i[t].func.apply(i[t].scope,r)===!1)return!1;return!0},hasEventListener:function(e){return!!O[e.toLowerCase()]},bind:function(e,t,r){var i;e=e.toLowerCase(),i=O[e]||[],i.push({func:t,scope:r||this}),O[e]=i},unbind:function(e){e=e.toLowerCase();var t,r=O[e],i=arguments[1];if(r){if(void 0!==i){for(t=r.length-1;t>=0;t--)if(r[t].func===i){r.splice(t,1);break}}else r=[];r.length||delete O[e]}},unbindAll:function(){var e=this;a.each(O,function(t,r){e.unbind(r)})},destroy:function(){this.stop(),a.each(h,function(e){e.destroy()}),h=[],R&&(R.destroy(),R=null),m&&(m.destroy(),m=null),S={},g=p=y=E=null,this.trigger("Destroy"),this.unbindAll(),O={}}})},a.File=(function(){function e(e){a.extend(this,{id:a.guid(),name:e.name||e.fileName,dest:"",type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return t.inArray(t.typeOf(e),["blob","file"])!==-1?e:null},getSource:function(){return r[this.id]?r[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete r[this.id])}}),r[this.id]=e}var r={};return e})(),a.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=a})(window,e),window.plupload}.bind(Object.create(null)));
//# sourceMappingURL=plupload_dev-2.0.0.min.js-vflCQP-4L.map