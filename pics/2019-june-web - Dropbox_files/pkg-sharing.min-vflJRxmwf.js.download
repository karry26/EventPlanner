define("modules/clean/clipboard_v2",["require","exports","tslib","external/flash_detect","jquery","modules/clean/clipboard","modules/core/browser_detection"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importStar(s),a=n.__importStar(a);var o=(function(){function e(e,t,n,r){this.do_copy=this.do_copy.bind(this),this.copyText=e,this.onSuccess=t,this.onError=n,this.clickHandler=r}return e.prototype.setupCopy=function(t,n){var r=this,a=i.default(n),o=i.default(t);if(!e.is_flashless_clipboard_supported()){var l=function(){return"function"==typeof r.onSuccess&&r.onSuccess(),"function"==typeof r.clickHandler?r.clickHandler():void 0};return s.clipboard_overlay(this.copyText,o,l,a)}},e.prototype.do_copy=function(){if(e.is_supported()&&e.is_flashless_clipboard_supported()){return document.execCommand("copy",!1)?"function"==typeof this.onSuccess?this.onSuccess():void 0:"function"==typeof this.onError?this.onError():void 0}},e.is_supported=function(){return e.is_flashless_clipboard_supported()||r.default.installed},e.is_flashless_clipboard_supported=function(){var e=parseInt(a.version,10);return a.chrome?e>=42:a.mozilla?e>=41:a.opera?e>=29:a.msie?e>=9:!!a.edge||!!a.safari&&e>=10},e})();t.ClipboardV2=o}),define("modules/clean/previews/data/store",["require","exports","modules/clean/react/file_viewer/data/store","modules/clean/previews/data/actions"],function(e,t,n,r){"use strict";function i(e,t,r){n.hydrateFileStore(e,t),s(e,t,r)}function s(e,t,n){e.dispatch(r.fetchPreviewData(t,n))}function a(e,t,n,i){e.dispatch(r.fetchPreviewData(t,n,i))}Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateFileStoreAndPreviewStore=i,t.hydratePreviewStore=s,t.fetchPreviewDataUpdateStore=a}),define("modules/clean/react/file_viewer/collection_viewer",["require","exports","tslib","external/lodash","react","external/react-redux","modules/clean/file_store/utils","modules/clean/react/file_viewer/utils","modules/clean/react/file_viewer/file_viewer","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/store","modules/clean/react/file_viewer/data/selectors","modules/clean/react/keyboard_binding/keyboard_binding_provider","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/clean/keycode","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/integrations/zoom_share_dialog/async_modal","modules/core/uri","modules/clean/history"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b){"use strict";function I(e,t,n,r,i){var s=t.filter(function(e){return!e.is_dir});return s.indexOf(e)===-1?{files:[e]}:{files:s,sharedLinkInfos:n,sharePermissions:r,shareTokens:i}}function y(e,t){var n=e.file,r=e.files,i=e.sharedLinkInfos,s=e.sharePermissions,a=e.shareTokens;return n!==t.file||r!==t.files||i!==t.sharedLinkInfos||s!==t.sharePermissions||a!==t.shareTokens}function C(e){var t=e.file,n=e.files,r=e.sharedLinkInfos,i=e.sharePermissions,s=e.shareTokens,a=I(t,n,r,i,s);return{collection:a,currentIndex:a.files.indexOf(t)}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importDefault(i),b=n.__importDefault(b);var M=u.getStoreForFileViewer(),T=(function(e){function t(t){var n=e.call(this,t)||this;return n.updateFileViewer=function(){var e=n.props,t=e.files,r=e.file,i=t.indexOf(r);i=i===-1?0:i,n.openFile(r)},n.handleFlipNext=r.throttle(function(){var e=n.props.isFlippingEnabled,t=n.state,r=t.collection,i=t.currentIndex;if(e){n.props.onFlipNext&&n.props.onFlipNext();var s=i+1===r.files.length?0:i+1;n.switchFile(s)}},100),n.handleFlipPrevious=r.throttle(function(){var e=n.props.isFlippingEnabled,t=n.state,r=t.collection,i=t.currentIndex;if(e){n.props.onFlipPrevious&&n.props.onFlipPrevious();var s=0===i?r.files.length-1:i-1;n.switchFile(s)}},100),n.switchFile=function(e){var t=n.state.collection;n.setState({currentIndex:e});var r=t.files[e];n.updatePreviewUrl(r),n.openFile(r)},n.flipKeybindings=[f.hydrateKeyboardBinding({keyboardEventCriteria:{which:_.KeyCode.RIGHT},callback:function(){n.handleFlipNext(),g.logUserAction(S.UserAction.FlipNext,S.UserActionContext.Keyboard)}}),f.hydrateKeyboardBinding({keyboardEventCriteria:{which:_.KeyCode.LEFT},callback:function(){n.handleFlipPrevious(),g.logUserAction(S.UserAction.FlipPrevious,S.UserActionContext.Keyboard)}})],n.state=C(t),n}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.updateFileViewer()},t.prototype.componentDidMount=function(){var e=this.state,t=e.collection,n=e.currentIndex,r=this.props,i=r.previewApiDataMap,s=r.shouldPresentInZoom,l=r.user,c=r.file,d=t.files.map(function(e){var t=a.getFileRevisionId(e);return i[t]&&i[t].data});o.preloadImages(d,n),this.setupPreviewUrl(c),l&&s&&E.asyncShowModal(l.id,c.file_id,"file-viewer-modal-overlay")},t.prototype.componentWillReceiveProps=function(e){y(this.props,e)&&this.setState(C(e))},t.prototype.componentWillUnmount=function(){(0,this.props.closeFile)(),this.teardownPreviewUrl()},t.prototype.openFile=function(e){this.props.openFile(e)},t.prototype.setupPreviewUrl=function(e){this.props.skipOuterRouting||this.setPreviewUrl(e)},t.prototype.updatePreviewUrl=function(e){this.setPreviewUrl(e,!1)},t.prototype.teardownPreviewUrl=function(){this.props.skipOuterRouting||this.setPreviewUrl(null)},t.prototype.setPreviewUrl=function(e,t){if(void 0===t&&(t=!0),!this.props.disableRouting){var n=v.URI.parse(b.default.get_url()),r=v.URI.encode_parts(n.getPath()),i=n.removeQuery("select").removeQuery("page");if(null==e)i=i.removeQuery("preview");else{var s=a.getFilename(e);i=i.updateQuery({preview:s})}var o=i.getQuery();t?b.default.push_state(r,o,{immediatelyRestoreState:!1}):b.default.replace_state(r,o)}},t.prototype.render=function(){var e=this.props,t=(e.files,e.onFlipNext,e.onFlipPrevious,e.sharedLinkInfos,e.shareTokens,e.sharePermissions,e.skipOuterRouting,n.__rest(e,["files","onFlipNext","onFlipPrevious","sharedLinkInfos","shareTokens","sharePermissions","skipOuterRouting"])),s=this.state,a=s.currentIndex,o=s.collection;return i.default.createElement(h.KeyboardBindingProvider,null,i.default.createElement("div",null,i.default.createElement(m.KeyboardBindingConnector,{keyboardBindings:this.flipKeybindings}),i.default.createElement(l.FileViewer,n.__assign({},t,{fileIndex:a,fileCount:o.files.length,onFlipNext:this.handleFlipNext,onFlipPrevious:this.handleFlipPrevious,sharedLinkInfo:r.get(o.sharedLinkInfos,a),shareToken:r.get(o.shareTokens,a),sharePermission:r.get(o.sharePermissions,a)}))))},t.defaultProps={isFlippingEnabled:!0},t})(i.default.Component);t._FileCollectionViewer=T;var N=s.connect(function(e,t){return{isFlippingEnabled:p.getIsFlippingEnabled(e),previewApiDataMap:c.getApiDataForFiles(e,t.files)}},{closeFile:d.closeFile,openFile:d.openFile})(T),k=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return i.default.createElement(s.Provider,{store:M},i.default.createElement(N,n.__assign({},this.props)))},t})(i.default.Component);t.FileCollectionViewer=k}),define("modules/clean/react/file_viewer/controller",["require","exports","tslib","react","external/react-dom","external/lodash","modules/clean/loggers/file_viewer_logger","modules/clean/react/file_viewer/data/store","modules/clean/previews/data/store","modules/clean/react/file_viewer/utils","modules/core/browser_detection","modules/clean/react/file_viewer/collection_viewer","modules/clean/file_store/utils","modules/clean/react/file_viewer/url_utils","modules/clean/react/previews/constants","modules/clean/react/extensions/data/store"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_){"use strict";function f(e,t,n){var r=o.getStoreForFileViewer();l.hydrateFileStoreAndPreviewStore(r,e,t),_.initializeStore(t,e)}function g(e){var t=o.getStoreForFileViewer();o.updateFileStore(t,e)}function S(e,t){var n=o.getStoreForFileViewer();l.fetchPreviewDataUpdateStore(n,e,t)}function E(e,t){S(e,t)}function v(e,t,r,i,s){k=i,a.start();var o=T(s);f(e,r,t),C(n.__assign({},o,{titleBarCloseUrl:h.getCurrentFolderHref(),files:e,file:e[t],disableFlipping:!!s.disableFlipping,sharedLinkInfos:s.sharedLinkInfos,shareTokens:s.shareTokens,sharePermissions:s.sharePermissions,user:r,shouldPresentInZoom:s.shouldPresentInZoom}))}function b(e){if(N){g(e);var t=N.props;S(e,t.user);var r=p.getFileRevisionId(t.file),i=s.find(e,function(e){return p.getFileRevisionId(e)===r})||t.file;C(n.__assign({},t,{file:i,files:e}))}}function I(){M()}function y(){return null!=N}function C(e){var t=document.getElementById(k);N=i.default.render(r.default.createElement(u.FileCollectionViewer,n.__assign({},e)),t)}function M(){var e=document.getElementById(k);i.default.unmountComponentAtNode(e),N=null}function T(e){var t=(e.disableFlipping,e.initialPreviewSourceAction),r=e.initialPreviewSourceContext,i=(e.sharedLinkInfos,e.sharePermissions,e.shareTokens,n.__rest(e,["disableFlipping","initialPreviewSourceAction","initialPreviewSourceContext","sharedLinkInfos","sharePermissions","shareTokens"]));i.canClose=!0,null==r&&(r=c.getSourceContext()||m.PreviewSourceContext.Browse),null==t&&(t=c.getSourceAction());var s=d.is_supported_mobile_browser();i.isMobileUserAgent=s,s&&(i.hideComments=!0);var a=i.onCloseViewer;return i.onCloseViewer=function(){return I(),"function"==typeof a?a():void 0},n.__assign({initialPreviewSourceAction:t,initialPreviewSourceContext:r},i)}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importStar(s),a=n.__importStar(a);var N=null,k="";t.prewarmPreviewData=E,t.open=v,t.updateFiles=b,t.close=I,t.isShown=y,t.render=C}),define("modules/clean/react/pass/action_timestamps",["require","exports","tslib","modules/clean/react/pass/constants","modules/core/exception"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var s=[r.LoggingActions.PRESENCE_RECEIVE,r.LoggingActions.TRANSMITTER_TOKEN_BEGIN,r.LoggingActions.TRANSMITTER_TOKEN_RECEIVE,r.LoggingActions.RECEIVER_TOKEN_BEGIN,r.LoggingActions.RECEIVER_TOKEN_RECEIVE,r.LoggingActions.SEEN_STATE_USERS_BEGIN,r.LoggingActions.SEEN_STATE_USERS_RECEIVE],a=(function(){function e(){this.allTimestamps={}}return e.prototype.record=function(e,t){if(t){var n=(new Date).getTime()/1e3;this.allTimestamps[t]=this.allTimestamps[t]||{};var r=this.allTimestamps[t];r.hasOwnProperty(e)?this.reportStackForRepeatedAction(r,e,t,n):r[e]=n}},e.prototype.get=function(e){return e?this.allTimestamps[e]||{}:{}},e.prototype.reportStackForRepeatedAction=function(e,t,n,r){if(!(s.indexOf(t)>=0)){var a=e[t];i.reportStack("Attempted to record action for which there existed a previous record",{severity:i.SEVERITY.NONCRITICAL,tags:["pass:actionTimestampsTracker"],exc_extra:{preview_session_id:n,action:t,oldTimestamp:a,newTimestamp:r}})}},e})();t.ActionTimestampsTracker=new a}),define("modules/clean/react/pass/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/pass/constants"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}return e.passPermissionRequest=function(e){n.Dispatcher.dispatch({type:r.ActionTypes.PASS_PERMISSION_REQUEST,data:{fileId:e}})},e.updatePermissions=function(e,t){n.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_PERMISSIONS,data:{fileId:e,partialPermission:t}})},e.fetchPassError=function(e){n.Dispatcher.dispatch({type:r.ActionTypes.FETCH_PASS_ERROR,data:{fileId:e}})},e.fetchPassConcluded=function(e){n.Dispatcher.dispatch({type:r.ActionTypes.FETCH_PASS_CONCLUDED,data:{fileId:e}})},e.receivePresenceDelta=function(e,t,i,s){n.Dispatcher.dispatch({type:r.ActionTypes.RECEIVE_PRESENCE_DELTA,data:{userId:e,fileId:t,onlineUniqueUsers:i,offlineUniqueUsers:s}})},e.receivePresenceSnapshot=function(e,t,i){n.Dispatcher.dispatch({type:r.ActionTypes.RECEIVE_PRESENCE_SNAPSHOT,data:{userId:e,fileId:t,onlineUniqueUsers:i}})},e.resetPassInfo=function(e){n.Dispatcher.dispatch({type:r.ActionTypes.RESET_PASS_INFO,data:{fileId:e}})},e.updateSeenStateInfo=function(e,t,i){n.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_SEEN_STATE_INFO,data:{fileId:e,seenStateInfo:t,seenStateCursor:i}})},e.updateSeenStateInfoContinue=function(e,t,i){n.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_SEEN_STATE_INFO_CONTINUE,data:{fileId:e,seenStateInfo:t,seenStateCursor:i}})},e.discontinueSeenStateInfo=function(e){n.Dispatcher.dispatch({type:r.ActionTypes.DISCONTINUE_SEEN_STATE_INFO,data:{fileId:e}})},e.updateSeenStateUnavailable=function(e,t){n.Dispatcher.dispatch({type:r.ActionTypes.UPDATE_SEEN_STATE_UNAVAILABLE,data:{userId:e,fileId:t}})},e})();t.PassActions=i}),define("modules/clean/react/pass/data_helpers",["require","exports","tslib","jquery","external/lodash","modules/clean/ajax","modules/clean/api_v2/transport/jquery","modules/clean/api_v2/user_client","modules/clean/api_v2/noauth_client","modules/clean/api_v2/error","modules/clean/api_v2/types","modules/clean/beacon","modules/clean/react/file_viewer/utils","modules/clean/react/previews/constants","modules/clean/react/file_viewer/models","modules/clean/react/pass/action_timestamps","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/sharing/actions/sharing_actions","modules/clean/uuid","modules/clean/viewer","modules/constants/file_viewer","modules/constants/python"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I){"use strict";function y(e){f.PassActions.resetPassInfo(e),f.PassActions.fetchPassError(e)}function C(e,t,n,r,i){return e?t(new o.UserApiV2Client(i).ns("seen_state"),r,{subjectUserId:e.id}):n(new l.NoAuthApiV2Client(i).ns("seen_state"),r,{})}function M(e,t){return{file_identifier:e,shared_link_details:t?{url:t}:void 0}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),s=n.__importStar(s),u=n.__importStar(u),b=n.__importStar(b);var T=g.MAX_FACES_NORMAL+g.MAX_OVERFLOW_BUTTON_INDICATOR+1,N=(function(){function e(){}return e.setup=function(t){var n=t.user,r=t.fileData,i=t.prevFileData,s=t.shouldWritePresence,a=void 0===s||s,o=t.skipSharingEndpoints,l=void 0!==o&&o,c=t.limit,d=void 0===c?150:c,u=r.file.file_id;this.shouldInitializePass(n,u,a)&&setTimeout(function(){f.PassActions.passPermissionRequest(u),e.makeAllRequests({user:n,fileData:r,prevFileData:i,shouldWritePresence:a,skipSharingEndpoints:l,limit:d})},0)},e.teardown=function(e){var t=e.user,n=e.fileData,i=e.async,s=e.shouldWritePresence,a=void 0===s||s,o=n.file,l=n.url,c=o.file_id;if(this.shouldInitializePass(t,c,a)){r.default(window).off("beforeunload.passpresence");var d=new k(o,l);A.shutdown({beaconFileData:d,user:t,async:i,shouldWritePresence:a})}},e.shouldInitializePass=function(e,t,n){return p.getSourceContext()!==h.PreviewSourceContext.SharedLinkCollection&&(null!==e||n)&&t},e.makeAllRequests=function(e){var t=this,n=e.user,i=e.fileData,s=e.prevFileData,a=e.limit,o=void 0===a?150:a,l=e.shouldWritePresence,c=void 0===l||l,d=e.skipSharingEndpoints,u=void 0!==d&&d,p=m.FilePreviewSession.currentSession&&m.FilePreviewSession.currentSession.id,h=i.file,_=i.url,g=h.file_id,E=h.fq_path,b=g||E,I=n&&n.account_id,y=new k(h,_);n?(b&&!u&&(S.SharingActions.fetchFileMemberCount({user:n,contentId:b,limit:T,countGroupsAsMembers:!1,url:_,previewSessionId:p,runViewerInfoChecks:!0}),S.SharingActions.listMembers({user:n,contentId:b,isFolder:!1,limit:6,url:_,previewSessionId:p,includeSeenState:!1})),w.fetchSeenStateInfo(n,g,o,_,p),A.receiveBeaconData({beaconFileData:y,user:n,previewSessionId:p})):f.PassActions.updatePermissions(g,{canReadPresence:!1,canReadSeenState:!1});var C=v.Viewer.get_viewer().is_assume_user_session;if(!c||C)f.PassActions.updatePermissions(g,{canWritePresence:!1});else{var M=s&&new k(s.file,s.url);A.transmitBeaconData({beaconFileData:y,prevBeaconFileData:M,accountId:I,previewSessionId:p}),r.default(window).off("beforeunload.passpresence"),r.default(window).on("beforeunload.passpresence",function(e){t.teardown({user:n,fileData:i,async:!1,shouldWritePresence:!0}),e.returnValue=void 0})}},e})();t.PassHelpers=N;var k=(function(){function e(e,t){this.fileId=e.file_id,this.context=e.beacon_context,this.url=t}return e})();t.BeaconFileData=k;var A=(function(){function e(){}return e.shutdown=function(e){var t=e.beaconFileData,n=e.user,r=e.async,i=e.shouldWritePresence,s=void 0===i||i,a=[];this.transmitterData&&(a.push([this.transmitterData.beaconUserId,this.transmitterData.identifier]),this.transmitterData.transmitter.stop()),delete this.transmitterData,a.length>0&&!v.Viewer.get_viewer().is_assume_user_session&&s&&w.updateSeenStateOnResign(n,t,r,a),this.receiverData&&this.receiverData.receiver&&(this.receiverData.receiver.stop(),delete this.receiverData)},e.receiveBeaconData=function(e){var t=this,n=e.beaconFileData,r=e.user,i=e.previewSessionId,a=n.fileId;if(!n.context||0===n.context.length)return void f.PassActions.updatePermissions(a,{canReadPresence:!1});_.ActionTimestampsTracker.record(g.LoggingActions.RECEIVER_TOKEN_BEGIN,i),s.SilentBackgroundRequest({url:"/get_pass_receiver_token",type:"GET",dataType:"json",data:{account_id:r.account_id,context:n.context,shared_link_url:n.url},success:function(e){var s=!0;if(s=!(!e.auth_key||!e.token||e.error),f.PassActions.updatePermissions(a,{canReadPresence:s}),e.error){if("no_permission"===e.error)return;y(a)}else{_.ActionTimestampsTracker.record(g.LoggingActions.RECEIVER_TOKEN_RECEIVE,i);var o=e.token,l=[new u.PresenceParams(u.PresenceType.Context,r.account_id,t.APP,n.context,o)];t.receiverData&&t.receiverData.receiver&&t.receiverData.receiver.stop(),t.receiverData={authKey:e.auth_key,receiver:new u.Receiver(l,function(e){_.ActionTimestampsTracker.record(g.LoggingActions.PRESENCE_RECEIVE,i),t.onUpdate(e,r.id,n)},function(){return t.receiveBeaconData({beaconFileData:n,user:r,previewSessionId:i})})},t.receiverData.receiver.start()}}})},e.onUpdate=function(e,t,n){var r=e[0],i=n.fileId;if(r.delta){var s=this.parseBeaconUpdates(r.delta);f.PassActions.receivePresenceDelta(t,i,s.onlineUniqueUsers,s.offlineUniqueUsers)}else if(r.snapshot){var s=this.parseBeaconUpdates(r.snapshot);f.PassActions.receivePresenceSnapshot(t,i,s.onlineUniqueUsers)}},e.parseBeaconUpdates=function(e){for(var t={},n={},r=0,i=e;r<i.length;r++){var s=i[r],a=s.agent,o=a.user_id,l=a.source.identifier;s.status===I.BEACON_ONLINE_STATUS?(o in t||(t[o]={}),t[o][l]=!0):s.status===I.BEACON_OFFLINE_STATUS&&(o in n||(n[o]={}),n[o][l]=!0)}return{onlineUniqueUsers:t,offlineUniqueUsers:n}},e.transmitBeaconData=function(e){var t=this,n=e.beaconFileData,r=e.prevBeaconFileData,i=e.accountId,s=e.previewSessionId;this.transmitterData&&r&&(this.transmitterData.transmitter.add_or_update_agents([this.getAgentStatusForFile(this.transmitterData.beaconUserId,this.transmitterData.identifier,this.transmitterData.authKey,r,I.BEACON_OFFLINE_STATUS)]),setTimeout(function(){t.transmitterData.transmitter.stop()},1)),this.fetchTransmitterToken(i,n,r,s)},e.getAgentStatusForFile=function(e,t,n,r,i){var s=new u.Source(this.PLATFORM,this.SURFACE,t),a=new u.Agent(e,this.APP,r.context,s);return new u.AgentStatus(a,i,n)},e.fetchTransmitterToken=function(e,t,n,r){var a=this,o=t.fileId,l=t.context,c=t.url;if(!l||0===l.length)return void f.PassActions.updatePermissions(o,{canWritePresence:!1});_.ActionTimestampsTracker.record(g.LoggingActions.TRANSMITTER_TOKEN_BEGIN,r),s.SilentBackgroundRequest({url:"/get_pass_transmitter_token",type:"GET",dataType:"json",data:{account_id:e,context:l,shared_link_url:c},success:function(n){var s=!0;if(s=!(n.error||!n.beacon_user_id||!n.auth_key||!n.token),f.PassActions.updatePermissions(o,{canWritePresence:s}),s&&_.ActionTimestampsTracker.record(g.LoggingActions.TRANSMITTER_TOKEN_RECEIVE,r),n.error){if("no_permission"===n.error)return;y(o)}else{var l=n.token;a.transmitterData={identifier:E.UUID.v4({allowInsecure:!0}),beaconUserId:n.beacon_user_id,authKey:n.auth_key,transmitter:new u.Transmitter(l,function(){return a.fetchTransmitterToken(e,t,null,r)},i.noop)},t&&a.transmitterData.transmitter.add_or_update_agents([a.getAgentStatusForFile(a.transmitterData.beaconUserId,a.transmitterData.identifier,a.transmitterData.authKey,t,I.BEACON_ONLINE_STATUS)]),a.transmitterData.transmitter.start()}}})},e.APP="harmony",e.PLATFORM=u.Platforms.WEB,e.SURFACE="file_viewer",e.receiverData=null,e.transmitterData=null,e})();t.BeaconPresenceHelpers=A,t.DEFAULT_SYNCHRONOUS_MODE_TIMEOUT=9e3;var w=(function(){function e(){}return e.constructFakeSeenStateInfo=function(e,t,n){for(var r=n.seen_states,i=[],s=0,a=r;s<a.length;s++){var o=a[s];i.push(o.seen_state_user.user_id)}for(var l=0,c=e;l<c.length;l++){var d=c[l];if(!i.includes(d.user_id)){d.sharing_access_type&&(d.sharing_access_type=this.convertToUnion(d.sharing_access_type));var u=[],p={seen_state_user:d,when_last_seen:t,seen_events:u};r.unshift(p)}}return n.seen_states=r,n},e.convertToUnion=function(e){return e?d.Union.parse(e):null},e.parseSeenStatePassPlatform=function(e){if(e){switch(d.Union.parse(e).type){case"web":return g.PASS_PLATFORM.WEB;case"mobile":return g.PASS_PLATFORM.MOBILE;case"desktop":return g.PASS_PLATFORM.DESKTOP}}return g.PASS_PLATFORM.UNKNOWN},e.fetchSeenStateUsers=function(e,t,n,r,i){var s=this,a=Date.now()/1e3,l=m.FilePreviewSession.currentSession&&m.FilePreviewSession.currentSession.id;return _.ActionTimestampsTracker.record(g.LoggingActions.SEEN_STATE_USERS_BEGIN,l),(new o.UserApiV2Client).ns("seen_state").rpc("get_seen_state_users",{user_ids:n,file_info:M(r,i)},{subjectUserId:e}).catch(c.catchApiError(function(){return y(r),Promise.reject(void 0)})).then(function(e){_.ActionTimestampsTracker.record(g.LoggingActions.SEEN_STATE_USERS_RECEIVE,l);var n=s.constructFakeSeenStateInfo(e,a,t);f.PassActions.updateSeenStateInfo(r,n)})},e.processAndUpdateSeenStateInfo=function(e,t,n,r){var i=n[0],s=i.seen_state_info,a=i.seen_state_error,o=i.seen_state_cursor;if(a)if(r)f.PassActions.discontinueSeenStateInfo(t);else{if("no_permission"===d.Union.parse(a).type)return;y(t)}else{for(var l=0,c=s.seen_states;l<c.length;l++){var u=c[l];u.seen_state_user.sharing_access_type=this.convertToUnion(u.seen_state_user.sharing_access_type),u.platform_type=this.parseSeenStatePassPlatform(u.platform_type)}r?f.PassActions.updateSeenStateInfoContinue(t,s,o):f.PassActions.updateSeenStateInfo(t,s,o)}},e.fetchSeenStateInfo=function(e,t,n,r,i){var s=this;return _.ActionTimestampsTracker.record(g.LoggingActions.SEEN_STATE_BEGIN,i),(new o.UserApiV2Client).ns("seen_state").rpc("get_seen_state_info",{file_infos:[M(t,r)],limit:n},{subjectUserId:e.id}).catch(c.catchApiError(function(){return y(t),Promise.reject(void 0)})).then(function(n){var a=!0,o=n[0],l=o.seen_state_info,c=o.seen_state_error;a=!(!l||c),f.PassActions.updatePermissions(t,{canReadSeenState:a}),a||f.PassActions.updateSeenStateUnavailable(e.id,t),a&&_.ActionTimestampsTracker.record(g.LoggingActions.SEEN_STATE_RECEIVE,i),s.processAndUpdateSeenStateInfo(e,t,n,!1),a&&s.fetchRemainingSeenStateInfo(e,t,n,r)})},e.fetchRemainingSeenStateInfo=function(e,t,n,r){var i=n[0],s=i.seen_state_cursor;if(s&&s.has_next){var a=s.cursor_state;a&&this.fetchSeenStateInfoContinue(e,t,a,1e5,r)}},e.fetchSeenStateInfoContinue=function(e,t,n,r,i){var s=this;return(new o.UserApiV2Client).ns("seen_state").rpc("get_seen_state_info/continue",{file_infos:[M(t,i)],cursor:n,limit:r},{subjectUserId:e.id}).catch(c.catchApiError(function(){return f.PassActions.discontinueSeenStateInfo(t),Promise.reject(void 0)})).then(function(n){s.processAndUpdateSeenStateInfo(e,t,n,!0)})},e.getCoachmark=function(e,t,n,r){return(new o.UserApiV2Client).ns("seen_state").rpc("get_coachmark_info",{file_info:M(t,n)},{subjectUserId:e}).catch(c.catchApiError(function(){return Promise.reject(void 0)})).then(function(e){r(e.type_with_data)})},e.logCoachmarkInteraction=function(e,t,n,r,i){return(new o.UserApiV2Client).ns("seen_state").rpc("log_coachmark_interaction",{type:r,interaction:i,file_info:M(t,n)},{subjectUserId:e}).catch(c.catchApiError(function(){return Promise.reject(void 0)}))},e.updateSeenStateOnResign=function(e,n,r,i){var s;if(r)s=new a.JQueryAsyncTransport;else{var o=b.PASS_RESIGN_ONBEFOREUNLOAD_TIMEOUT||t.DEFAULT_SYNCHRONOUS_MODE_TIMEOUT;s=new a.JQuerySyncTransport(o)}for(var l=[],c=0,d=i;c<d.length;c++){var u=d[c],p=u[0],h=u[1];l.push({beacon_user_id:p,context:n.context,shared_link_url:n.url,identifier:h})}return C(e,function(e,t,n){return e.rpc("update_timestamps_and_mark_offline",t,n)},function(e,t,n){return e.rpc("logged_out/mark_offline",t,n)},{beacon_infos:l},s)},e})();t.SeenStateHelpers=w}),define("modules/clean/react/pass/store",["require","exports","tslib","external/lodash","modules/clean/flux/base_store","modules/clean/react/pass/constants","modules/clean/react/pass/utils","modules/core/exception"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),o=n.__importStar(o);var l=(function(){function e(){this.userIdToUniqueIds={}}return e.prototype.addUniqueUser=function(e,t){e in this.userIdToUniqueIds||(this.userIdToUniqueIds[e]={}),this.userIdToUniqueIds[e][t]=!0},e.prototype.removeUniqueUser=function(e,t){e in this.userIdToUniqueIds&&t in this.userIdToUniqueIds[e]&&(delete this.userIdToUniqueIds[e][t],Object.keys(this.userIdToUniqueIds[e]).length||delete this.userIdToUniqueIds[e])},e.prototype.getOnlineUserIds=function(){return Object.keys(this.userIdToUniqueIds)},e})(),c=(function(e){function t(t){var n=e.call(this,t)||this;return n.seenStateInfos={},n.seenStateCursors={},n.presenceInfos={},n.passFetchingStatusMap={},n.userIdsWithoutSeenStateInfoMap={},n.passPermissions={},n}return n.__extends(t,e),t.prototype.presence=function(e){return e in this.presenceInfos?this.presenceInfos[e].getOnlineUserIds():null},t.prototype.seenStateInfo=function(e){return this.seenStateInfos[e]||null},t.prototype.identifiedSeenStateInfo=function(e){if(e in this.seenStateInfos){return{seen_states:r.reject(this.seenStateInfos[e].seen_states,a.AnonymousViewerUtils.isAnonymousSeenState)}}return null},t.prototype.seenStateCursorHasNext=function(e){return e in this.seenStateCursors?this.seenStateCursors[e].has_next:null},t.prototype.seenStateCursorState=function(e){return e in this.seenStateCursors?this.seenStateCursors[e].cursor_state:null},t.prototype.passFetchingStatus=function(e){return this.passFetchingStatusMap[e]||s.PASS_FETCHING_STATUS.NOT_YET_KNOWN},t.prototype.getLinkAndGroupSeenStateInfo=function(e){var t=null,n=null;if(!this.seenStateInfos[e])return{linkSeenStateInfo:t,groupSeenStateInfo:n};t=[],n={};for(var r=0,i=this.seenStateInfos[e].seen_states;r<i.length;r++){var s=i[r];if(!a.AnonymousViewerUtils.isAnonymousSeenState(s)){var o=s.seen_state_user.sharing_access_type;if(o)switch(o.type){case"link_only":t.push(s);break;case"view_member_access":case"edit_member_access":for(var l=o.value.group_ids,c=0,d=l;c<d.length;c++){var u=d[c];u in n||(n[u]=[]),n[u].push(s)}}}}return{linkSeenStateInfo:t,groupSeenStateInfo:n}},t.prototype.anonymousPresence=function(e){return e in this.presenceInfos?a.AnonymousViewerUtils.getAnonymousUserIds(this.presenceInfos[e].getOnlineUserIds()):null},t.prototype.userIdsWithoutSeenStateInfo=function(e){return this.userIdsWithoutSeenStateInfoMap[e]||[]},t.prototype.isPassPermissionsPending=function(e){var t=this.passPermissions[e];return null!=t&&!(t.hasOwnProperty("canReadPresence")&&t.hasOwnProperty("canReadSeenState")&&t.hasOwnProperty("canWritePresence"))},t.prototype.getPassPermissions=function(e){if(!e)return null;var t=this.passPermissions[e];return null==t||this.isPassPermissionsPending(e)?null:t},t.prototype.resetPassInfo=function(e){delete this.seenStateInfos[e],delete this.seenStateCursors[e],delete this.presenceInfos[e],delete this.passFetchingStatusMap[e],delete this.passPermissions[e],delete this.userIdsWithoutSeenStateInfoMap[e],this.emit_change()},t.prototype.setPassPermissionRequest=function(e){this.passPermissions[e]={},this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.FETCHING)},t.prototype.updatePermissions=function(e,t){this.passPermissions.hasOwnProperty(e)&&(this.passPermissions[e]=n.__assign({},this.passPermissions[e],t),this.emit_change())},t.prototype.markPassConcludedIfNecessary=function(e){var t=this.passPermissions[e];!(t&&t.hasOwnProperty("canReadPresence")&&t.hasOwnProperty("canReadSeenState"))||t.canReadPresence||t.canReadSeenState||(this.resetPassInfo(e),this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.CONCLUDED),this.updateSeenStateInfoWithEmptyData(e))},t.prototype.receivePresenceDelta=function(e,t,n,r){o.assert([s.PASS_FETCHING_STATUS.FETCHING,s.PASS_FETCHING_STATUS.NOT_YET_KNOWN].indexOf(this.passFetchingStatus(t))===-1,"Before handling a presence delta, you must call assurePresenceSuccessRegistered");var i=this.getOnlineUsersForFileId(t);this.updatePresenceInfos(t,n,r),this.updateUserIdsWithoutSeenStateInfo(e,t,i),this.emit_change()},t.prototype.receivePresenceSnapshot=function(e,t,n){o.assert([s.PASS_FETCHING_STATUS.FETCHING,s.PASS_FETCHING_STATUS.NOT_YET_KNOWN].indexOf(this.passFetchingStatus(t))===-1,"Before handling a presence delta, you must call assurePresenceSuccessRegistered");var r=this.getOnlineUsersForFileId(t);this.presenceInfos[t]=new l,this.updatePresenceInfos(t,n,{}),this.updateUserIdsWithoutSeenStateInfo(e,t,r),this.emit_change()},t.prototype.getOnlineUsersForFileId=function(e){return e in this.presenceInfos||(this.presenceInfos[e]=new l),this.presenceInfos[e].getOnlineUserIds()},t.prototype.updatePresenceInfos=function(e,t,n){for(var r=0,i=Object.keys(n);r<i.length;r++)for(var s=i[r],a=0,o=Object.keys(n[s]);a<o.length;a++){var l=o[a];this.presenceInfos[e].removeUniqueUser(s,l)}for(var c=0,d=Object.keys(t);c<d.length;c++)for(var u=d[c],p=0,h=Object.keys(t[u]);p<h.length;p++){var l=h[p];this.presenceInfos[e].addUniqueUser(u,l)}},t.prototype.updateUserIdsWithoutSeenStateInfo=function(e,t,n){var i,o,l=a.AnonymousViewerUtils.filterAnonymousUserIds(this.getOnlineUsersForFileId(t)),c=a.AnonymousViewerUtils.filterAnonymousUserIds(n),d=r.difference(c,l),u=r.difference(l,c);if(t in this.seenStateInfos){var p=void 0,h=this.passFetchingStatus(t);if([s.PASS_FETCHING_STATUS.SEEN_STATE_DISALLOWED,s.PASS_FETCHING_STATUS.PASS_MIXED_SUCCESS].indexOf(h)!==-1)i=this.createMinimalBaseSeenStateInfo(t,l),o=i.userIdsWithoutSeenStateInfo,p=i.baseSeenStateInfo,this.updateSeenStateInfo(t,p);else{var m=this.makeSeenStateAgreeWithUpdatedPresence(t,l,d,u);o=m.userIdsWithoutSeenStateInfo,p=m.baseSeenStateInfo}}else o=[];this.userIdsWithoutSeenStateInfoMap[t]=o},t.prototype.makeSeenStateAgreeWithUpdatedPresence=function(e,t,n,r){for(var i=[],s=this.seenStateInfos[e],a=s.seen_states,o=[],l=[],c=[],d=Date.now()/1e3,u=0,p=a;u<p.length;u++){var h=p[u],m=h.seen_state_user.user_id;m&&(i.push(m),r.includes(m)?(h.when_last_seen=d,h.seen_events=h.seen_events||[],l.push(h)):n.includes(m)?(h.when_last_seen=d,h.seen_events=h.seen_events||[],h.seen_events.push({ts:d}),c.push(h)):o.push(h))}return s.seen_states=l.concat(c,o),{userIdsWithoutSeenStateInfo:t.filter(function(e){return!i.includes(e)}),baseSeenStateInfo:s}},t.prototype.createMinimalBaseSeenStateInfo=function(e,t){for(var n=[],i=[],s=0,a=this.seenStateInfos[e].seen_states;s<a.length;s++){var o=a[s],l=o.seen_state_user.user_id;l&&t.includes(l)&&(n.push(o),i.push(l))}return{userIdsWithoutSeenStateInfo:r.difference(t,i),baseSeenStateInfo:{seen_states:n}}},t.prototype.updateSeenStateInfo=function(e,t,n){void 0===n&&(n=!1),o.assert([null,s.PASS_FETCHING_STATUS.FETCHING].indexOf(this.passFetchingStatus(e))===-1,"Before updating seen state info, you must call assureSeenStateSuccessRegistered or onFetchSeenStateDisabled"),n&&e in this.seenStateInfos?this.seenStateInfos[e].seen_states=this.seenStateInfos[e].seen_states.concat(t.seen_states):this.seenStateInfos[e]=t,
this.userIdsWithoutSeenStateInfoMap[e]=[],this.emit_change()},t.prototype.updateSeenStateInfoWithEmptyData=function(e){var t={seen_states:[]};this.updateSeenStateInfo(e,t)},t.prototype.setPassFetchingStatus=function(e,t){this.passFetchingStatusMap[e]=t,this.emit_change()},t.prototype.updateSeenStateCursor=function(e,t){t&&(this.seenStateCursors[e]=t,this.emit_change())},t.prototype.assureSeenStateSuccessRegistered=function(e){switch(this.passFetchingStatus(e)){case s.PASS_FETCHING_STATUS.FETCHING:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.SEEN_STATE_SUCCESS);break;case s.PASS_FETCHING_STATUS.PRESENCE_SUCCESS:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.PASS_SUCCESS);break;case s.PASS_FETCHING_STATUS.SEEN_STATE_DISALLOWED:o.reportStack("Debugging FETCHING_STATUS: pass fetching status is seen state disallowed",{severity:o.SEVERITY.NONCRITICAL,tags:["pass:fetch_seen_state_disallowed"],exc_extra:{storeHasPresence:e in this.presenceInfos,storeHasSeenState:e in this.seenStateInfos,passPermissions:JSON.stringify(this.passPermissions[e]),fetchingStatus:this.passFetchingStatusMap[e]}});break;case s.PASS_FETCHING_STATUS.NOT_YET_KNOWN:o.reportStack("Debugging FETCHING_STATUS: pass fetching status is not yet known",{severity:o.SEVERITY.CRITICAL,tags:["pass:fetch_seen_state_success"],exc_extra:{fetchingStatus:this.passFetchingStatusMap[e]}})}},t.prototype.onFetchSeenStateDisabled=function(e){switch(this.passFetchingStatus(e)){case s.PASS_FETCHING_STATUS.PRESENCE_SUCCESS:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.PASS_MIXED_SUCCESS);break;case s.PASS_FETCHING_STATUS.FETCHING:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.SEEN_STATE_DISALLOWED);break;case s.PASS_FETCHING_STATUS.NOT_YET_KNOWN:o.reportStack("Debugging FETCHING_STATUS: pass fetching status is not yet known",{severity:o.SEVERITY.CRITICAL,tags:["pass:fetch_seen_state_success"],exc_extra:{fetchingStatus:this.passFetchingStatusMap[e]}})}},t.prototype.assurePresenceSuccessRegistered=function(e){switch(this.passFetchingStatus(e)){case s.PASS_FETCHING_STATUS.SEEN_STATE_SUCCESS:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.PASS_SUCCESS);break;case s.PASS_FETCHING_STATUS.SEEN_STATE_DISALLOWED:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.PASS_MIXED_SUCCESS);break;case s.PASS_FETCHING_STATUS.FETCHING:this.setPassFetchingStatus(e,s.PASS_FETCHING_STATUS.PRESENCE_SUCCESS);break;case s.PASS_FETCHING_STATUS.NOT_YET_KNOWN:o.reportStack("Debugging FETCHING_STATUS: pass fetching status is not yet known",{severity:o.SEVERITY.CRITICAL,tags:["pass:fetch_presence_success"],exc_extra:{fetchingStatus:this.passFetchingStatusMap[e]}})}},t.prototype._new_payload=function(e){var t=e.action,n=t.type,r=t.data;if(r){var i=r.userId,a=r.fileId,o=r.seenStateInfo,l=r.seenStateCursor,c=r.onlineUniqueUsers,d=r.offlineUniqueUsers,u=r.partialPermission;switch(i=i,a=a,o=o,l=l,c=c,d=d,u=u,n){case s.ActionTypes.FETCH_PASS_ERROR:this.setPassFetchingStatus(a,s.PASS_FETCHING_STATUS.ERROR);break;case s.ActionTypes.FETCH_PASS_CONCLUDED:this.setPassFetchingStatus(a,s.PASS_FETCHING_STATUS.CONCLUDED),this.updateSeenStateInfoWithEmptyData(a);break;case s.ActionTypes.PASS_PERMISSION_REQUEST:this.setPassPermissionRequest(a);break;case s.ActionTypes.RECEIVE_PRESENCE_DELTA:this.assurePresenceSuccessRegistered(a),this.receivePresenceDelta(i,a,c,d);break;case s.ActionTypes.RECEIVE_PRESENCE_SNAPSHOT:this.assurePresenceSuccessRegistered(a),this.receivePresenceSnapshot(i,a,c);break;case s.ActionTypes.RESET_PASS_INFO:this.resetPassInfo(a);break;case s.ActionTypes.UPDATE_PERMISSIONS:this.updatePermissions(a,u),this.markPassConcludedIfNecessary(a);break;case s.ActionTypes.DISCONTINUE_SEEN_STATE_INFO:l={cursor_state:"",has_next:!1},this.updateSeenStateCursor(a,l);break;case s.ActionTypes.UPDATE_SEEN_STATE_INFO:this.assureSeenStateSuccessRegistered(a),this.updateSeenStateInfo(a,o),this.updateSeenStateCursor(a,l);break;case s.ActionTypes.UPDATE_SEEN_STATE_INFO_CONTINUE:this.assureSeenStateSuccessRegistered(a),this.updateSeenStateInfo(a,o,!0),this.updateSeenStateCursor(a,l);break;case s.ActionTypes.UPDATE_SEEN_STATE_UNAVAILABLE:this.onFetchSeenStateDisabled(a),this.updateSeenStateInfoWithEmptyData(a),this.updateUserIdsWithoutSeenStateInfo(i,a,[])}}},t})(i.Store);t.PassStore=c,t.passStore=new c}),define("modules/clean/react/teams/modals/limited_team_share_folder_modal",["require","exports","tslib","external/create-react-class","react","external/react-dom-factories","external/prop-types","external/react-addons-pure-render-mixin","modules/clean/analytics","modules/clean/filepath","modules/clean/react/modal","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h){"use strict";function m(e){var t=d.Modal.showInstance(_(g,e));return f("team_folder_share"),t}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importStar(s),a=n.__importStar(a),o=n.__importStar(o),c=n.__importStar(c),u=n.__importStar(u);var _=i.default.createElement,f=function(e){return l.TeamsWebActionsLogger.log(e,null,null,null,!1,l.TeamsWebActionsLogger.LOG_CATEGORY.TEAM_INFO)},g=r.default({mixins:[o],displayName:"LimitedTeamShareFolderModal",propTypes:{fqPath:a.string.isRequired},_navigateToTeam:function(){return f("team_folder_share_invite"),u.redirect(new h.URI({path:"/team",query:{invite_members:"",tk:"team_folder_share_invite",_camp:"modal"}}))},render:function(){var e=c.filename(this.props.fqPath);return _(d.Modal,{title:p._("Share %(folder_name)s").format({folder_name:e}),acceptButtonText:p._("Invite"),onAccept:this._navigateToTeam,showButtonDivider:!0},s.div({},p._("To share the %(folder_name)s with someone, invite them to join your team!").format({folder_name:e})))}});t.showModalInstance=m}),define("modules/clean/sharing/action_types",["require","exports","modules/clean/flux/action_type"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalActionTypes=n.withActionNamespace("share-modal-actions",{SHARE_MODAL_OPEN:"share-modal-open",SHARE_MODAL_CLOSE:"share-modal-close",RESET_MODAL_STATE:"reset-modal-state",OPEN_LINK_SETTINGS_MODAL:"open-link-settings-modal",OPEN_FOLDER_SETTINGS_MODAL:"open-folder-settings-modal",OPEN_SHARED_LINK_MODAL:"open-shared-link-modal",CLOSE_LINK_SETTINGS_MODAL:"close-link-settings-modal",CLOSE_FOLDER_SETTINGS_MODAL:"close-folder-settings-modal",CLOSE_SHARED_LINK_MODAL:"close-shared-link-modal",CLEAR_METADATA:"clear-metadata",FETCH_METADATA_REQUEST:"metadata-request",FETCH_METADATA_SUCCESS:"metadata-success",FETCH_METADATA_FAILURE:"metadata-failure",CLEAR_LINK_METADATA:"clear-link-metadata",FETCH_LINK_METADATA_REQUEST:"link-metadata-request",FETCH_LINK_METADATA_SUCCESS:"link-metadata-success",FETCH_LINK_METADATA_FAILURE:"link-metadata-failure",CLEAR_SHARING_PREFS:"clear-sharing-prefs",FETCH_SHARING_PREFS_REQUEST:"sharing-prefs-request",FETCH_SHARING_PREFS_SUCCESS:"sharing-prefs-success",FETCH_SHARING_PREFS_FAILURE:"sharing-prefs-failure",FETCH_MAGNET2018_REQUEST:"fetch-magnet2018-experiment",FETCH_MAGNET2018_SUCCESS:"fetch-magnet2018-success",FETCH_MAGNET2018_FAILURE:"fetch-magnet2018-failure",FETCH_LINK_SETTINGS_VARIANT:"fetch-link-settings-embed-experiment",FETCH_TWO_LINK_REDESIGN:"fetch-two-link-redesign",FETCH_PLUS_TO_PRO_TRIALS:"fetch-plus-to-pro-trials",FETCH_SHARE_MODAL_LINK_SETTINGS_VARIANT:"fetch-share-modal-link-settings-variant",ERROR_MESSAGE:"error-message",ERROR_MESSAGE_CLEAR:"error-message-clear",CLEAR_FILE_MEMBERSHIP:"clear-file-membership",FETCH_FILE_MEMBERSHIP_REQUEST:"fetch-file-membership-request",FETCH_FILE_MEMBERSHIP_SUCCESS:"fetch-file-membership-success",FETCH_FILE_MEMBERSHIP_FAILURE:"fetch-file-membership-failure",CLEAR_FOLDER_MEMBERSHIP:"clear-folder-membership",FETCH_FOLDER_MEMBERSHIP_REQUEST:"fetch-folder-membership-request",FETCH_FOLDER_MEMBERSHIP_SUCCESS:"fetch-folder-membership-success",FETCH_FOLDER_MEMBERSHIP_FAILURE:"fetch-folder-membership-failure",FETCH_USER_ACCOUNTS_REQUEST:"fetch-user-accounts-request",FETCH_USER_ACCOUNTS_SUCCESS:"fetch-user-accounts-success",FETCH_USER_ACCOUNTS_FAILURE:"fetch-user-accounts-failure",FETCH_USER_ACCOUNTS_CONTINUED_REQUEST:"fetch-user-accounts-continued-request",FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS:"fetch-user-accounts-continued-success",CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO:"clear-file-membership-last-seen-info",FETCH_FILE_MEMBER_COUNT_REQUEST:"fetch-file-member-count-request",FETCH_FILE_MEMBER_COUNT_SUCCESS:"fetch-file-member-count-success",CHANGE_RECIPIENTS:"change-recipients",CHANGE_RECIPIENT_MESSAGE:"change-recipient-message",CHANGE_RECIPIENT_ACCESS:"change-recipient-access",CREATE_LINK_REQUEST:"create-link-request",CREATE_LINK_SUCCESS:"create-link-success",CREATE_LINK_FAILURE:"create-link-failure",DISPLAY_CONTENT_NAME_INFO:"display-content-name-info",SEND_SHARE_REQUEST:"send-share-request",SEND_SHARE_SUCCESS:"send-share-success",SEND_SHARE_FAILURE:"send-share-failure",SHARE_FOLDER_REQUEST:"share-folder-request",SHARE_FOLDER_SUCCESS:"share-folder-success",SHARE_FOLDER_FAILURE:"share-folder-failure",SEND_FOLDER_SHARE_REQUEST:"send-folder-share-request",SEND_FOLDER_SHARE_SUCCESS:"send-folder-share-success",SEND_FOLDER_SHARE_FAILURE:"send-folder-share-failure",CHANGE_MEMBER_ACCESS_REQUEST:"change-member-access-request",CHANGE_MEMBER_ACCESS_SUCCESS:"change-member-access-success",CHANGE_MEMBER_ACCESS_FAILURE:"change-member-access-failure",MEMBER_ACTION_PENDING:"member-action-pending",MEMBER_ACTION_COMPLETE:"member-action-complete",REMOVE_MEMBER_SUCCESS:"remove-member-success",REMOVE_MEMBER_KEEP_ACCESS:"remove-member-keep-access",TRANSFER_OWNER_SUCCESS:"transfer-owner-success",FETCH_TEAM_POLICY_REQUEST:"fetch-team-policy-request",FETCH_TEAM_POLICY_SUCCESS:"fetch-team-policy-success",FETCH_MEMBER_COUNTS_REQUEST:"fetch-member-counts-request",FETCH_MEMBER_COUNTS_SUCCESS:"fetch-member-counts-success",HANDLE_CONTENT_NAME_CHANGE:"handle-content-name-change",HANDLE_CONTENT_NAME_FOCUS_CHANGE:"handle-content-name-focus-change",VALIDATE_CONTENT_NAME_SUCCESS:"validate-content-name-success",VALIDATE_CONTENT_NAME_ERROR:"validate-content-name-error",CHANGE_LINK_AUDIENCE_REQUEST:"change-link-audience-request",CHANGE_LINK_AUDIENCE_SUCCESS:"change-link-audience-success",CHANGE_LINK_AUDIENCE_FAILURE:"change-link-audience-failure",UNBLOCK_MEMBER_LIST_ON_PASS_LOAD:"unblock-member-list-on-pass-load",UPDATE_SHARING_SETTINGS_SUCCESS:"update-sharing-settings-success",DELETE_LINK_METADATA_SUCCESS:"delete-link-metadata-success",CHANGE_CREATE_COMMENT_CHECKBOX:"change-create-comment-checkbox"}),t.SharingActionTypes=n.withActionNamespace("sharing-actions",{CLEAR_EVERYTHING:"clear-everything",FETCH_METADATA_BATCH_ATTEMPT:"fetch-metadata-batch-attempt",FETCH_METADATA_BATCH_SUCCESS:"fetch-metadata-batch-success",FETCH_METADATA_BATCH_FAIL:"fetch-metadata-batch-fail"})}),define("modules/clean/sharing/actions/share_modal",["require","exports","tslib","react","modules/clean/analytics","modules/clean/api_v2/error","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/react/pass/data_helpers","modules/clean/react/pass/store","modules/clean/react_format","modules/clean/sharing/action_types","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal","modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/access_level","modules/clean/sharing/constants","modules/clean/sharing/parent_folder_access_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/ui_util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/views/inherited_members","modules/clean/teams/membership_discovery_util","modules/clean/teams/modals/create_team_prompt_modal","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/clean/legacy_pyxl_controllers/ajax_form","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/clean/react/snackbar","modules/clean/sharing/share_modal_util","modules/clean/dbmodal_stack","modules/clean/growth/gating"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I,y,C,M,T,N,k,A,w,L,P,F,R,O,D,x,U,B,H,G,V,q,j,W,K){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a),B=n.__importDefault(B),H=n.__importStar(H),G=n.__importStar(G),V=n.__importStar(V);var Y=r.default.createElement,z=V.i18n_default_project("sharing")._,Q=(function(){function t(t,o,l,p,h,m){var _=this;this.groupSeenStateInfo=null,this.linkSeenStateInfo=null,this.presentAccountIds=null,this.hasLoggedSet={},this.setPath=null,this.setUrl=null,this.changeAccess=function(e,t,n){void 0===n&&(n=!1);var r=Promise.resolve({}),i=e.memberId(),s=_.getContentInfo(),a=s.id,o=_.sharingInfo.isNonUserRelativeContext();if(t===T.MEMBER_ACTION.REMOVE)i!==_.user.account_id||o?(r=(s.isFileFolder()?_.client.getParentFolderAccess({contentId:_.sharingInfo.parentSharedFolderId(),memberId:i}):_.removeMember(a,e,n,s.isFolder())).then(function(t){_.showParentFolderAccessModalIfQualified("remove",e,t)}),_.openShareModal()):_.relinquishMembership(a,n);else if(t===M.ACCESS_LEVEL.OWNER)r=_.client.transferContent({contentId:a,memberId:i}).then(function(){_.dispatch(g.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS),F.sharingNotificationSuccess(z("Made %(name)s the owner").format({name:e.displayName()})),_.fetchDataAndShowShareModal()});else{var l=void 0;if(s.isFileFolder()&&t===M.ACCESS_LEVEL.READER)l=_.client.getParentFolderAccess({contentId:_.sharingInfo.parentSharedFolderId(),memberId:i,accessLevel:t});else{var c=_.getContentInfo().isFileFolder();c&&_.dispatch(g.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:e}),l=_.shareIfFileFolder(z("Updating member access...")).then(function(){return c&&_.dispatch(g.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e}),_.changeMemberAccess(_.getContentInfo().id,e,t)}).catch(function(t){_.reportShareFailure(t),c&&_.dispatch(g.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e})})}r=l.then(function(t){_.fetchInitialData(),q.Snackbar.complete(z("Member access updated."),"sharing-notification"),_.showParentFolderAccessModalIfQualified("update",e,t)})}return r.then(_.refreshSharedWithColumnContentData)},this.changeRecipientAccess=function(e){_.dispatch(g.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS,{newAccess:e})},this.changeRecipientMessage=function(e){_.dispatch(g.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE,{message:e})},this.changeCreateCommentCheckbox=function(e){_.dispatch(g.ShareModalActionTypes.CHANGE_CREATE_COMMENT_CHECKBOX,{checked:e})},this.createSharedLink=function(e){_.log("CLICK_TIB_CREATE_LINK"),_.dispatch(g.ShareModalActionTypes.CREATE_LINK_REQUEST),_.sharingInfo.isMultipleLinkInterfaceEnabled()?"editor"===e?q.Snackbar.sync(z("Creating edit link..."),!1,"sharing-notification"):q.Snackbar.sync(z("Creating view link..."),!1,"sharing-notification"):q.Snackbar.sync(z("Creating link..."),!1,"sharing-notification");var t;e&&(t={access:b.linkAccessLevelToApi(e)});var n=_.getContentInfo(),r=n.fileId()||n.displayPath();return _.client.createSharedLink({fileIdOrPath:r,settings:t}).then(function(t){_.dispatch(g.ShareModalActionTypes.CREATE_LINK_SUCCESS,{linkMetadata:t}),_.refreshSharedWithColumnLinkData(),_.sharingInfo.isMultipleLinkInterfaceEnabled()?"editor"===e?q.Snackbar.complete(z("Edit link created."),"sharing-notification"):q.Snackbar.complete(z("View link created."),"sharing-notification"):q.Snackbar.complete(z("Link created."),"sharing-notification")}).catch(s.catchApiError(function(e){return e instanceof s.AppError&&e.error&&"access_denied"===e.error[".tag"]?_.getContentInfo().isFolder()?F.sharingNotificationError(z("You don’t have permission to create a link to this folder")):F.sharingNotificationError(z("You don’t have permission to create a link to this file")):_.showStandardError(e),_.dispatch(g.ShareModalActionTypes.CREATE_LINK_FAILURE),Promise.reject(e)}))},this.fetchMetadataForFile=function(e){return S.SharingActions.loadFileMetadata({user:_.user,contentId:e.id,sourceUrl:e.url(),client:_.client}).catch(s.catchApiError(_.handleLoadingError))},this.fetchMetadataForFileFolder=function(e){var t,r,i=T.MEMBER_ACTION.ALL,a=_.user.is_cdm_member?T.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE:T.VALIDATE_PATH_PERMISSIONS,o={actions:Object.keys(a),listMembersArg:{actions:i},shouldParseMetadataFromError:!0},l=!!_.sharingInfo.isNonUserRelativeContext();return l&&!_.user.is_cdm_member?(t=function(e){return n.__awaiter(_,void 0,void 0,function(){var t;return n.__generator(this,function(n){return t=this.contentManagerValidateFolderPath(e),[2,this.client.validatePathContinue(t,!1)]})})},r={nsId:e.nsId(),nsPath:e.nsPath()}):(t=_.client.validateFqPath,r={fqPath:e.displayPath(),shareAsConfidential:_.sharingInfo.shareAsConfidential()}),t(n.__assign({},r,o)).then(function(e){var t=e.metadata,n=e.inheritedMembers;_.handleGetMetadataSuccess(t);var r=_.getContentInfo();_.listMembers({contentId:r.id,url:r.url(),members:r.isFileFolder()&&n||void 0,isNonUserRelativeContext:l})}).catch(s.catchApiError(_.handleLoadingError))},this.fetchMetadataForSharedFolder=function(e){return _.client.getMetadata({contentId:e.id,actions:Object.keys(T.ALPHA_FOLDER_METADATA_PERMISSIONS)}).then(_.handleGetMetadataSuccess).catch(s.catchApiError(_.handleLoadingError))},this.handleShowMembershipSuggestionModal=function(t,r,i,s,a){new Promise(function(t,n){e(["modules/clean/teams/membership_suggestion_modal"],t,n)}).then(n.__importStar).then(function(e){return e.MembershipSuggestionModal.show({isAdmin:t,isFile:_.sharingInfo.contentInfo().isFile(),contacts:r,nsId:_.sharingInfo.contentInfo().id,accessLevel:_.sharingInfo.recipientAccess(),redirectUri:a,teamSize:i,experiments:s})})},this.handleSetConfidentialClick=function(e,t){u.Modal.showInstance(r.default.createElement(R.SetInheritedMembersUIConfidentialModal,{actionHandler:_,initialIsConfidentialFolder:e,contentInfo:_.getContentInfo(),teamName:t,onCancel:_.openShareModal,userId:_.user.id}))},this.handleInheritedMemberAccessChange=function(e,t,n,i){var s=_.getContentInfo(),a=_.getSharingInfo();u.Modal.showInstance(r.default.createElement(R.SingleInheritedUserAccessChangeModal,{actionHandler:_,member:e,teamName:t,userId:_.user.id,isSharedFolder:s.isSharedFolder(),parentFolderName:a.parentFolderName(),currentFolderName:a.name(),isUserSelf:e.memberId()===_.user.account_id,isDowngrading:n,newAccessLevel:i}))},this.handleMemberAccessChange=function(e,t){var n=e.displayName();if(t===T.MEMBER_ACTION.REMOVE||t===M.ACCESS_LEVEL.OWNER){var r=t===T.MEMBER_ACTION.REMOVE&&e.memberId()===_.user.account_id,i=_.getContentInfo().isFolder(),s=_.getContentInfo().isNestedSharedFolder(),a=e.permissions.leave_a_copy&&e.permissions.leave_a_copy.allow,o=function(n){_.changeAccess(e,t,n===!0)},l=_.openShareModal,c=_.getSharingInfo().parentFolderName(),d=_.getSharingInfo().isConfidentialFolder();r?y.showRelinquishMembershipConfirmationModal(i,s,o,l,a,d):I.showMemberAccessChangeConfirmationModal(n,t,i,s,a,o,l,d,c)}else _.changeAccess(e,t)},this.handleGetMetadataSuccess=function(e){_.dispatch(g.ShareModalActionTypes.FETCH_METADATA_SUCCESS,{metadata:e}),c.Dispatcher.dispatch({type:k.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:_.user})},this.handleLinkSettingsClick=function(){var e=function(e){_.refreshSharedWithColumnLinkData(),_.deleteLinkMetadata(e),_.openShareModal()},t=_.sharingInfo.getInitialProps().onDeleteLink||e,n=function(e){_.setSharedLinks(e),_.refreshSharedWithColumnLinkData()};i.TeamsWebActionsLogger.log("open_link_settings_modal"),_.log("OPEN_LINK_SETTINGS_MODAL"),u.Modal.showInstance(r.default.createElement(C.SharingSettingsModal,{sharingInfo:_.sharingInfo,client:_.client,currentTab:L.LINK_SETTINGS,contentId:_.getSharingInfo().contentId().toString(),fileName:_.getSharingInfo().name(),folderName:_.getSharingInfo().name(),isFolder:_.getContentInfo().isFolder(),isLoading:!1,isSubmitting:!1,linkMetadata:_.sharingInfo.linkMetadata(),getEffectivePolicyValue:function(e,t){return["",!1]},onDeleteLink:t,onDismiss:function(){return u.Modal.close()},onOptionChange:function(){},onSaveSettings:function(){},onUnshare:function(){},onUpdateLinks:n,permissions:_.getSharingInfo().permissions(),ownerTeam:_.getSharingInfo().ownerTeam(),user:_.user}))},this.handleLoadingError=function(e){e instanceof s.AppError?("not_a_member"===e.error[".tag"]||"no_access"===e.error[".tag"]?(F.sharingNotificationError(z("You don’t have permission to share this folder")),u.Modal.close()):"invalid_id"===e.error[".tag"]&&(F.sharingNotificationError(z("This folder can’t be shared")),u.Modal.close()),_.dispatch(g.ShareModalActionTypes.FETCH_METADATA_FAILURE,{reason:e.error&&e.error.bad_path&&e.error.bad_path[".tag"]})):(_.showStandardError(e),u.Modal.close())},this.handleSetConfidential=function(e,t){void 0===t&&(t=!1);var n=_.getContentInfo(),r=n.isSharedFolder()?n.sharedFolderId().toString():void 0,i=function(e){return _.handleGetMetadataSuccess(e),e},a=function(e,t,n){return _.client.setConfidentiality({contentId:e,confidential:t,keepInheritedMembers:n}).then(i)};return r?a(r,e,t):_.client.share({fqPath:n.displayPath(),confidential:e}).then(i).catch(function(n){if(n instanceof s.AppError&&n.error&&n.error.bad_path&&"already_shared"===n.error.bad_path[".tag"]){var r=b.folderMetadataApiToRecord(n.error.bad_path);_.handleGetMetadataSuccess(r);return a(_.getContentInfo().sharedFolderId().toString(),e,t)}return Promise.reject(n)})},this.openShareModal=function(){O.shouldShowMembershipSuggestionBanner()&&(W.DBModalStack.unregister(O.MembershipDiscoveryEvents.INVITE_MODAL_CLOSED,j.showShareModalCallback),W.DBModalStack.register(O.MembershipDiscoveryEvents.INVITE_MODAL_CLOSED,j.showShareModalCallback)),u.Modal.showInstance(Y(_.shareModalClass,{actionHandler:_}))},this.recipientsChange=function(e,t){return void 0===t&&(t=""),Promise.resolve({}).then(function(){if(O.isOnExpUjMagnet2018(_.sharingInfo.ownerTeam())||_.sharingInfo.expUjMagnet2018ShouldLogExposure()&&O.isLoggedExpUjMagnet2018(_.sharingInfo.ownerTeam())){var n=O.filterSuggestableUsers(_.user,e,_.sharingInfo.expUjMagnet2018LastEmails()),r=n.promise,i=n.emails,s=n.ts;r&&i&&s&&_.handleExpUjMagnet2018FetchRequest(r,i,s)}_.dispatch(g.ShareModalActionTypes.CHANGE_RECIPIENTS,{recipientTokens:e,recipientRawInput:t})})},this.redirectToPath=function(t,r){if(null!=_.setUrl&&null!=_.setPath&&_.getSharingInfo().getInitialProps().content&&_.getSharingInfo().fqPath()){var i=function(t){r&&new Promise(function(t,n){e(["modules/clean/sharing/share_modal_util"],t,n)}).then(n.__importStar).then(function(e){return(0,e.showShareModal)(_.user,t,{origin:"PARENT_FOLDER_MODAL"},_.setPath,_.setUrl)})};t!==_.getSharingInfo().fqPath()?(_.setUrl({path:t,qargs:{share:"1"}}),_.setPath({path:t})):i(_.getSharingInfo().getInitialProps().content)}else{var s=a.browse_uri_for_fq_path(_.user,t);r&&s.updateQuery({shareoptions:"1"}),G.redirect(s.toString())}},this.refreshSharedWithColumnContentData=function(){_.getContentInfo().isFolder()?c.Dispatcher.dispatch({type:d.SharedWithActionType.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{}}):c.Dispatcher.dispatch({type:d.SharedWithActionType.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[_.getContentInfo().id]}})},this.handleShareClick=function(e){return _.sharingInfo.contentInfo().pathExists()?_.sendShare(e):_.setContentNameAndSendShare(e)},this.failSnackbarWithHelpCenter=function(e,t){var n=function(){G.open_tab(t)};q.Snackbar.show(r.default.createElement(q.Snackbar,{actionButtonText:z("Learn more"),closeButtonText:z("Close"),onActionClick:n,title:e,variant:"fail",id:"sharing-notification"}))},this.shareIfFileFolder=function(e,t){if(q.Snackbar.sync(e,!0,"sharing-notification"),!_.getContentInfo().isFileFolder())return Promise.resolve({});if(_.sharingInfo.shareFolderPromise())return _.sharingInfo.shareFolderPromise();var n;n=_.sharingInfo.isNonUserRelativeContext()&&!_.user.is_cdm_member?"ns:"+_.getContentInfo().nsId()+_.getContentInfo().nsPath():_.getContentInfo().displayPath();var r=void 0;return null!=_.sharingInfo.shouldSyncThisFolder()&&(r=_.sharingInfo.shouldSyncThisFolder()?"default":"not_synced"),_.shareFolderSimple(n,_.sharingInfo.shareAsConfidential(),r,t)},this.reportShareFailure=function(e){e instanceof s.RateLimitError?_.failSnackbarWithHelpCenter(z("Couldn’t share. Folder updates in progress."),"/help/9259"):e instanceof s.AppError&&"internal_error"===e.error[".tag"]?_.failSnackbarWithHelpCenter(z("Sharing unsuccessful. This folder has too many files."),"/help/files-folders/share-with-others#foldersize"):q.Snackbar.fail(P.convertIfHTML(P.genAddMemberErrorMessage(e)),"sharing-notification")},this.showParentFolderAccessModalIfQualified=function(e,t,n){null!=n&&u.Modal.showInstance(r.default.createElement(N.ParentFolderAccessModal,{contentInfo:_.getContentInfo(),memberAccessLevelResult:n,memberDisplayName:t.displayName()||"",originalAction:e,isInContentManager:_.sharingInfo.isNonUserRelativeContext(),onClose:_.openShareModal,onParentFolderClicked:_.redirectToPath}))},this.parseParentFolderAccessError=function(e){var t=e.error;if("member_error"===e.error[".tag"]&&(t=e.error.member_error),"no_explicit_access"===t[".tag"])return b.memberAccessLevelApiToRecord(_.user.id,t);_.showStandardError(e)},this.updateLinkSettings=function(){},this.waitForAllMembersLoaded=function(){if(_.sharingInfo.areMembersFullyLoaded())return Promise.resolve({});var e=_.sharingInfo.fetchingMembersRequest();return e&&e.promise||Promise.resolve({})},this.client=t,this.user=o,this.shareModalClass=l,this.setPath=p||null,this.setUrl=h||null,this.contentManagerValidateFolderPath=m}return t.prototype.initializeShareModal=function(e,t){void 0===t&&(t={});var n=e.contentInfo;return c.Dispatcher.dispatch({type:g.ShareModalActionTypes.SHARE_MODAL_OPEN,data:{shareModalInfo:e,initialProps:t},contentIds:w.getContentIdsForContentInfo(n),user:this.user}),this.sharingInfo=A.sharingInfoStore.getSharingInfo(this.user.id,n.id),this.fetchInitialData()},t.prototype.fetchDataAndShowShareModal=function(){this.fetchInitialData(),this.openShareModal()},t.prototype.fetchInitialData=function(){var t=this.sharingInfo.contentInfo(),r=this.sharingInfo.isNonUserRelativeContext();this.beginTime=Date.now(),this.fetchPassInfo(),O.shouldShowMembershipSuggestionBanner()&&new Promise(function(t,n){e(["modules/clean/teams/membership_suggestion_banner"],t,n)}).then(n.__importStar);var i=[];return t.isFileFolder()?i.push(this.fetchMetadataForFileFolder(t)):(i.push(this.listMembers({contentId:t.id,url:t.url(),isNonUserRelativeContext:r})),t.isFile()?i.push(this.fetchMetadataForFile(t)):t.isSharedFolder()&&i.push(this.fetchMetadataForSharedFolder(t))),i.push(this.fetchMemberCounts()),i.push(this.fetchTeamPolicy()),i.push(this.fetchSharingPrefs()),this.sharingInfo.canShareLink()&&!r&&t.isMounted()&&i.push(this.fetchLinkMetadata()),i.push(this.fetchTwoLinkRedesignVariant()),i.push(this.fetchLinkSettingsEmbedStatus()),i.push(this.fetchShareModalLinkSettingsVariant()),i.push(this.fetchPlusToProTrialsVariant()),Promise.all(i)},t.prototype.fetchTwoLinkRedesignVariant=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,K.growthCheckGating(this.user,"sharing_modal_two_link_redesign")];case 1:return e=t.sent(),this.dispatch(g.ShareModalActionTypes.FETCH_TWO_LINK_REDESIGN,e),[2]}})})},t.prototype.fetchLinkSettingsEmbedStatus=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,K.growthCheckGating(this.user,"sharegrowth_link_settings_embed")];case 1:return e=t.sent(),this.dispatch(g.ShareModalActionTypes.FETCH_LINK_SETTINGS_VARIANT,e),[2]}})})},t.prototype.fetchShareModalLinkSettingsVariant=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,K.growthCheckGating(this.user,"share_modal_link_settings")];case 1:return e=t.sent(),this.dispatch(g.ShareModalActionTypes.FETCH_SHARE_MODAL_LINK_SETTINGS_VARIANT,e),[2]}})})},t.prototype.fetchPlusToProTrialsVariant=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,K.growthCheckGating(this.user,"expand_in_plus_to_pro_trials")];case 1:return e=t.sent(),this.dispatch(g.ShareModalActionTypes.FETCH_PLUS_TO_PRO_TRIALS,e),[2]}})})},t.prototype.fetchPassInfo=function(){var e=this;this.sharingInfo.shouldBlockMemberListOnPassLoad()&&setTimeout(function(){return e.dispatch(g.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD)},4e3);var t=this.getPassFileInfo(),n=t.fromBrowse,r=t.fileId;if(n&&r){this.clearCachedPassInfo();var i=_.passStore.passFetchingStatus(r);if(h.fetchingStatusIsSuccessful(i)){var s=_.passStore.getLinkAndGroupSeenStateInfo(r),a=s.groupSeenStateInfo,o=s.linkSeenStateInfo;this.groupSeenStateInfo=a,this.linkSeenStateInfo=o,this.presentAccountIds=_.passStore.presence(r)}else i===h.PASS_FETCHING_STATUS.NOT_YET_KNOWN&&m.PassHelpers.setup({user:this.user,fileData:this.getFileData(),prevFileData:null,shouldWritePresence:!1,skipSharingEndpoints:!0})}},t.prototype.getClient=function(){return this.client},t.prototype.getSharingInfo=function(){return this.sharingInfo},t.prototype.clearCachedPassInfo=function(){var e;e=[null,null,null],this.groupSeenStateInfo=e[0],this.linkSeenStateInfo=e[1],this.presentAccountIds=e[2]},t.prototype.getPassInfo=function(){var e,t=this.getContentInfo();if(t.isFolder())return{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:h.PASS_FETCHING_STATUS.ERROR};if(this.groupSeenStateInfo&&this.linkSeenStateInfo&&this.presentAccountIds)return{groupSeenStateInfo:this.groupSeenStateInfo,linkSeenStateInfo:this.linkSeenStateInfo,presentAccountIds:this.presentAccountIds,passFetchingStatus:h.PASS_FETCHING_STATUS.PASS_SUCCESS};var n=this.getPassFileInfo().fileId;if(!n)return e=[{},[],[]],this.groupSeenStateInfo=e[0],this.presentAccountIds=e[1],{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:h.PASS_FETCHING_STATUS.ERROR};var r=_.passStore.getPassPermissions(n),i=_.passStore.passFetchingStatus(n);if(!h.fetchingStatusIsComplete(i))return{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:h.PASS_FETCHING_STATUS.FETCHING};if(null==r||!r.canReadPresence)return{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:h.PASS_FETCHING_STATUS.ERROR};var s=_.passStore.getLinkAndGroupSeenStateInfo(n),a=s.linkSeenStateInfo,o=s.groupSeenStateInfo;return this.linkSeenStateInfo=a,this.groupSeenStateInfo=o,this.presentAccountIds=(_.passStore.presence(n)||[]).slice(),this.isContentInfoForFilePreview(t)&&this.presentAccountIds.indexOf(this.user.account_id)<0&&this.presentAccountIds.push(this.user.account_id),{groupSeenStateInfo:this.groupSeenStateInfo,linkSeenStateInfo:this.linkSeenStateInfo,presentAccountIds:this.presentAccountIds,passFetchingStatus:i}},t.prototype.getPassFileInfo=function(){var e,t,n=this.getContentInfo(),r=n.extras.origin&&!n.isFolder()&&["BROWSE_FILE_ACTIONS","BROWSE_FILE_FACEPILE","BROWSE_FILE_ROW"].indexOf(n.extras.origin)>=0,i=n.extras.origin&&["BROWSE_FILE_ACTIONS","BROWSE_FILE_FACEPILE","BROWSE_FILE_ROW","PREVIEW_PAGE","PREVIEW_PAGE_FACEPILE"].indexOf(n.extras.origin)>=0
;return i&&!n.isSharedFolder()?(e=n.beaconContext(),t=n.extras.fileId):(e=null,t=null),{beaconContext:e,fromBrowse:r,fileId:t}},t.prototype.getUrl=function(){var e=this.sharingInfo.linkMetadata();return this.getPassFileInfo().fromBrowse||!e?void 0:e.url},t.prototype.getFileData=function(e){var t=this.getPassFileInfo();return{file:{beacon_context:t.beaconContext,file_id:t.fileId},url:e}},t.prototype.getContentInfo=function(){return this.sharingInfo.contentInfo()},t.prototype.dispatch=function(e,t){void 0===t&&(t={}),c.Dispatcher.dispatch({type:e,data:t,contentIds:[this.getContentInfo().id],user:this.user})},t.prototype.changeMemberAccessSimple=function(e,t,n){return this.client.updateMember({contentId:e,memberId:t,accessLevel:n})},t.prototype.changeMemberAccess=function(e,t,n){var r=this,i=t.access_type;return this.dispatch(g.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST,{member:t,newAccess:n}),this.changeMemberAccessSimple(e,t.memberId(),n).then(function(e){if(e.access_level&&e.warning)return r.dispatch(g.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:e.access_level}),e}).catch(s.catchApiError(function(e){return r.dispatch(g.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:i}),r.parseParentFolderAccessError(e)}))},t.prototype.fetchLinkMetadata=function(){var e=this;return"/"!==this.getContentInfo().displayPath()?(this.dispatch(g.ShareModalActionTypes.FETCH_LINK_METADATA_REQUEST),this.client.sharedLinkInfo({fileIdOrPath:this.getContentInfo().idForLink()}).then(function(t){e.dispatch(g.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{sharedLinks:t})}).catch(function(){e.dispatch(g.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE),e.isContentInfoForPaper(e.getContentInfo())||e.sharingInfo.isNonUserRelativeContext()||(e.showStandardError(),u.Modal.close())})):Promise.resolve({})},t.prototype.fetchMemberCounts=function(){var e=this,t=this.getContentInfo();return this.dispatch(g.ShareModalActionTypes.FETCH_MEMBER_COUNTS_REQUEST),t.isSharedFolder()||t.isFolder()&&t.isInSharedFolder()?this.client.getMemberCounts({contentId:t.isSharedFolder()?t.sharedFolderId():t.nsId()}).then(function(t){e.dispatch(g.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS,{memberCounts:t})}):Promise.resolve({})},t.prototype.fetchSharingPrefs=function(){var e=this;return this.dispatch(g.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST),this.client.getSharingPrefs().then(function(t){e.dispatch(g.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS,{sharingPrefs:t})})},t.prototype.onShareModalUnmount=function(e){this.teardownPass();var t=e&&e.serializeInputData()||{};this.dispatch(g.ShareModalActionTypes.SHARE_MODAL_CLOSE,t)},t.prototype.fetchTeamPolicy=function(){var e=this;return this.dispatch(g.ShareModalActionTypes.FETCH_TEAM_POLICY_REQUEST),this.client.getCurrentAccountCached().then(function(t){e.dispatch(g.ShareModalActionTypes.FETCH_TEAM_POLICY_SUCCESS,{teamPolicy:t.team&&t.team.sharing_policies})})},t.prototype.handleExpUjMagnet2018FetchRequest=function(e,t,n){var r=this;this.dispatch(g.ShareModalActionTypes.FETCH_MAGNET2018_REQUEST,{promise:e,emails:t,ts:n}),e.then(function(t){var i=O.maybeLogExpUjMagnet2018Exposure(r.sharingInfo.expUjMagnet2018ShouldLogExposure(),t,r.user);r.dispatch(g.ShareModalActionTypes.FETCH_MAGNET2018_SUCCESS,{promise:e,ts:n,suggestableUserData:t,loggedExposure:i})}).catch(function(){r.dispatch(g.ShareModalActionTypes.FETCH_MAGNET2018_FAILURE,{ts:n})})},t.prototype.handleContentNameChange=function(e){var t="SIMPLIFIED_WIZARD_UI::CONTENT_NAME_CHANGE";this.hasLoggedSet[t]||(this.sharingExperimentsLog(t),this.hasLoggedSet[t]=!0),this.dispatch(g.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE,{name:e})},t.prototype.handleContentNameFocusChange=function(e){this.dispatch(g.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE,{focus:e})},t.prototype.handleUpdateFilePolicy=function(e,t){this.handleUpdateSharingSettings(e);var n=this.getSharingInfo().filePolicy(),r=this.getPassFileInfo(),i=r.fromBrowse,s=r.fileId;if(s)if(n.viewer_info_policy===v.ViewerInfoPolicy.disabled&&t.viewer_info_policy===v.ViewerInfoPolicy.enabled)this.clearCachedPassInfo(),p.PassActions.resetPassInfo(s),p.PassActions.fetchPassError(s),this.dispatch(g.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO);else{var a=n.audience===v.LinkAudience.members!=(t.audience===v.LinkAudience.members),o=n.viewer_info_policy===v.ViewerInfoPolicy.enabled&&t.viewer_info_policy===v.ViewerInfoPolicy.disabled;if(a||o){this.clearCachedPassInfo();var l=this.getUrl();o&&this.listMembers({contentId:s,url:l,isNonUserRelativeContext:this.sharingInfo.isNonUserRelativeContext()}),m.PassHelpers.setup({user:this.user,fileData:this.getFileData(l),prevFileData:null,shouldWritePresence:!i,skipSharingEndpoints:!0})}}},t.prototype.handleUpdateSharingSettings=function(e){this.dispatch(g.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS,{metadata:e})},t.prototype.listMembers=function(e){var t=e.contentId,n=e.url,r=e.members,i=e.isNonUserRelativeContext,s=void 0!==i&&i;return S.SharingActions.listMembers({user:this.user,contentId:t,isFolder:this.sharingInfo.isFolder(),url:n,members:r,client:this.client,isNonUserRelativeContext:s})},t.prototype.addMembers=function(e,t,n,r){void 0===n&&(n=!1);var i=e.map(function(e){return{member:b.createUnionScalar(e.contactType(),e.contactId()),access_level:b.accessLevelConstToApi(e.access_type)}});return this.client.addMembersWithAccessLevel({contentId:t,members:i,customMessage:r,quiet:n})},t.prototype.isContentInfoForFilePreview=function(e){return("PREVIEW_PAGE"===e.extras.origin||"PREVIEW_PAGE_FACEPILE"===e.extras.origin)&&!e.isFolder()},t.prototype.isContentInfoForPaper=function(e){return e.extras&&"PAPER_INTEGRATION"===e.extras.origin},t.prototype.log=function(e,t){void 0===t&&(t={}),P.logTiburonEvent(this.getContentInfo(),this.user.id,e,t)},t.prototype.logIfHaventBefore=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0),this.hasLoggedSet[e]||(this.hasLoggedSet[e]=!0,n&&(t.timing=Date.now()-this.beginTime),this.log(e,t))},t.prototype.onClickX=function(e){e&&e.finishLogging(!0),u.Modal.close()},t.prototype.redirectToBrowseUrl=function(e){if(null!=this.setUrl)this.setUrl({path:e});else{var t=a.browse_uri_for_fq_path(this.user,e);G.redirect(t.toString())}},t.prototype.redirectToUpgrade=function(){G.redirect("/upgrade?oqa=spw")},t.prototype.refreshSharedWithColumnLinkData=function(){c.Dispatcher.dispatch({type:d.SharedWithActionType.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.getContentInfo().displayPath()]}})},t.prototype.relinquishMembershipSimple=function(e,t){var n=this;return this.client.relinquishMembership({contentId:e,leaveACopy:t}).then(function(){u.Modal.close(),n.redirectToBrowseUrl("/")})},t.prototype.relinquishMembership=function(e,t){var n=this.getContentInfo();return this.relinquishMembershipSimple(e,t).then(function(){n.isFolder()?F.sharingNotificationSuccess(z("Folder access removed.")):F.sharingNotificationSuccess(z("File access removed."))})},t.prototype.removeMemberSimple=function(e,t,n){return this.client.removeMember({contentId:e,memberId:t,leaveACopy:n})},t.prototype.removeMember=function(e,t,n,r){var i=this;return this.dispatch(g.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:t}),this.removeMemberSimple(e,t.memberId(),n).then(function(e){return i.fetchInitialData().then(function(){if(e&&null!=e.access_level&&null!=e.warning)return i.dispatch(g.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS,{member:t,access:e.access_level}),e;r?F.sharingNotificationSuccess(z("Folder access removed.")):F.sharingNotificationSuccess(z("File access removed.")),i.dispatch(g.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS,{member:t})})}).catch(s.catchApiError(function(e){return i.dispatch(g.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:t}),i.parseParentFolderAccessError(e)}))},t.prototype.setContentNameAndSendShare=function(e){var t=this,n=this.sharingInfo.contentNameInputValue(),r=l.parent_dir(this.sharingInfo.fqPath()),i=P.getNewFolderPathFromContentName(n,r),s=!this.sharingInfo.isNonUserRelativeContext(),o=a.browse_uri_for_fq_path(this.user,i);o.updateQuery("show_share_success_snackbar","1");var c,d;return O.isLoggedExpUjMagnet2018(this.sharingInfo.ownerTeam())?(c=!1,s&&(d=a.browse_uri_for_fq_path(this.user,i))):c=s,new Promise(function(i,a){new E.SharingApi(t.user).validate_new_sf_path(n,P.getNewFolderPathFromContentName(n,r),function(){t.dispatch(g.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS,{contentName:n}),t.sendShare(e,{keepModalOpen:s,suppressSuccessSnackbar:c,redirectUri:d}).then(function(){t.sharingInfo.shareAsConfidential()&&x.WebUserActionLog.log(t.user.id,U.WebUserActionLogEvent.CONF_BY_CREATE_CONFIDENTIAL_FOLDER,{ns_id:t.sharingInfo.contentId(),who_has_access:U.WebUserActionLogExtraValue.SPECIFIC_PEOPLE,location:t.sharingInfo.isNonUserRelativeContext()?U.WebUserActionLogExtraValue.CONTENT_MANAGER:U.WebUserActionLogExtraValue.BROWSE}),s&&!O.isLoggedExpUjMagnet2018(t.sharingInfo.ownerTeam())&&G.redirect(o.toString()),i()})},function(e){t.sharingExperimentsLog("SIMPLIFIED_WIZARD_UI::INVALID_CONTENT_NAME");var n=B.default.extract_errors(e.responseText);t.dispatch(g.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR,{errorMsg:n.folder_name&&n.folder_name.message_text}),a()})})},t.prototype.setSharedLinks=function(e){this.dispatch(g.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{sharedLinks:e})},t.prototype.deleteLinkMetadata=function(e){this.dispatch(g.ShareModalActionTypes.DELETE_LINK_METADATA_SUCCESS,{deletedLink:e})},t.prototype.sendShare=function(e,t){var n=this;void 0===t&&(t={keepModalOpen:!1,suppressSuccessSnackbar:!1,redirectUri:void 0}),this.log("CLICK_TIB_SEND_BUTTON");var i,a=Date.now(),l=this.isNewlySharedContent();return this.recipientsChange(e.getContacts()).then(function(){return n.sharingInfo.contactsError().level===P.ContactsErrorLevel.Error?Promise.reject({}):(n.dispatch(g.ShareModalActionTypes.SEND_SHARE_REQUEST),i=b.contactsToMembers(n.sharingInfo.recipientTokens()),n.shareIfFileFolder(f.reactFormat(z("Sharing <st>%(folder_name)s</st>..."),{st:r.default.createElement("strong",null),folder_name:o.Emstring.em_snippet(n.sharingInfo.name(),T.SNIPPET_SIZES.FILENAME)})))}).then(function(){return n.client.addMembers({accessLevel:n.sharingInfo.recipientAccess(),contentId:n.sharingInfo.contentInfo().id,customMessage:n.sharingInfo.recipientMessage(),members:i})}).catch(s.catchApiError(function(e){return n.dispatch(g.ShareModalActionTypes.SEND_SHARE_FAILURE),n.reportShareFailure(e),n.log("SHARE_MODAL_SEND_FAIL",{timing:Date.now()-a,num_recipients:i.length}),Promise.reject({})})).then(function(){n.dispatch(g.ShareModalActionTypes.SEND_SHARE_SUCCESS),t.suppressSuccessSnackbar||F.showInBandShareSuccessSnackbar(n.sharingInfo.name()),n.log("SHARE_MODAL_SEND_SUCCESS",{timing:Date.now()-a,num_recipients:i.length}),n.sharingInfo.getInitialProps().onSuccessSharing&&n.sharingInfo.getInitialProps().onSuccessSharing(),e&&e.finishLogging(!1),n.refreshSharedWithColumnContentData(),H.SHOW_CREATE_TEAM_MODAL_AFTER_SHARING&&l&&i.length>=2?u.Modal.showInstance(r.default.createElement(D.CreateTeamPromptModal,{invitedMembers:n.sharingInfo.recipientTokens().filter(function(e){return e.email!==n.user.email})})):(O.showExpUjMagnet2018PostShareIfQualified(n.sharingInfo.ownerTeam(),n.handleShowMembershipSuggestionModal,n.sharingInfo.expUjMagnet2018SuggestableUserDataPromise(),n.sharingInfo.expUjMagnet2018SuggestableUserData(),t.redirectUri),t.keepModalOpen||u.Modal.close())})},t.prototype.isNewlySharedContent=function(){var e=this.getContentInfo();return e.isFileFolder()||e.isFile()&&!this.sharingInfo.hasNonOwnerMembers()},t.prototype.shareFolderSimple=function(e,t,n,r){var i=this;void 0===t&&(t=!1);var a=function(e){return i.dispatch(g.ShareModalActionTypes.SHARE_FOLDER_SUCCESS,{metadata:e}),c.Dispatcher.dispatch({type:k.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:i.user}),e},o={fqPath:e,confidential:t,syncSetting:n,folderPolicy:r},l=this.client.share(o);return this.dispatch(g.ShareModalActionTypes.SHARE_FOLDER_REQUEST,{promise:l}),l.then(a).catch(function(e){if(e instanceof s.AppError&&e.error&&e.error.bad_path&&"already_shared"===e.error.bad_path[".tag"]){return a(b.folderMetadataApiToRecord(e.error.bad_path))}return i.dispatch(g.ShareModalActionTypes.SHARE_FOLDER_FAILURE),Promise.reject(e)})},t.prototype.sharingExperimentsLog=function(e,t){void 0===t&&(t={});var n=this.getContentInfo().extras.modalSessionId;t.modalSessionId=t.modalSessionId||n,i.SharingExperimentsLogger.log(this.user.id,e,t)},t.prototype.teardownPass=function(){this.clearCachedPassInfo(),this.getPassFileInfo().fromBrowse&&m.PassHelpers.teardown({user:this.user,fileData:this.getFileData(),async:!0,shouldWritePresence:!1})},t.prototype.showStandardError=function(e){var t=e&&e.message;F.sharingNotificationError(t||z("There was a problem completing this request."))},t})();t.ShareModalActionHandler=Q}),define("modules/clean/sharing/actions/sharing_actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/pass/action_timestamps","modules/clean/react/pass/constants","modules/clean/sharing/action_types","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/core/exception"],function(e,t,n,r,i,s,a,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingActions={loadFileMetadataBatch:function(e,t){return new a.FileShareApiClient({userId:e.id}).getMetadataBatchAlpha({contentIds:t,actions:Object.keys(o.ALPHA_FILE_METADATA_PERMISSIONS)}).then(function(t){return n.Dispatcher.dispatch({type:s.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS,user:e,data:t})})},loadFileMetadata:function(e){var t=e.user,r=e.contentId,i=e.sourceUrl,d=e.client,u=c.sharingInfoStore.getSharingInfo(t.id,r);if(u&&u.fetchingMetadataPromise())return u.fetchingMetadataPromise();d=d||new a.FileShareApiClient({userId:t.id});var p=d.getMetadataAlpha({contentId:r,actions:Object.keys(o.ALPHA_FILE_METADATA_PERMISSIONS),sourceURL:i}).then(function(e){n.Dispatcher.dispatch({type:s.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS,user:t,data:[e]}),n.Dispatcher.dispatch({type:l.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:t})});return n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_METADATA_REQUEST,contentIds:[r],data:{promise:p},user:t}),p},listMembers:function(e){var t=e.user,o=e.contentId,l=e.isFolder,u=e.limit,p=e.url,h=e.members,m=e.client,_=e.previewSessionId,f=void 0===_?null:_,g=e.includeSeenState,S=void 0===g||g,E=e.isNonUserRelativeContext,v=void 0!==E&&E;d.assert(!u||u<=100,"listMembers not implemented for limit > 100");var b=u||9999999,I=c.sharingInfoStore.getSharingInfo(t.id,o);if(I){var y=I.fetchingMembersRequest();if(y&&b<=y.limitNonNull)return y.promise;if(I.hasDisplayableMembers()&&b<I.members().getMemberCount())return Promise.resolve({})}var C=Math.random().toString(),M=!l;m||(m=l?new a.FolderShareApiClient({userId:t.id,isNonUserRelativeContext:v}):new a.FileShareApiClient({userId:t.id,isNonUserRelativeContext:v}));var T,N=function(e){return e?(n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_REQUEST,contentIds:[o],user:t}),m.listMembersContinue({cursor:e,url:p,isAlpha:M}).then(function(e){n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS,contentIds:[o],data:{members:e,requestId:C},user:t}),N(e.cursor)})):Promise.resolve({})};return r.ActionTimestampsTracker.record(i.LoggingActions.LIST_MEMBERS_BEGIN,f),T=h?Promise.resolve(h):m.listMembers({contentId:o,url:p,limit:u,isAlpha:M,includeSeenState:S}),T=T.then(function(e){r.ActionTimestampsTracker.record(i.LoggingActions.LIST_MEMBERS_RECEIVE,f),n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_SUCCESS,contentIds:[o],data:{members:e,requestId:C},user:t}),u||N(e.cursor)}),n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_REQUEST,contentIds:[o],data:{limitNonNull:b,requestId:C,promise:T},user:t}),T},fetchFileMemberCount:function(e){var t=e.user,o=e.contentId,l=e.limit,c=e.url,d=e.client,u=e.countGroupsAsMembers,p=void 0!==u&&u,h=e.previewSessionId,m=void 0===h?null:h,_=e.runViewerInfoChecks,f=void 0!==_&&_;d=d||new a.FileShareApiClient({userId:t.id}),r.ActionTimestampsTracker.record(i.LoggingActions.MEMBER_COUNTS_BEGIN,m);var g=d.getMemberCounts({contentId:o,limit:l,url:c,countGroupsAsMembers:p,runViewerInfoChecks:f});return n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_REQUEST,contentIds:[o],user:t}),g.then(function(e){r.ActionTimestampsTracker.record(i.LoggingActions.MEMBER_COUNTS_RECEIVE,m),n.Dispatcher.dispatch({type:s.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_SUCCESS,contentIds:[o],data:e,user:t})})}}}),define("modules/clean/sharing/api",["require","exports","tslib","jquery","modules/clean/ajax"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);var s=(function(){function e(e){this.user=e}return e.prototype.get_sync_vars_for_ns_id=function(e,t,n){var r={ns_id:e,sub_path:t};this._make_request("/sharing/get_sync_vars_for_ns_id",r,n,null,!0)},e.prototype.validate_new_sf_path=function(e,t,n,r){var i={share_type:"new",folder_name:e,path:t};this._make_request("/share_ajax/validate_folder",i,n,r,!0)},e.prototype.validate_shareable_existing_sf_path=function(e,t,n){var r={share_type:"shareable_existing",path:e};this._make_request("/share_ajax/validate_folder",r,t,n,!0)},e.prototype._make_request=function(t,n,s,a,o,l){void 0===o&&(o=!1),void 0===l&&(l=!0);var c={url:t,data:n,success:function(i,a,o){s(o),r.default(document).trigger(e.REQUEST_SUCCEEDED_EVENT,{request_url:t,ns_id:n.ns_id||null})},error:function(e){a&&a(e)}};l&&(c.subject_user=this.user.id),o?i.FormWebRequest(c):i.WebRequest(c)},e.REQUEST_SUCCEEDED_EVENT="db:sharing_api:request_succeeded",e})();t.SharingApi=s}),define("modules/clean/sharing/confirmation_modals/confirm_recursive_policy_change_modal",["require","exports","tslib","external/react","external/purify","modules/clean/react/modal","modules/core/i18n","spectrum/modal"],function(e,t,n,r,i,s,a,o){"use strict";function l(e){var t=e.isTeamSharedFolder?i.sanitize(c("Your changes will be applied to this team folder and any folders inside it.")):i.sanitize(c("Your changes will be applied to this folder and any folders inside it."));s.Modal.showInstance(r.createElement(o.UtilityModal,{ariaLabel:c("Save settings?"),title:c("Save settings?"),overlayClickClose:!0,primaryAction:c("Save settings"),secondaryAction:c("Cancel"),onPrimaryAction:e.onConfirm,onSecondaryAction:e.onCancel,open:!0,onRequestClose:e.onCancel},t))}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importStar(i),a=n.__importStar(a);var c=a.i18n_default_project("sharing")._;t.confirmRecursivePolicyChange=l}),define("modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal",["require","exports","tslib","react","modules/clean/em_string","modules/clean/react_format","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/clean/react/modal","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),c=n.__importStar(c);var d=c.i18n_default_project("sharing")._,u=function(e,t,n,c,u,p,h,m,_){void 0===e&&(e=""),void 0===u&&(u=!1),void 0===m&&(m=!1);var f,g,S,E=i.Emstring.em_snippet(e,40),v=null;if(t===o.MEMBER_ACTION.REMOVE){if(S=d("Remove %(name)s?").format({name:E}),n){f=c&&!m?_?s.reactFormat(d("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access <strong>%(parentname)s</strong> will still be able to access this folder."),{strong:r.default.createElement("strong",null),name:E,parentname:_}):s.reactFormat(d("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access the parent folder will still be able to access this folder."),{strong:r.default.createElement("strong",null),name:E}):s.reactFormat(d("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to this shared folder."),{strong:r.default.createElement("strong",null),name:E}),u&&(v=d("Let %(name)s keep a copy of this shared folder").format({name:E}))}else f=s.reactFormat(d("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to this file."),{strong:r.default.createElement("strong",null),name:E});g=d("Remove")}else S=d("Make %(name)s the owner of this folder?").format({name:E}),f=s.reactFormat(d("Only <strong>%(name)s</strong> will be able to unshare this folder or change folder settings."),{strong:r.default.createElement("strong",null),name:E}),g=d("Make owner");return l.Modal.showInstance(r.default.createElement(a.ConfirmWithOptionModal,{autoClose:!1,confirmText:g,cancelText:d("Cancel"),onConfirm:p,onCancel:h,optionLabel:v,showOption:null!=v,title:S},f))};t.showMemberAccessChangeConfirmationModal=u}),define("modules/clean/sharing/content_info",["require","exports","tslib","external/immutable"],function(e,t,n,r){"use strict";function i(e){var t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.createFromParams=function(e){var n=new a(e);return new t({extras:n,id:i(n)})},t.prototype.setNsId=function(e){var t=this.setIn(["extras","targetNsId"],e);return t.set("id",i(t.extras))},t.prototype.setFQPath=function(e){var t=this.setIn(["extras","fqPath"],e);return t.set("id",i(t.extras))},t.prototype.isFolder=function(){return this.extras.isFolder},t.prototype.isFile=function(){return!this.isFolder()},t.prototype.isFileFolder=function(){return this.isFolder()&&!this.isSharedFolder()},t.prototype.isSharedFolder=function(){return Boolean(this.extras.targetNsId)},t.prototype.isTeamSharedFolder=function(){return this.extras.isTeamSharedFolder},t.prototype.isInSharedFolder=function(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)},t.prototype.isNestedSharedFolder=function(){return this.isInSharedFolder()&&this.isSharedFolder()},t.prototype.isMounted=function(){return!this.extras.url},t.prototype.url=function(){return this.extras.url},t.prototype.pathExists=function(){return Boolean(this.extras.exists)},t.prototype.name=function(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()},t.prototype.idForLink=function(){var e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e},t.prototype.sharedFolderId=function(){var e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e},t.prototype.displayPath=function(){return this.extras.fqPath},t.prototype.fileId=function(){return this.extras.fileId},t.prototype.filename=function(){return this.extras.filename},t.prototype.nsId=function(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId},t.prototype.nsPath=function(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath},t.prototype.sjid=function(){return this.extras.sjid},t.prototype.teamGroupInfo=function(){return this.extras&&this.extras.teamGroupInfo},t.prototype.beaconContext=function(){return this.extras&&this.extras.beaconContext},t})(r.Record({extras:null,id:null},"ContentInfo"));t.ContentInfo=s;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(r.Record({beaconContext:null,exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras"));t.ContentInfoExtras=a}),define("modules/clean/sharing/delete_link_modal",["require","exports","tslib","modules/clean/ajax","react","modules/clean/em_string","modules/clean/react/modal","modules/clean/sharing/constants","modules/clean/sharing/ui_notifications_util","spectrum/modal","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importDefault(i),o=n.__importStar(o),d=n.__importStar(d);var u=d.i18n_default_project("sharing")._,p=function(e){var t=e.client,n=e.url,r=e.contentName,d=e.onDeleteLink,p=e.onCancel;r=s.Emstring.em_snippet(r,o.SNIPPET_SIZES.FILENAME);var h=function(){return t.revokeSharedLink({url:n}).then(function(){var e=u("Deleted link to “%(name)s”").format({name:r});l.sharingNotificationSuccess(e),a.Modal.close(),d&&d()})},m=u("Delete link to “%(name)s”?").format({name:r}),_=function(){a.Modal.close(),p&&p()};a.Modal.showInstance(i.default.createElement(c.UtilityModal,{ariaLabel:m,title:m,overlayClickClose:!0,primaryAction:u("Delete"),secondaryAction:u("Cancel"),onPrimaryAction:h,onSecondaryAction:_,open:!0,onRequestClose:_,overlayClassName:"file-viewer-modal-overlay"},u("This link will no longer work for anyone who has it.")))};t.deleteLinkWithConfirm=p;var h=function(e){var t=e.client,n=e.tkey,i=e.contentName,c=e.onDeleteLink,d=e.onCancel;if(i=s.Emstring.em_snippet(i,o.SNIPPET_SIZES.FILENAME),null===n)return void a.Modal.close();var p=function(){return r.WebRequest({url:"/sm/disable/"+n,type:"POST",data:{tkey:n},subject_user:t.userId,success:function(){var e=u("Deleted link to “%(name)s”").format({name:i});l.sharingNotificationSuccess(e),a.Modal.close(),c&&c()}})};return a.SimpleModal.show({autoclose:!1,body_html:u("This link will no longer work for anyone who has it."),cancel_completed_callback:d,cancel_text:u("Cancel"),confirm_callback:p,confirm_text:u("Delete"),title_text:u("Delete link to “%(name)s”?").format({name:i}),style:"default-maestro"})};t.deleteLinkWithConfirmLegacy=h}),define("modules/clean/sharing/file_settings_modal",["require","exports","tslib","react","external/lodash","modules/clean/api_v2/error","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/util","modules/clean/react_format","modules/clean/sharing/api/client","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/constants","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_notifications_util","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),S=n.__importStar(S);var E=S.i18n_default_project("sharing")._,v=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleAcceptClick=function(){var e=n.getPolicyDiff();e?d.setStatePromise(n,{isSubmitting:!0}).then(function(){return n.getClient().updatePolicy({contentId:n.props.contentId,newPolicy:e,actions:Object.keys(m.ALPHA_FILE_METADATA_PERMISSIONS)})}).catch(s.catchApiError(function(){n.setState({isSubmitting:!1}),Promise.reject({})})).then(function(e){g.sharingNotificationSuccess(E("File settings updated")),n.props.onPolicySet&&n.props.onPolicySet(e)}):n.props.onPolicySet&&n.props.onPolicySet(void 0)},n.handleDismissClick=function(){n.props.onCancel&&n.props.onCancel()},n.handlePolicyUpdate=function(e,t){n.setState({desiredPolicy:n.state.desiredPolicy.set(e,t)})},n.handleUpdateLinks=function(e){n.props.onUpdateLinks&&n.props.onUpdateLinks(e)},n.handleDeleteLink=function(e){n.props.onDeleteLink&&n.props.onDeleteLink(e)},n.getPolicyDiff=function(){var e={};return n.state.desiredPolicy.keySeq().toArray().map(function(t){var r=n.state.desiredPolicy.get(t),s=n.props.initialPolicy.get(t);("object"==typeof r?i.isEqual(r,s):r===s)||(e[t]=n.state.desiredPolicy.get(t))}),e},n.handleCancelUnshareFile=function(){return l.Modal.close()},n.handleUnshareFile=function(){var e=function(){return c.Snackbar.sync(u.reactFormat(E("Unsharing <st>%(file_name)s</st>..."),{st:r.default.createElement("strong",null),file_name:n.props.fileName}),!0),n.getClient().unshare({contentId:n.props.contentId}).then(function(){n.refreshSharedMemberData(),c.Snackbar.complete(u.reactFormat(E("Unshared <st>%(file_name)s</st>."),{st:r.default.createElement("strong",null),file_name:n.props.fileName})),l.Modal.close()})};h.confirmResetAccess({allowLeaveACopy:!1,contentName:n.props.fileName,isFolder:!1,isNestedSharedFolder:!1,onConfirm:e,onCancel:n.handleCancelUnshareFile})},n.refreshSharedMemberData=function(){a.Dispatcher.dispatch({type:o.SharedWithActionType.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[n.props.contentId]}})},n.state={isSubmitting:!1,desiredPolicy:t.initialPolicy},n}return n.__extends(t,e),t.prototype.render=function(){return this.openSharingSettingsModal()},t.prototype.getClient=function(){return new p.FileShareApiClient({userId:this.props.user.id})},t.prototype.wrapCanChangePolicy=function(e){var t=this.props.canChangeOptions;return f.isCommonSharingSettingsPolicy(e)&&(t=f.canChangePolicy(e,this.props.initialPolicy,this.state.desiredPolicy,this.props.linkMetadata,this.props.permissions)),t},t.prototype.openSharingSettingsModal=function(){var e=this,t=function(t,n){return[e.state.desiredPolicy.get(t),e.wrapCanChangePolicy(t)]};return r.default.createElement(_.SharingSettingsModal,{sharingInfo:this.props.sharingInfo,client:this.getClient(),contentId:this.props.contentId,currentPolicy:this.props.initialPolicy,currentTab:this.props.currentTab,fileName:this.props.fileName,folderName:this.props.fileName,getEffectivePolicyValue:t,isFolder:!1,isLoading:!1,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onDismiss:this.handleDismissClick,onOptionChange:this.handlePolicyUpdate,onUpdateLinks:this.handleUpdateLinks,onDeleteLink:this.handleDeleteLink,onSaveSettings:this.handleAcceptClick,onUnshare:this.handleUnshareFile,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,policyUpdate:this.getPolicyDiff(),user:this.props.user})},t.displayName="FileSettingsModal",t})(r.default.Component);t.FileSettingsModal=v}),define("modules/clean/sharing/folder_settings_modal",["require","exports","tslib","react","external/react-dom-factories","external/lodash","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/util","modules/clean/react_format","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/confirmation_modals/confirm_recursive_policy_change_modal","modules/clean/sharing/constants","modules/clean/sharing/share_page/action_types","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_notifications_util","modules/core/browser","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I,y){"use strict";function C(e,t){return void 0!==e&&null!==e?t(e):void 0}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),s=n.__importStar(s),I=n.__importStar(I),y=n.__importStar(y);var M=r.default.createElement,T=y.i18n_default_project("sharing")._,N={shared_folder_member_policy:"team"},k={shared_folder_member_policy:"team"},A={member_policy:"shared_folder_member_policy"},w=(function(e){function t(t){var n=e.call(this,t)||this;return n._isMounted=!1,n._handleUpdateLinks=function(e){return n.props.onUpdateLinks&&n.props.onUpdateLinks(e)},
n._handleDeleteLink=function(){if(n.props.onDeleteLink&&n.props.linkMetadata)return n.props.onDeleteLink(n.props.linkMetadata)},n._handleSaveSettings=function(){var e=n._getPolicyUpdate();if(null!=e){var t=function(){var t=n.props.onPolicySet;return(n._isMounted?u.setStatePromise(n,{isSubmitting:!0}):Promise.resolve()).then(function(){var t=function(t){return d.Snackbar.complete(T("Folder settings updated."),"folder-settings-notification"),Promise.resolve({policyUpdate:e,sharedFolderMetadata:t})},r=function(e){return n.props.actionHandler&&n.props.actionHandler.reportShareFailure(e)};if(null!=n.props.folderId){return(0,n._getClient().updatePolicyAlpha)({contentId:n.props.folderId,newPolicy:e,url:null!=n.props.linkMetadata?n.props.linkMetadata.url:void 0}).then(t)}return e=new m.FolderPolicy(e),n.props.actionHandler&&n.props.actionHandler.shareIfFileFolder(T("Updating folder settings..."),e).then(t).catch(r)}).then(function(e){var n=e.policyUpdate,r=e.sharedFolderMetadata;return"function"==typeof t?t(n,r):void 0}).catch(a.catchApiError(function(e){if(n._isMounted)return n.setState({isSubmitting:!1})}))};if(!n.state.isPolicyChangeRecursive)return t();var r=n.props;f.confirmRecursivePolicyChange({isTeamSharedFolder:n.state.isTeamSharedFolder,onConfirm:t,onCancel:function(){return n.handleCancel(r)}})}},n._handleDismiss=function(){return"function"==typeof n.props.onCancel?n.props.onCancel():void 0},n.handleCancel=function(e){return c.Modal.close()},n._handleUnshareFolder=function(){if(null!=n.props.folderId&&C(null!=n.state.permissions?n.state.permissions.unshare:void 0,function(e){return e.allow})){var e=function(e){return d.Snackbar.sync(p.reactFormat(T("Unsharing <st>%(folder_name)s</st>..."),{st:i.strong(),folder_name:o.Emstring.em_snippet(n.props.folderName,g.SNIPPET_SIZES.FILENAME)}),!0,"folder-settings-notification"),n._getClient().unshare({contentId:n.props.folderId,leaveACopy:e}).then(function(){return d.Snackbar.complete(p.reactFormat(T("Unshared <st>%(folder_name)s</st>."),{st:i.strong(),folder_name:o.Emstring.em_snippet(n.props.folderName,g.SNIPPET_SIZES.FILENAME)}),"folder-settings-notification"),null!=n.props.actionHandler&&n.props.actionHandler.refreshSharedWithColumnContentData(),c.Modal.close(),l.Dispatcher.dispatch({type:S.SharePageActionTypes.UNSHARE_FOLDER_SUCCESS,metadata:n.state.metadata,user:n.props.user})}).catch(function(e){return"too_many_files"===e.error[".tag"]?n._tooManyFilesSnackbar():b.sharingNotificationError(e.message),l.Dispatcher.dispatch({type:S.SharePageActionTypes.UNSHARE_FOLDER_ERROR,metadata:n.state.metadata,user:n.props.user})})};return _.confirmResetAccess({allowLeaveACopy:C(null!=n.state.permissions?n.state.permissions.leave_a_copy:void 0,function(e){return e.allow}),contentName:n.state.metadata.name,isFolder:!0,isNestedSharedFolder:!!n.state.hasParentSharedFolder,onCancel:function(){n.handleCancel(n.props)},onConfirm:e})}},n._getPolicyUpdate=function(){if(null==n.state.newPolicy)return null;var e={};return n.state.newPolicy.forEach(function(t,r){var i=n._getEffectivePolicyValue(r),a=i[0];i[1]&&(("object"==typeof t?s.isEqual(t,a):t===a)||(e[r]=t))}),e},n._handleOptionChange=function(e,t){if(C(n._getPolicyUpdate(),function(t){return t[e]})!==t)return"function"==typeof n._handlePolicyUpdate?n._handlePolicyUpdate(e,t):void 0},n._getEffectivePolicyValue=function(e,t){void 0===t&&(t=void 0);var r,i=A[e];null!=i&&null!=n.props.teamPolicy&&(r=n.props.teamPolicy.get(i));var s=null!=(null!=t?t[e]:void 0)?null!=t?t[e]:void 0:n.state.currentPolicy.get(e),a=null!=n.state.permissions.change_options?n.state.permissions.change_options.allow:void 0;return null!=r&&N[i]===r&&(a=!1,s=k[i]),v.isCommonSharingSettingsPolicy(e)&&(a=v.canChangePolicy(e,n.state.currentPolicy,n.state.newPolicy,n.props.linkMetadata,n.state.permissions,n.props.showContentManagerBridge)),n.props.showContentManagerBridge&&(a=!1),[s,a]},n.state={currentPolicy:n.props.initialPolicy,hasParentSharedFolder:n.props.initialHasParentSharedFolder,isLoading:!(null!=n.props.initialPolicy&&null!=n.props.initialPermissions),isPolicyChangeRecursive:n._hasRecursivePolicyChanges(n.props.initialIsTeamSharedFolder,n.props.initialHasParentSharedFolder),isSubmitting:!1,isTeamSharedFolder:n.props.initialIsTeamSharedFolder,metadata:n.props.initialMetadata,teamPolicy:n.props.teamPolicy,newPolicy:n.props.initialPolicy,ownerTeam:n.props.initialOwnerTeam,permissions:n.props.initialPermissions},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){if(this._isMounted=!0,this.state.isLoading)return this._fetchInitialState()},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.render=function(){var e={altAction:this.props.altAction,contentId:this.props.folderId,currentPolicy:this.state.currentPolicy,folderId:this.props.folderId,folderName:this.props.folderName,folderPath:this.props.folderPath,getEffectivePolicyValue:this._getEffectivePolicyValue,hasParentSharedFolder:this.state.hasParentSharedFolder,isConfidentialFolder:this.props.isConfidentialFolder,isFolder:void 0===this.props.isFolder||this.props.isFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isLimitedTeam:this.props.isLimitedTeam,isLoading:this.state.isLoading,isSharedFolder:this.props.isSharedFolder,isSubmitting:this.state.isSubmitting,isTeamSharedFolder:this.state.isTeamSharedFolder,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onDismiss:this._handleDismiss,onOptionChange:this._handleOptionChange,onSaveSettings:this._handleSaveSettings,onUnshare:this._handleUnshareFolder,ownerTeam:this.state.ownerTeam,permissions:this.state.permissions,showContentManagerBridge:this.props.showContentManagerBridge,shouldHideHeader:this.state.shouldHideHeader,teamPolicy:this.state.teamPolicy,policyUpdate:this._getPolicyUpdate(),user:this.props.user},t=n.__assign({},e,{sharingInfo:this.props.sharingInfo,client:this._getClient(),currentTab:this.props.currentTab,onUpdateLinks:this._handleUpdateLinks,onDeleteLink:this._handleDeleteLink});return M(E.SharingSettingsModal,t)},t.prototype._getClient=function(){return new h.FolderShareApiClient({userId:this.props.user.id,isNonUserRelativeContext:this.props.isInContentManager})},t.prototype._fetchFolderMetadata=function(){var e=[{".tag":"change_options"},{".tag":"unshare"}];return null!=this.props.folderId?this._getClient().getMetadata({contentId:this.props.folderId,actions:e}):this._getClient().validateFqPath({fqPath:this.props.folderPath,actions:e}).then(function(e){return e})},t.prototype._fetchInitialState=function(){var e=this;return this._fetchFolderMetadata().then(function(t){if(e._isMounted){var n=t.policy,r={hasParentSharedFolder:null!=t.parent_shared_folder_id,isTeamSharedFolder:t.is_team_folder,shouldHideHeader:"folder_is_limited_team_folder"===C(null!=t.permissions?t.permissions.change_options:void 0,function(e){return e.reason}),isLoading:!1,permissions:t.permissions,newPolicy:n,ownerTeam:t.owner_team,metadata:t};return null!=e.props.folderId&&(r.currentPolicy=n),r.isPolicyChangeRecursive=e._hasRecursivePolicyChanges(r.isTeamSharedFolder,r.hasParentSharedFolder),u.setStatePromise(e,r)}}).catch(a.catchApiError(function(){return c.Modal.close()}))},t.prototype._hasRecursivePolicyChanges=function(e,t){return!(!e&&!t)},t.prototype._handlePolicyUpdate=function(e,t){return this.setState({newPolicy:this.state.newPolicy.set(e,t)})},t.prototype._tooManyFilesSnackbar=function(){var e=function(){return I.open_tab("/help/files-folders/unshare-folder#foldersize")};return d.Snackbar.show(M(d.Snackbar,{actionButtonText:T("Learn more"),closeButtonText:T("Close"),onActionClick:e,title:T("Unsharing unsuccessful. This folder has too many files."),variant:"fail",id:"folder-settings-notification"}))},t.displayName="SharedFolderSettingsModal",t})(r.default.Component);t.SharedFolderSettingsModal=w}),define("modules/clean/sharing/member_constructors",["require","exports","modules/clean/sharing/api/types/metadata","modules/clean/react/pass/utils","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,r,i,s){"use strict";function a(){var e=new n.PermissionSetting({allow:!1});return new n.MemberPermissions({make_editor:e,make_viewer:e,make_owner:e,remove:e})}function o(e){var t=r.AnonymousViewerUtils.getAnonymousUserIds(e),i=c("Guest");return t.map(function(e){return new n.UserMembershipInfo({access_type:"reader",account:new n.BasicAccount({account_id:e,display_name:i,familiar_name:i,given_name:i,surname:""}),account_id:e,initials:r.AnonymousViewerUtils.getAnonymousViewerInitials(i),is_inherited:!1,permissions:a(),same_team:!1,time_last_seen:null})})}function l(e){return e?e.map(function(e){var t=e.seen_state_user,r=t.user_id,i=t.display_name,o=t.email,l=t.photo_circle_url,c=e.when_last_seen;return new n.UserMembershipInfo({access_type:"reader",account:new n.BasicAccount({account_id:r,display_name:i,email:o,email_verified:!0,familiar_name:"",given_name:"",profile_photo_url:l,surname:""}),account_id:r,initials:s.getInitials(i),is_inherited:!1,permissions:a(),same_team:!0,time_last_seen:c?new Date(1e3*c):null})}):[]}Object.defineProperty(t,"__esModule",{value:!0});var c=i.i18n_default_project("sharing")._;t.constructGuests=o,t.constructLinkMembers=l}),define("modules/clean/sharing/parent_folder_access_modal",["require","exports","tslib","react","modules/clean/em_string","modules/clean/react/flag","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/access_level","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),s=n.__importStar(s),d=n.__importStar(d);var u=d.i18n_default_project("sharing"),p=u._,h=u.ungettext,m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dismissModal=function(){a.Modal.close(),t.handleDismissed()},t.handleDismissed=function(){t.props.onClose&&t.props.onClose()},t.handleNavigateToParentFolder=function(e){return function(){a.Modal.close(),t.props.onParentFolderClicked&&t.props.onParentFolderClicked(e.path,t.arePermissionsAllowed(e.permissions))}},t.arePermissionsAllowed=function(e){return e.some(function(e){return e&&e.allow})},t.memberCanEdit=function(){return[l.ACCESS_LEVEL.OWNER,l.ACCESS_LEVEL.WRITER].indexOf(t.props.memberAccessLevelResult.access_level)>-1},t.getInfoStr=function(){return"remove"===t.props.originalAction?t.props.contentInfo.isFolder()?h("As a member of the parent folder listed below, %(member_name)s can still access the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access the contents of “%(content_name)s”.",t.props.memberAccessLevelResult.parentFolders.length):h("As a member of the parent folder listed below, %(member_name)s can still access “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access “%(content_name)s”.",t.props.memberAccessLevelResult.parentFolders.length):t.props.contentInfo.isFolder()?t.memberCanEdit()?h("As a member of the parent folder listed below, %(member_name)s can still edit the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit the contents of “%(content_name)s”.",t.props.memberAccessLevelResult.parentFolders.length):h("As a member of the parent folder listed below, %(member_name)s can still view the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view the contents of “%(content_name)s”.",t.props.memberAccessLevelResult.parentFolders.length):t.memberCanEdit()?h("As a member of the parent folder listed below, %(member_name)s can still edit “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit “%(content_name)s”.",t.props.memberAccessLevelResult.parentFolders.length):h("As a member of the parent folder listed below, %(member_name)s can still view “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view “%(content_name)s”.",t.props.memberAccessLevelResult.parentFolders.length)},t.renderParentFolderContent=function(){var e=t.getInfoStr();return r.default.createElement("div",null,e.format({member_name:i.Emstring.em_snippet(t.props.memberDisplayName,c.SNIPPET_SIZES.DISPLAY_NAME),content_name:i.Emstring.em_snippet(t.props.contentInfo.name()||"",c.SNIPPET_SIZES.FILENAME)}),r.default.createElement("div",{className:"parent-folder-access-modal__folder-list u-mar-top-s"},r.default.createElement("ul",{className:"o-list-ui o-list-ui--dividers"},t.props.memberAccessLevelResult.parentFolders.map(t.renderParentFolder))))},t.renderParentFolder=function(e){var n=r.default.createElement(o.Sprite,{group:"web",name:"folder_user_32",className:"u-pad-right-xs",alt:""});return r.default.createElement("li",null,r.default.createElement("div",{className:"parent-folder-access-modal__parent-folder u-pad-vertical-xs u-pad-horizontal-s",onClick:t.handleNavigateToParentFolder(e)},r.default.createElement(s.Flag,{leftAttachment:n,rightAttachment:t.renderFolderLink(e)},r.default.createElement("span",{className:"parent-folder-access-modal__folder-name"},i.Emstring.em_snippet(e.name,c.SNIPPET_SIZES.FILENAME)))))},t.renderFolderLink=function(e){return r.default.createElement("button",{className:"button-as-link",onClick:t.handleNavigateToParentFolder(e),type:"button"},p(t.arePermissionsAllowed(e.permissions)?"Manage membership":"View folder"))},t.renderSimpleContent=function(){return r.default.createElement("div",null,r.default.createElement("span",{className:"parent-folder-access-modal__warning"},t.props.memberAccessLevelResult.warning),r.default.createElement("div",{className:"u-mar-top-m clearfix"},r.default.createElement("div",{className:"u-l-fr"},r.default.createElement("button",{className:"c-btn c-btn--primary confirm-button",onClick:t.dismissModal},p("OK")))))},t.getTitleStr=function(){return p("remove"===t.props.originalAction?t.props.contentInfo.isFolder()?"%(member_name)s can still access this folder":"%(member_name)s can still access this file":t.props.contentInfo.isFolder()?t.memberCanEdit()?"%(member_name)s can still edit this folder":"%(member_name)s can still view this folder":t.memberCanEdit()?"%(member_name)s can still edit this file":"%(member_name)s can still view this file")},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.getTitleStr();return r.default.createElement(a.Modal,{autoClose:!1,className:"parent-folder-access-modal",buttonComponent:r.default.createElement("span",null),onDismissCompleted:this.handleDismissed,title:e.format({member_name:i.Emstring.em_snippet(this.props.memberDisplayName,c.SNIPPET_SIZES.DISPLAY_NAME)})},r.default.createElement("div",{className:"parent-folder-access-modal__contents"},this.props.memberAccessLevelResult.parentFolders&&!this.props.isInContentManager?this.renderParentFolderContent():this.renderSimpleContent()))},t.displayName="ParentFolderAccessModal",t})(r.default.Component);t.ParentFolderAccessModal=m}),define("modules/clean/sharing/share_modal",["require","exports","tslib","external/immutable","react","modules/clean/flux/dispatcher","modules/clean/react/growth/education_module_event_bridge","modules/clean/flux/store_listener","modules/clean/react/browse/constants","modules/clean/sharing/sharing_settings_constants","modules/clean/react/pass/store","modules/clean/keycode","modules/clean/sharing/file_settings_modal","modules/clean/sharing/folder_settings_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/member_constructors","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/modal_content_spectrum","modules/clean/viewer","spectrum/modal","modules/core/i18n","modules/clean/ux_analytics_utils"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importDefault(i),b=n.__importStar(b);var y=b.i18n_default_project("sharing")._,C=function(e){var t=e.actionHandler.getSharingInfo(),i=e.actionHandler.getPassInfo(),s=i.groupSeenStateInfo,a=i.linkSeenStateInfo,o=i.presentAccountIds,l=i.passFetchingStatus,c={sharingInfo:t,actionHandler:e.actionHandler,areMembersFullyLoaded:t.areMembersFullyLoaded(),areSharingPrefsLoaded:t.areSharingPrefsLoaded(),canChangeOptions:t.permissionsObj().canChangeOptions(),canEdit:t.permissionsObj().canEdit(),canRelinquishMembership:t.permissionsObj().canRelinquishMembership(),canShareLink:t.canShareLink(),canUnshareFile:t.permissionsObj().canUnshare(),canUnshareFolder:t.permissionsObj().canUnshare(),canUpdateConfidentiality:t.permissionsObj().canUpdateConfidentiality(),contactsError:t.contactsError(),contentInfo:t.contentInfo(),contentNameMessage:t.contentNameMessage(),contentNameMessageLevel:t.contentNameMessageLevel(),filePolicy:t.filePolicy(),folderPolicy:t.folderPolicy(),guestMembers:_.constructGuests(o),groupSeenStateInfo:s,hasCreatedShowcase:t.hasCreatedShowcase(),hasDisplayableMembers:t.hasDisplayableMembers(),hasNonOwnerMembers:t.hasNonOwnerMembers(),hasParentSharedFolder:t.hasParentSharedFolder(),hasShowcaseFreemium:t.hasShowcaseFreemium(),initialRecipientRawInput:t.initialRecipientRawInput(),initialRecipientTokens:t.initialRecipientTokens(),isConfidentialFolder:t.isConfidentialFolder(),isContentNameFocused:t.isContentNameFocused(),isFolderInsideTeamFolderTree:t.isFolderInsideTeamFolderTree(),isLinkMetadataLoaded:t.isLinkMetadataLoaded(),isMetadataLoaded:t.isMetadataLoaded(),isOwner:t.isOwner(),isTeamPolicyLoaded:t.isTeamPolicyLoaded(),isTeamSharedFolder:t.isTeamSharedFolder(),isTokenizerEmpty:t.isTokenizerEmpty(),isUserOnOwnerTeam:t.isUserOnOwnerTeam(),linkMembers:_.constructLinkMembers(a),linkMetadata:t.linkMetadata(),linkOnlyReason:t.linkOnlyReason(),memberCounts:t.memberCounts(),memberCountWithRecipients:t.memberCountWithRecipients(),members:t.members(),metadata:t.metadata(),ownerTeam:t.ownerTeam(),passFetchingStatus:l,pendingMemberAction:t.pendingMemberAction(),permissions:t.permissions(),sharingPermissions:t.permissionsObj(),presentAccountIds:r.Set(o),recipientMessage:t.recipientMessage(),recipientTokens:t.recipientTokens(),shareFolderPromise:t.shareFolderPromise(),shouldBlockMemberListOnPassLoad:t.shouldBlockMemberListOnPassLoad(),teamPolicy:t.teamPolicy(),uiMode:t.uiMode(),onCreateGroupCallback:t.onCreateGroupCallback(),hasCreatedShareLink:t.createdShareLink(),expLinkSettingsEmbed:t.expLinkSettingsEmbed()};return n.__assign({},t.getInitialProps(),c)},M=(function(e){function t(t){var n=e.call(this,t)||this;return n.spectrumModalClassName="scl-share-modal",n.handleKeyDown=function(e){e.keyCode===u.KeyCode.ESC&&n.onModalCloseClick()},n.preventEventBubbling=function(e){return e.stopPropagation()},n.onModalCloseClick=function(){a.educationEventBridge.requestSharingCallout();var e=n.getTokenizer();e&&e.finishLogging(!1),n.setState({open:!1}),I.dispatchModalClosed()},n.getSpectrumModalElement=function(){return document.getElementsByClassName(n.spectrumModalClassName)[0]},n.onModalReady=function(){I.dispatchModalOpened();var e=n.getSpectrumModalElement();e&&e.addEventListener("keypress",n.preventEventBubbling,!1)},n.renderSettings=function(e){return n.props.contentInfo.isFolder()?n.renderFolderSettings(e):n.renderFileSettings(e)},n.onSettingsClick=function(){n.setState({currentTab:n.props.contentInfo.isFolder()?c.FOLDER_SETTINGS:c.FILE_SETTINGS,showSettings:!0})},n.onLinkSettingsClick=function(){n.setState({currentTab:c.LINK_SETTINGS,showSettings:!0})},n.hideSettingsModal=function(){n.setState({showSettings:!1})},n.showSettingsModal=function(e){return g.logTiburonEvent(n.props.contentInfo,n.props.user.id,"OPEN_LINK_SETTINGS_MODAL"),e},n.handleUpdateLinks=function(e){n.props.actionHandler.setSharedLinks(e),n.props.actionHandler.refreshSharedWithColumnLinkData()},n.handleDeleteLink=function(e){n.props.actionHandler.refreshSharedWithColumnLinkData(),n.props.actionHandler.deleteLinkMetadata(e),n.hideSettingsModal()},n.state={open:!0,showSettings:!1},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown,!1)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown,!1);var e=this.getTokenizer();this.props.actionHandler.onShareModalUnmount(e);var t=this.getSpectrumModalElement();t&&t.removeEventListener("keypress",this.preventEventBubbling,!1)},t.prototype.render=function(){return this.state.showSettings?this.renderSettings(this.state.currentTab):i.default.createElement(v.Modal,{appElement:document.getElementById("embedded-app")||document.body,ariaLabel:y("Sharing Modal"),className:this.spectrumModalClassName,bodyClassName:"scl-share-modal-content uxa-modal",bodyId:"unified-share-modal",displayCloseButton:!1,open:this.state.open,width:540,overlayClassName:"file-viewer-modal-overlay",overlayClickClose:!0,onReady:this.onModalReady,onRequestClose:this.onModalCloseClick},this.renderModalContent())},t.prototype.renderModalContent=function(){var e=d.passStore.getPassPermissions(this.props.contentInfo.extras.fileId),t=e&&e.canReadPresence,r=!!(this.props.contentInfo.isFile()?this.props.filePolicy&&this.props.filePolicy.viewer_info_policy:this.props.folderPolicy&&this.props.folderPolicy.viewer_info_policy),s={headerId:"unified-share-modal-title",areCheckboxSettingsLoaded:this.props.areSharingPrefsLoaded,isLimitedTeam:this.props.viewer.team_is_limited,isPassEnabled:t,isInContentManager:this.props.isInContentManager,mode:this.props.uiMode,ref:"content",showContentManagerBridge:this.shouldRenderContentManagerBridge(),showPassFileSettings:r,onLinkSettingsClick:this.onLinkSettingsClick,onModalCloseClick:this.onModalCloseClick,onSettingsClick:this.onSettingsClick};return s=n.__assign({},this.props,s),i.default.createElement(S.ShareModalContentSpectrum,n.__assign({},s))},t.prototype.refreshSharedWithColumnLinkData=function(){s.Dispatcher.dispatch({type:l.SharedWithActionType.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.props.contentInfo.displayPath()]}})},t.prototype.handleFolderPolicySuccess=function(e,t){s.Dispatcher.dispatch({type:m.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS,user:this.props.user,metadata:t,folderPolicy:e})},t.prototype.getTokenizer=function(){return this.refs.content&&this.refs.content.getWrappedComponent()&&this.refs.content.getWrappedComponent().refs.tokenizer},t.prototype.renderFileSettings=function(e){var t=this,n=function(e){null!=e&&t.props.actionHandler.handleUpdateFilePolicy(e,t.props.filePolicy),t.hideSettingsModal()},r=i.default.createElement(p.FileSettingsModal,{sharingInfo:this.props.sharingInfo,currentTab:e,fileName:this.props.actionHandler.getSharingInfo().name(),contentId:this.props.contentInfo.id,canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,initialPolicy:this.props.filePolicy,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,onUpdateLinks:this.handleUpdateLinks,onDeleteLink:this.handleDeleteLink,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,user:this.props.user});return g.logTiburonEvent(this.props.contentInfo,this.props.user.id,"OPEN_FILE_SETTINGS_MODAL"),this.showSettingsModal(r)},t.prototype.renderFolderSettings=function(e){var t=this,n=function(e,n){null!=n&&(t.props.actionHandler.handleUpdateSharingSettings(n),t.handleFolderPolicySuccess(e,n),t.props.onSuccessSharing&&t.props.onSuccessSharing(),n.policy.shared_link_policy!==t.props.folderPolicy.shared_link_policy&&(t.props.actionHandler.fetchLinkMetadata(),t.refreshSharedWithColumnLinkData())),t.hideSettingsModal()},r=i.default.createElement(h.SharedFolderSettingsModal,{sharingInfo:this.props.sharingInfo,actionHandler:this.props.actionHandler,currentTab:e,folderName:this.props.actionHandler.getSharingInfo().name(),folderId:this.props.metadata.shared_folder_id,folderPath:this.props.contentInfo.displayPath(),initialHasParentSharedFolder:this.props.hasParentSharedFolder,initialMetadata:this.props.metadata,initialOwnerTeam:this.props.ownerTeam,initialPermissions:this.props.permissions,initialPolicy:this.props.folderPolicy,isInContentManager:this.props.isInContentManager,isSharedFolder:this.props.contentInfo.isSharedFolder(),initialIsTeamSharedFolder:this.props.isTeamSharedFolder,isConfidentialFolder:this.props.isConfidentialFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isLimitedTeam:this.props.viewer.team_is_limited,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onCancel:this.hideSettingsModal,onPolicySet:n,onUpdateLinks:this.handleUpdateLinks,onDeleteLink:this.handleDeleteLink,showContentManagerBridge:this.shouldRenderContentManagerBridge(!0),teamPolicy:this.props.teamPolicy,updateLinkSettings:this.props.actionHandler.updateLinkSettings,user:this.props.user});return g.logTiburonEvent(this.props.contentInfo,this.props.user.id,"OPEN_FOLDER_SETTINGS_MODAL"),this.showSettingsModal(r)},t.prototype.shouldRenderContentManagerBridge=function(e){return void 0===e&&(e=!1),!this.props.isInContentManager&&(!!g.GoldenGate.hasContentManagerAndSuperAdmin(this.props.user.id)&&(!!this.props.isTeamSharedFolder||!(!this.props.isFolderInsideTeamFolderTree||!this.props.isUserOnOwnerTeam)&&(e||!this.props.sharingPermissions.canInviteEditor())))},t.displayName="ShareModal",t.defaultProps={viewer:E.Viewer.get_viewer()},t})(i.default.Component);t.ShareModal=o.listenToStores(M,{sharingInfoStore:f.sharingInfoStore,passStore:d.passStore},C)}),define("modules/clean/sharing/share_modal_dropdown_util",["require","exports","tslib","modules/clean/sharing/access_level","modules/clean/sharing/constants","modules/clean/sharing/strings","modules/core/i18n"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a);var o=a.i18n_default_project("sharing")._;t.shouldShowMemberAction=function(e,t,n,r,s){return t===n||r&&r.get(e)&&r.get(e).allow||t===i.MEMBER_ACTION.REMOVE&&s},t.getMemberActionInfo=function(e,t){var n=s.ACCESS_NAME;t&&(n=s.ACCESS_NAME_NO_COMMENT);var a=s.MEMBER_ACTION_FOLDER;t&&(a=s.MEMBER_ACTION_FOLDER_NO_COMMENT);var l=s.MEMBER_ACTION_FILE;t&&(l=s.MEMBER_ACTION_FILE_NO_COMMENT);var c=o("Remove");return e&&(c=o("Remove my access")),[[i.MEMBER_ACTION.MAKE_EDITOR,{value:r.ACCESS_LEVEL.WRITER,title:n[r.ACCESS_LEVEL.WRITER],folder_description:a[i.MEMBER_ACTION.MAKE_EDITOR],file_description:l[i.MEMBER_ACTION.MAKE_EDITOR]}],[i.MEMBER_ACTION.MAKE_VIEWER,{value:r.ACCESS_LEVEL.READER,title:n[r.ACCESS_LEVEL.READER],folder_description:a[i.MEMBER_ACTION.MAKE_VIEWER],file_description:l[i.MEMBER_ACTION.MAKE_VIEWER]}],[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT,{value:r.ACCESS_LEVEL.READER_NO_COMMENT,title:n[r.ACCESS_LEVEL.READER_NO_COMMENT],folder_description:a[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT],file_description:l[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]}],[i.MEMBER_ACTION.MAKE_OWNER,{value:r.ACCESS_LEVEL.OWNER,title:o("Make owner")}],[i.MEMBER_ACTION.REMOVE,{value:"remove",title:c}]]}}),define("modules/clean/sharing/share_modal_icon",["require","exports","tslib","react","spectrum/icon_content","modules/clean/filetypes","modules/clean/react/icon/file_icon","modules/clean/react/icon/icon_helper"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return this.props.isFolder?this.renderFolder():this.renderFile()},t.prototype.renderFile=function(){var e={file:{type:s.FileTypes.FILE,fq_path:this.props.filename},className:this.props.className,variant:"small"};return r.default.createElement(a.FileIcon,n.__assign({},e))},t.prototype.renderFolder=function(){var e=s.FileTypes.FOLDER;this.props.pathExists&&(this.props.isTeamSharedFolder?e=s.FileTypes.TEAM_SHARED_FOLDER:this.props.isSharedFolder&&(e=s.FileTypes.SHARED_FOLDER));var t=o.spectrumFolderIcon({fileType:e,isViewOnly:this.props.isViewOnly,isInTeamFolderTree:this.props.isFolderInsideTeamFolderTree,size:o.SpectrumIconSize.Small,isConfidential:this.props.isConfidentialFolder||!1,iconPostfix:this.props.isConfidentialFolder?"_admin_view":""});return r.default.createElement(i.IconContent,{name:t,"aria-label":this.props.alt,role:"img",className:this.props.className})},t})(r.default.Component);t.ShareModalIcon=l}),define("modules/clean/sharing/share_modal_util",["require","exports","tslib","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/teams/modals/limited_team_share_folder_modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal","modules/clean/sharing/ui_util","modules/clean/viewer","modules/clean/react/browse/logger_util","external/immutable","modules/clean/sharing/views/exp_showcase_share_interstitial"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),a=n.__importDefault(a),l=n.__importStar(l),d=n.__importStar(d),E=n.__importStar(E),v=n.__importStar(v),t.generateModalSessionId=function(){return Math.random().toString()},t.getSharingInfo=function(e,r,i){void 0===i&&(i={});var s=null;"number"==typeof e&&(e=S.Viewer.get_viewer().get_user_by_id(e)),null==i.userHomeNs&&(i.userHomeNs=e.home_ns_id);var a=t.getShareModalInfo(r),o=null;if(null!=a){a=n.__assign({},a,i),a.modalSessionId&&(a.modalSessionId=t.generateModalSessionId());var d=a.nsId,u=a.sjid,p=a.fileId,h=a.filename,_=a.fqPath;l.logViewShareModal({uid:e.id,modal_session_id:a.modalSessionId||"",file_nsid:d,file_sjid:u,file_id:p,file_name:h,file_path:_});try{s=m.ContentInfo.createFromParams(a)}catch(e){s=null}o=r instanceof c.BrowseContext?r:a.browseContext}return{browseContext:o,contentInfo:s,shareModalInfo:a,user:e}},t.showShareModal=function(e,n,s,a,o,l){void 0===s&&(s={});var c,d,m,S;if(c=t.getSharingInfo(e,n,s),d=c.browseContext,m=c.contentInfo,S=c.shareModalInfo,e=c.user,null==m||null==S)return!1;if(g.logTiburonEvent(m,e.id,"BEGIN_SHARE_FLOW"),S&&t.showFastrakShareModalIfAllowed(e,S,d))return!0;if(!S.skipPublicFolderCheck&&m&&d){var E=_.makePublicFolderLink(e.id,d.config,m.displayPath(),m.isFolder());if(E)return _.showPublicFolderLinkModal(E),!0}var v=(null!=d?d.isNonUserRelativeContext:void 0)||S.isNonUserRelativeContext,b=i.SHMODAL;if(S.origin===h.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE&&(b=i.SHARE_FILEVIEWER),v||r.EmailVerification.get_for_user(e).verified_or_show(b)){var I=m.isFolder()?p.FolderShareApiClient:p.FileShareApiClient,y=new I({userId:e.id,isNonUserRelativeContext:v}),C=new u.ShareModalActionHandler(y,e,f.ShareModal,a,o,l),M=S.inLinksPage,T=S.prefillContacts;C.initializeShareModal({contentInfo:m,initialRecipientTokens:T,inLinksPage:M},{client:y,content:n,user:e,onDeleteLink:S.onDeleteLink,teamGroupInfo:m.teamGroupInfo(),isInContentManager:v,onSuccessSharing:S.onSuccessSharing,shareAsConfidential:S.shareAsConfidential,initialContentName:S.initialContentName,shouldSyncThisFolder:S.shouldSyncThisFolder,recipientMessage:S.recipientMessage,onCreateGroupCallback:S.onCreateGroupCallback}),C.openShareModal()}else g.logTiburonEvent(m,e.id,"SHARE_MODAL_EMAIL_UNVERIFIED");return!0},t.showFastrakShareModalIfAllowed=function(e,t,n){return!(!t.isTeamSharedFolder||!S.Viewer.get_viewer().team_is_limited)&&(d.showModalInstance({fqPath:t.fqPath}),!0)},t.getShareModalInfo=function(e){
if(e instanceof c.File){var t=[o.FileTypes.FILE,o.FileTypes.PACKAGE].indexOf(e.type)>-1;return{beaconContext:e.beacon_context,exists:!e.isDeleted,fileId:e.file_id,fqPath:e.fq_path,isFolder:!t,isTeamSharedFolder:e.type===o.FileTypes.TEAM_SHARED_FOLDER,sjid:e.sjid,nsId:e.ns_id,nsPath:e.ns_path,targetNsId:e.target_ns}}return e instanceof c.BrowseContext?I(e):e};var I=function(e){return e.isInsideDeletedFolder||e.isInsideDeletedSharedFolder?null:e.isInFolderMode?e.isInsideSharedFolder?e.currentNSPath?{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentMountPoint,isFolder:!0,nsId:null,nsPath:e.currentMountPoint,targetNsId:e.currentNSID}:{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentFQPath,isFolder:!1,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}};t.showNewFolderShareModal=function(e,n,r,i,s,a,o,l,c,d,u){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===o&&(o=null),n||(n=t.generateModalSessionId());var p=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=1;n<=100;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return g.getNewFolderPathFromContentName(e,r||"")},m={fqPath:p(),isFolder:!0,exists:!1,origin:h.SHARE_ACTION_ORIGIN_TYPE.WIZARD,modalSessionId:n,isNonUserRelativeContext:a,isTeamSharedFolder:!1,initialContentName:i,shareAsConfidential:s,shouldSyncThisFolder:o},_={};return u&&(_.onSuccessSharing=u),t.showShareModal(e,m,_,l,c,d)},t.showPrefilledShareModal=function(e){var r,i,o=e.user,l=e.sharePrefillEmail,c=e.content,d=e.setPath,u=e.setUrl,p=e.contentManagerValidateFolderPath,m=e.extras;return l?(r=h.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS,i=[new s.Contact({type:a.default.EMAIL,email:l,name:"",query:l,pending:!0})]):(r=h.SHARE_ACTION_ORIGIN_TYPE.DESKTOP_CLIENT,i=[]),t.showShareModal(o,c,n.__assign({origin:r,prefillContacts:i},m),d,u,p)},t.expShowShareInterstitialModal=function(r,i,s,a,o,c,d,u){void 0===c&&(c={});var p=function(){t.showShareModal(r,i,c,d,u)},h=function(){var t=E.countFilesAndFolders(v.Set([i])),c=t.num_files_selected,d=t.num_folders_selected;l.logOpenAddToCollectionModal({uid:r.id,source:"FILE_VIEW_ROW",view_type:o,result:i,num_files_selected:c,num_folders_selected:d});var u=i.ns_id,p=i.ns_path,h=i.fq_path;new Promise(function(t,n){e(["modules/clean/react/professional_collection/add_to_collection_modal_controller"],t,n)}).then(n.__importStar).then(function(e){(0,e.showAddToCollectionModal)([{ns_id:u,ns_path:p,fq_path:h}],r,s,a)})};return b.showShowcaseInterstitial({user:r,onClickShare:p,onClickShowcase:h}),!0},t.showShareModalCallback=function(e,n){var r=n.user,i=n.content,s=n.prefillContacts,a=n.recipientMessage;t.showShareModal(r,i,{prefillContacts:s,recipientMessage:a})}}),define("modules/clean/sharing/sharing_settings_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEMBER_POLICY="member_policy",t.VIEWER_INFO_POLICY="viewer_info_policy",t.ACCESS_LEVEL_POLICY="access_level",t.FOLDER_LINK_AUDIENCE_POLICY="shared_link_policy",t.EXPIRES="expires",t.ALLOW_DOWNLOAD="allow_download",t.COMMENTS="comments",t.REQUESTED_VISIBILITY="requested_visibility",t.AUDIENCE="audience",t.ACL_UPDATE_POLICY="acl_update_policy",t.DROPDOWN="dropdown",t.TOGGLE="toggle",t.TEXT="text",t.FILE_SETTINGS="file_settings",t.FOLDER_SETTINGS="folder_settings",t.LINK_SETTINGS="link_settings"}),define("modules/clean/sharing/sharing_settings_dropdown",["require","exports","tslib","react","spectrum/dropdown_menu","spectrum/dropdown_menu","spectrum-sharing/sharing_dropdown_menu"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);var o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){t.props.onValueSelected(e)},t}return n.__extends(t,e),t.prototype.render=function(){return r.default.createElement(a.SharingDropdownMenu,{disabled:this.props.disabled,onSelection:this.handleSelection,position:"right"},this.renderButton(),r.default.createElement(s.Menu,null,this.renderMenuItems()))},t.prototype.renderButton=function(){return r.default.createElement(i.DropdownMenuButton,{className:"sharing-settings-dropdown__button",disabled:this.props.disabled},this.props.optionsDict[this.props.currentValue].label)},t.prototype.renderMenuItems=function(){var e=this;return this.props.valuesList.map(function(t){return r.default.createElement(a.SharingDropdownMenuItem,{key:t,value:t,label:e.props.optionsDict[t].label,description:e.props.optionsDict[t].description,selected:t===e.props.currentValue})})},t})(r.default.Component);t.SettingDropdown=o}),define("modules/clean/sharing/sharing_settings_modal",["require","exports","tslib","react","external/lodash","modules/clean/em_string","modules/clean/filepath","modules/clean/react/css","spectrum-sharing/fixed_tabbed_container","spectrum/modal","spectrum/button","spectrum-sharing/sharing_modal_banner","modules/clean/sharing/constants","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/ui_util","modules/constants/trademark","modules/clean/sharing/delete_link_modal","modules/core/i18n","modules/clean/sharing/api/types/metadata","modules/clean/sharing/views/sharing_settings_file_folder_policy_view","modules/clean/sharing/views/sharing_settings_link_policy_view","modules/clean/sharing/views/sharing_settings_righteous_link_policy_view","modules/clean/sharing/views/sharing_settings_links_section","modules/clean/sharing/views/sharing_settings_link_policies","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/views/exp_pro_bundle_upsell","modules/clean/sharing/views/exp_pro_bundle_tracker"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I,y,C,M,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),a=n.__importStar(a),S=n.__importStar(S);var k=S.i18n_default_project("sharing")._,A=r.default.createElement,w=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={currentTab:t.currentTab},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=n.__assign({},this.props);return t=i.assignIn(t,{currentTab:this.state.currentTab,onTabSelected:function(t){e.setState({currentTab:t})}}),A(R,t)},t})(r.default.Component);t.SharingSettingsModal=w;var L=(function(e){function t(t){var n=e.call(this,t)||this;return n.onSaveSettings=function(){n.getCurrentTab()===M.LINK_SETTINGS?n.saveLinkSettings():n.props.onSaveSettings()},n.isSubmitting=function(){return n.getCurrentTab()===M.LINK_SETTINGS?n.state.isSubmitting:n.props.isSubmitting},n.renderPrimaryAction=function(){return r.default.createElement(d.Button,{className:"confirm-button u-mar-left-s",variant:"primary",disabled:!n.allowSaveSettings()||n.isSubmitting(),onClick:n.onSaveSettings},k(n.isSubmitting()?"Saving...":"Save"))},n.onUnshare=function(){n.getCurrentTab()===M.LINK_SETTINGS?g.deleteLinkWithConfirm({client:n.props.client,url:n.props.linkMetadata.url,contentName:n.props.linkMetadata.name,onDeleteLink:function(){n.props.onDeleteLink(n.props.linkMetadata)}}):n.props.onUnshare()},n.canDeleteLink=function(){return n.props.linkMetadata&&n.props.linkMetadata.link_permissions.can_revoke},n.handleLinkPolicyUpdate=function(e,t){var r=n.state.updatedLinkPolicies;r[e.url]=t,n.setState({updatedLinkPolicies:r})},n.state={isSubmitting:!1,updatedLinkPolicies:{}},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return this.setState({isSubmitting:!1}),[2]})})},t.prototype.getLinkSettingsToUpdate=function(){var e={errors:!1,requests:[]};if(!this.props.sharingInfo)return e;for(var t=0,n=this.props.sharingInfo.sharedLinks();t<n.length;t++){var r=n[t],i=h.getLinkPolicy(r),s=this.state.updatedLinkPolicies[r.url],a=s||i,o=r.isRighteousLink()?h.getModifiedSettingsForRighteousLink(r,a,i):h.getModifiedSettings(r,a,i);if(o&&o.settings)e.requests.push(o);else if(null===o){e.errors=!0;break}}return e},t.prototype.saveLinkSettings=function(){var e=this,t=this.getLinkSettingsToUpdate();t.errors||(this.setState({isSubmitting:!0}),Promise.all(t.requests.map(function(t){return e.props.client.modifySharedLinkSettings(t)})).then(function(t){m.sharingNotificationSuccess(k("Settings saved.")),e.handleUpdateLinks(t),e.props.onDismiss()}).catch(function(){e.setState({isSubmitting:!1}),m.sharingNotificationError(k("There was a problem completing this request."))}))},t.prototype.handleUpdateLinks=function(e){for(var t=[],n=this.props.sharingInfo?this.props.sharingInfo.sharedLinks():[],r=function(n){var r=e.filter(function(e){return n.url===e.url})[0];t.push(r||n)},i=0,s=n;i<s.length;i++){r(s[i])}this.props.onUpdateLinks(t)},t.prototype.render=function(){var e;if(this.props.isLoading)e=r.default.createElement("div",{className:"sharing-settings-modal__loading-text"},k("Loading..."));else{var t=this.getTabInfo(this.getCurrentTab());e=r.default.createElement(l.FixedTabbedContainer,{className:"sharing-settings-modal",tabs:this.getTabs(),activeTabId:this.getCurrentTab(),onTabSelected:this.props.onTabSelected},r.default.createElement("div",{className:"sharing-settings-modal__banners"},t.banner,t.description),r.default.createElement("div",{className:"sharing-settings-modal__tab-content"},t.content))}return r.default.createElement(c.UtilityModal,{ariaLabel:this.renderTitle(),title:this.renderTitle(),overlayClickClose:!0,primaryAction:this.renderPrimaryAction,secondaryAction:k("Cancel"),onPrimaryAction:this.onSaveSettings,onSecondaryAction:this.props.onDismiss,onLink:this.onUnshare,link:this.renderUnshareButton(),open:!0,width:580,height:662,onRequestClose:this.props.onDismiss,bodyClassName:"sharing-settings-utility-modal",overlayClassName:"file-viewer-modal-overlay"},e)},t.prototype.renderTitle=function(){var e={file_or_folder_name:s.Emstring.em_snippet(this.props.folderName,p.SNIPPET_SIZES.FILENAME)};return k("Settings for “%(file_or_folder_name)s”").format(e)},t.prototype.renderUnshareButton=function(){var e;return this.getCurrentTab()===M.LINK_SETTINGS?!this.showMultipleLinkInterface()&&this.canDeleteLink()&&(e=k("Delete link")):this.props.permissions&&this.props.permissions.unshare.allow&&(this.props.isSharedFolder||!this.props.isFolder)&&(e=k(this.props.isFolder?this.props.isFolderInsideTeamFolderTree?"Reset membership":"Unshare folder":"Unshare file")),e},t.prototype.getTabs=function(){var e=[],t={id:M.FILE_SETTINGS,label:k("File settings")},n={id:M.FOLDER_SETTINGS,label:k("Folder settings")};this.props.currentPolicy&&(e=this.props.isFolder?[n]:[t]);var r={id:M.LINK_SETTINGS,label:k("Link settings")};return this.showLinkSettingsTab()&&e.push(r),e},t.prototype.getCurrentTab=function(){return this.props.currentTab||this.getTabs()[0].id},t.prototype.canChangePolicy=function(e){return this.props.getEffectivePolicyValue(e,this.props.policyUpdate)[1]},t.prototype.showLinkSettingsTab=function(){return!this.props.isTeamSharedFolder&&!this.props.isInContentManager},t.prototype.canChangeOptions=function(){return this.props.permissions&&this.props.permissions.change_options&&this.props.permissions.change_options.allow},t.prototype.isTeamFolderTree=function(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree},t.prototype.getFolderSettingsDescription=function(){var e;if(this.canChangeOptions()&&!this.props.user.is_team_admin)return e=k(this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(M.ACL_UPDATE_POLICY)?"Only you (the owner) can change these settings.":"Only the owner can change these settings."),r.default.createElement(u.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:e})},t.prototype.getFileSettingsDescription=function(){if(this.canChangeOptions())return r.default.createElement(u.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:k("Anyone with edit access can change these settings.")})},t.prototype.getFileSettingsBanner=function(){if(!this.canChangeOptions()){var e;return this.props.currentPolicy&&this.props.permissions&&(e=h.getPassDenyReason(this.props.currentPolicy,this.props.permissions)),e||(e=k("You don’t have permission to change the settings on this file.")),r.default.createElement(u.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"error",message:e})}},t.prototype.getFolderSettingsBanner=function(){if(!this.props.shouldHideHeader){var e,t=k("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName});if(this.props.isInContentManager)e=t;else if(this.props.showContentManagerBridge){var n=a.parent_dir(this.props.folderPath),i=_.genContentManagerBridgeUri({containingFolder:n,filenameToSelect:this.props.folderName}),s=k("These settings will apply to all folders inside “%(folder_name)s”. You can change these settings in the Admin Console.").format({folder_name:this.props.folderName});e=r.default.createElement("div",null,s+" ",r.default.createElement("div",null,r.default.createElement("a",{href:i.toString(),target:"_blank"},k("Go to Admin Console."))))}else if(this.isTeamFolderTree())e=r.default.createElement("div",null,t+" ",r.default.createElement("div",null,r.default.createElement("a",{href:"/team",target:"_blank"},k("To edit, ask your admin."))));else{if(this.canChangeOptions())return;e=k("You don’t have permission to change the settings on this folder.")}return r.default.createElement(u.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"error",message:e})}},t.prototype.getLinkSettingsBanner=function(){if(this.props.linkMetadata&&(!this.props.sharingInfo||!this.props.sharingInfo.isCloudDoc())){var e=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.disallowed_reason===E.VisibilityDisallowedReason.user_account_type}),t=this.props.linkMetadata.link_permissions.can_disallow_download;if(e.length>0||t===!1){var n,i,s=null;1===this.props.user.is_team?(n="/team/upgrade",i=k("Upgrade to %(trademark_business)s to enable all link settings.").format({trademark_business:f.TRADEMARK_BUSINESS})):(n="/upgrade?oqa=sfp&_tk=sg_pro_bundle_header",i=k("Upgrade to Dropbox %(trademark_professional)s to enable all link settings.").format({trademark_professional:f.TRADEMARK_PROFESSIONAL}),1===this.props.user.paid&&(s=r.default.createElement("div",{className:"sharing-settings-modal__pro-bundle-upsell-header"},r.default.createElement(T.ProBundleUpsellHeader,{user:this.props.user}))));var a=r.default.createElement("div",null,r.default.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},i),s);return r.default.createElement(u.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:a})}}},t.prototype.getFolderSettingPolicies=function(){var e=[];return Boolean(this.props.ownerTeam)&&e.push(M.MEMBER_POLICY),e.push(M.ACL_UPDATE_POLICY),Boolean(this.props.ownerTeam)&&e.push(M.FOLDER_LINK_AUDIENCE_POLICY),this.props.currentPolicy&&(this.props.currentPolicy instanceof E.FilePolicy||this.props.currentPolicy instanceof E.FolderPolicy)&&null!=this.props.currentPolicy.viewer_info_policy&&!this.props.showContentManagerBridge&&e.push(M.VIEWER_INFO_POLICY),e},t.prototype.getFileSettingPolicies=function(){var e=[];return this.props.currentPolicy&&(this.props.currentPolicy instanceof E.FilePolicy||this.props.currentPolicy instanceof E.FolderPolicy)&&null!=this.props.currentPolicy.viewer_info_policy&&e.push(M.VIEWER_INFO_POLICY),e},t.prototype.getTabInfo=function(e){switch(e){case M.FILE_SETTINGS:return{title:k("File settings"),banner:this.getFileSettingsBanner(),description:this.getFileSettingsDescription(),content:this.getFileFolderSettingsContent(this.getFileSettingPolicies())};case M.FOLDER_SETTINGS:return{title:k("Folder settings"),banner:this.getFolderSettingsBanner(),description:this.getFolderSettingsDescription(),content:this.getFileFolderSettingsContent(this.getFolderSettingPolicies())};case M.LINK_SETTINGS:return{title:k("Link settings"),banner:this.getLinkSettingsBanner(),description:null,content:this.getLinkSettingsContent()};default:throw new Error("tabName not found")}},t.prototype.getFileFolderSettingsContent=function(e){return r.default.createElement(v.SharingSettingsFileFolderPolicyView,{policies:e,policyUpdate:this.props.policyUpdate,isFolder:this.props.isFolder,isTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,ownerTeam:this.props.ownerTeam,onPolicyUpdate:this.props.onOptionChange,getEffectivePolicyValue:this.props.getEffectivePolicyValue,inPlusToProTrial:this.isPlusToProTrialEnabled()})},t.prototype.showMultipleLinkInterface=function(){return this.props.sharingInfo&&this.props.sharingInfo.isMultipleLinkInterfaceEnabled()},t.prototype.isPlusToProTrialEnabled=function(){return this.props.sharingInfo&&this.props.sharingInfo.isPlusToProTrialEnabled()},t.prototype.getLinkSettingsContent=function(){return this.showMultipleLinkInterface()?this.renderMultipleLinkPolicies():this.renderSingleLinkPolicy()},t.prototype.renderMultipleLinkPolicies=function(){if(this.props.sharingInfo)return r.default.createElement(y.SharingSettingsLinksSection,{client:this.props.client,sharingInfo:this.props.sharingInfo,updatedLinkPolicies:this.state.updatedLinkPolicies,onDeleteLink:this.props.onDeleteLink,onPolicyUpdate:this.handleLinkPolicyUpdate,inPlusToProTrials:this.isPlusToProTrialEnabled()})},t.prototype.renderSingleLinkPolicy=function(){if(this.props.linkMetadata){var e=h.getLinkPolicy(this.props.linkMetadata),t=this.state.updatedLinkPolicies[this.props.linkMetadata.url];return this.props.linkMetadata.isRighteousLink()?r.default.createElement(I.SharingSettingsRighteousLinkPolicyView,{linkMetadata:this.props.linkMetadata,linkPolicy:t||e,onPolicyUpdate:this.handleLinkPolicyUpdate}):r.default.createElement(b.SharingSettingsLinkPolicyView,{isFolder:this.props.isFolder,linkPolicy:t||e,linkMetadata:this.props.linkMetadata,onPolicyUpdate:this.handleLinkPolicyUpdate,inPlusToProTrials:this.isPlusToProTrialEnabled(),getPolicyDict:C.getShmodelPolicyDict})}return r.default.createElement("div",{className:"sharing-settings-modal__link-policy--full"},r.default.createElement("div",{className:"sharing-settings-modal__link-policy-text"},k("No link created yet.")))},t.prototype.allowSaveSettings=function(){return this.getCurrentTab()===M.LINK_SETTINGS&&Object.keys(this.state.updatedLinkPolicies).length>0||!!(this.props.policyUpdate&&Object.keys(this.props.policyUpdate).length>0)},t.displayName="SharingSettingsModalContentsView",t})(r.default.Component);t.SharingSettingsModalContentsView=L;var P=function(e){return r.default.createElement(L,n.__assign({},e))};t.SharedLinkSettingsModalContentsWithProBundleGating=P;var F=N.withProBundleTracking(P),R=o.requireCssWithComponent(F,["/static/css/modal-vflYDGbgV.css","/static/css/sharing/share_modal-vfl6JbngH.css"])}),define("modules/clean/sharing/sharing_settings_util",["require","exports","tslib","modules/clean/previews/util","modules/clean/sharing/api/types/metadata","modules/clean/api_v2/datetime","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/ui_notifications_util","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l){"use strict";function c(e,t,n,r,i,s){switch(e){case a.VIEWER_INFO_POLICY:return!(!i||s)&&("enabled"===t.get(a.VIEWER_INFO_POLICY)?i.disable_viewer_info&&i.disable_viewer_info.allow:i.enable_viewer_info&&i.enable_viewer_info.allow);default:throw new Error("Link policy not found")}}function d(e){switch(e){case"restricted_by_parent_folder":return g("This setting is turned off for all files in this folder.");case"restricted_by_team":return g("Your admin has disabled this setting.");default:return}}function u(e,t){return"enabled"===e.get(a.VIEWER_INFO_POLICY)?t.disable_viewer_info?d(t.disable_viewer_info.reason):void 0:t.enable_viewer_info?d(t.enable_viewer_info.reason):void 0}function p(e){return[a.VIEWER_INFO_POLICY].indexOf(e)!==-1}function h(e){var t=e.link_permissions.requested_visibility,n=e.link_permissions.resolved_visibility;return t===i.RequestedVisibilityPolicy.public&&n===i.ResolvedVisibilityPolicy.team_only&&(t=i.RequestedVisibilityPolicy.team_only),new i.LinkPolicy({requested_visibility:t,link_password:t===i.RequestedVisibilityPolicy.password?null:"",expires:e.expires,allow_download:e.link_permissions.allow_download,audience:e.link_permissions.effective_audience})}function m(e,t,n){var r=t;if(r.requested_visibility===i.RequestedVisibilityPolicy.password){if(null==r.link_password)r=r.set("requested_visibility",null);else if(""===r.link_password)return o.sharingNotificationError(g("Password can’t be empty")),null}else r=r.set("link_password",null);return e.link_permissions.resolved_visibility===i.ResolvedVisibilityPolicy.shared_folder_only&&(r=r.set("requested_visibility",null)),null!=r.expires&&(r=e.link_permissions.can_set_expiry?r.set("expires",s.formatTimestamp(r.expires)):r.set("expires",null)),r.allow_download===n.allow_download&&(r=r.set("allow_download",void 0)),{url:e.url,settings:r,remove_expiration:null!=e.expires&&null==t.expires}}function _(e,t,n){return t.audience===n.audience?{}:{url:e.url,settings:{audience:t.audience}}}function f(e,t){if(!e)return!1;if(null!=(null!=t?t.preview_type:void 0)){var n=t.preview_type;if(Array.from(r.VALID_PREVIEW_TYPES).includes(n))return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),l=n.__importStar(l);var g=l.i18n_default_project("sharing")._;t.canChangePolicy=c,t.denyReasonToDenyString=d,t.getPassDenyReason=u,t.isCommonSharingSettingsPolicy=p,t.getLinkPolicy=h,t.getModifiedSettings=m,t.getModifiedSettingsForRighteousLink=_,t.shouldRenderNoPreviewFileWarning=f}),define("modules/clean/sharing/stores/sharing_info",["require","exports","tslib","external/immutable","modules/constants/python","modules/clean/filepath","modules/clean/cloud_docs/constants","modules/clean/flux/base_store","modules/clean/loggers/growth_features_events_logger","modules/clean/sharing/action_types","modules/clean/sharing/api/types/metadata","modules/clean/sharing/access_level","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/constants/sharing","modules/constants/teams","modules/core/exception","external/lodash"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importStar(i),f=n.__importStar(f),S=n.__importStar(S);var E=function(e,t){return t=String(t),t.startsWith("id:")||(t=t.toLowerCase()),e+"::"+t},v=(function(e){function t(){var t=e.call(this)||this;return t.sharingInfoMap={},t}return n.__extends(t,e),t.prototype.getSharingInfo=function(e,t){return t?this.sharingInfoMap[E(e,t)]:null},t.prototype.mapContentIdsToSharingInfo=function(e,t,n){for(var r=0,i=t;r<i.length;r++){var s=i[r];s&&(this.sharingInfoMap[E(e,s)]=n)}},t.prototype._new_payload=function(e){var t=this;if(e&&e.action&&e.action.type)switch(e.action.type){case c.SharingActionTypes.CLEAR_EVERYTHING:this.sharingInfoMap={};break;case c.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS:var n=e.action.user;e.action.data.forEach(function(e){t._new_payload_for_single_content(c.ShareModalActionTypes.FETCH_METADATA_SUCCESS,n,p.getContentIdsForMetadata(e),{metadata:e})}),this.emit_change();break;default:if(!e.action.contentIds)return;this._new_payload_for_single_content(e.action.type,e.action.user,e.action.contentIds,e.action.data),this.emit_change()}},t.prototype._new_payload_for_single_content=function(e,t,n,r){g.assert(Boolean(t.id),"valid user needed"),g.assert(n.length>0,"contentIds cannot be empty");for(var i=null,s=0,a=n;s<a.length;s++){var o=a[s],l=E(t.id,o);if(l in this.sharingInfoMap){i=this.sharingInfoMap[l];break}}return i||(i=new I(t)),this.mapContentIdsToSharingInfo(t.id,n,i),i._new_payload(e,r)},t})(o.Store);t.sharingInfoStore=new v;var b=(function(){function e(e){this.change_options=S.get(e,"change_options.allow",!1),this.edit_contents=S.get(e,"edit_contents.allow",!1),this.invite_editor=S.get(e,"invite_editor.allow",!1),this.invite_viewer=S.get(e,"invite_viewer.allow",!1),this.relinquish_membership=S.get(e,"relinquish_membership.allow",!1),this.create_edit_link=S.get(e,"create_edit_link.allow"),this.create_view_link=S.get(e,"create_view_link.allow",!1),this.unshare=S.get(e,"unshare.allow",!1),this.update_confidentiality=S.get(e,"update_confidentiality.allow",!1),this.is_file_permissions=e instanceof d.FilePermissions}return e.prototype.canChangeOptions=function(){return this.change_options},e.prototype.canEdit=function(){return this.edit_contents},e.prototype.canInviteEditor=function(){return this.invite_editor},e.prototype.canInviteViewer=function(){return this.invite_viewer},e.prototype.canInvite=function(){return this.canInviteViewer()||this.canInviteEditor()},e.prototype.canRelinquishMembership=function(){return this.relinquish_membership},e.prototype.canCreateEditLink=function(){return this.is_file_permissions&&this.create_edit_link},e.prototype.canCreateViewLink=function(){return this.is_file_permissions&&this.create_view_link},e.prototype.canUnshare=function(){return this.unshare},e.prototype.canUpdateConfidentiality=function(){return this.update_confidentiality},e})();t.Permissions=b;var I=(function(){function e(e){this._areMembersFullyLoaded=!1,this._areSharingPrefsLoaded=!1,this._hasDisplayableMembers=!1,this._isLinkMetadataLoaded=!1,this._isTeamPolicyLoaded=!1,this._shouldBlockMemberListOnPassLoad=!0,this._createdShareLink=!1,this._expUjMagnet2018SuggestableUserDataTimestamp=0,this._expUjMagnet2018ShouldLogExposure=l.EXP_UJ_MAGNET2018_LOGGED_VARIANTS.includes(f.UJ_MAGNET2018_ADMIN)||l.EXP_UJ_MAGNET2018_LOGGED_VARIANTS.includes(f.UJ_MAGNET2018_MEMBER),this._expUjMagnet2018LastEmails=[],this._user=e}return e.prototype._new_payload=function(e,n){switch(e){case c.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE:var r=n.member;this._members=this._members.setIn([r.type(),r.memberKey(),"access_type"],n.prevAccess);break;case c.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST:var r=n.member;this._members=this._members.setIn([r.type(),r.memberKey(),"access_type"],n.newAccess);break;case c.ShareModalActionTypes.CHANGE_RECIPIENTS:this._modalInfo.recipientTokens=n.recipientTokens,this._modalInfo.recipientRawInput=n.recipientRawInput;var i=void 0;n.recipientTokens.length>0||n.recipientRawInput.length>0?this.uiMode()===m.MODES.MEMBERSHIP&&(i=m.MODES.SHARE):this.uiMode()===m.MODES.SHARE&&(i=m.MODES.MEMBERSHIP),i&&(this._modalInfo.uiMode=i);break;case c.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS:this._modalInfo.recipientAccess=n.newAccess;break;case c.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE:this._modalInfo.recipientMessage=n.message;break;case c.ShareModalActionTypes.CHANGE_CREATE_COMMENT_CHECKBOX:this._modalInfo.createCommentOnShare=n.checked;break;case c.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO:this._members=this._members.update("users",function(e){return e.map(function(e){return e.set("time_last_seen",null)})});break;case c.ShareModalActionTypes.CREATE_LINK_REQUEST:this._createdShareLink=!0;break;case c.ShareModalActionTypes.CREATE_LINK_SUCCESS:this._linkMetadata=n.linkMetadata,this._sharedLinks=this.sharedLinks().concat(n.linkMetadata);break;case c.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS:this._memberCounts=n.memberCounts;break;case c.ShareModalActionTypes.FETCH_METADATA_FAILURE:this._fetchingMetadataPromise=void 0,this._modalInfo&&(this._modalInfo.uiMode=m.MODES.LINK_ONLY,this._modalInfo.linkOnlyReason!==m.LINK_ONLY_REASON.LINKS_PAGE&&(this._modalInfo.linkOnlyReason=n.reason));break;case c.ShareModalActionTypes.FETCH_METADATA_REQUEST:this._fetchingMetadataPromise=n.promise;break;case c.ShareModalActionTypes.FETCH_METADATA_SUCCESS:this._fetchingMetadataPromise=void 0,this.setMetadata(n.metadata),this._modalInfo&&n.metadata.path_lower&&a.isPointerByExtension(n.metadata.path_lower)&&(this._modalInfo.uiMode=m.MODES.POINTER);break;case c.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST:this._areSharingPrefsLoaded=!1;break;case c.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS:this._areSharingPrefsLoaded=!0;break;case c.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE:this._isLinkMetadataLoaded=!0,this._linkMetadata=void 0,this._sharedLinks=[];break;case c.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS:this._isLinkMetadataLoaded=!0;var o=n.sharedLinks?n.sharedLinks:[];this._linkMetadata=o.length>0?o[0]:null,this._sharedLinks=o;break;case c.ShareModalActionTypes.DELETE_LINK_METADATA_SUCCESS:for(var l=[],u=0,p=this.sharedLinks();u<p.length;u++){var _=p[u];_.url!==n.deletedLink.url&&l.push(_)}this._linkMetadata=l[0]?l[0]:null,this._sharedLinks=l;break;case c.ShareModalActionTypes.FETCH_USER_ACCOUNTS_REQUEST:this._fetchingMembersRequest={limitNonNull:n.limitNonNull,promise:n.promise,requestId:n.requestId};break;case c.ShareModalActionTypes.FETCH_USER_ACCOUNTS_SUCCESS:if(this._fetchingMembersRequest&&n.requestId!==this._fetchingMembersRequest.requestId)return!1;if(this._hasDisplayableMembers&&this._fetchingMembersRequest&&this._fetchingMembersRequest.limitNonNull<this._members.getMemberCount())return;this._hasDisplayableMembers=!0,n.members.cursor||(this._areMembersFullyLoaded=!0,this._fetchingMembersRequest=void 0),this._members=n.members;break;case c.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS:if(this._fetchingMembersRequest&&n.requestId!==this._fetchingMembersRequest.requestId)return!1;n.members.cursor||(this._areMembersFullyLoaded=!0,this._fetchingMembersRequest=void 0),this._members=this._members.mergeDeep(n.members);break;case c.ShareModalActionTypes.FETCH_TEAM_POLICY_REQUEST:this._isTeamPolicyLoaded=!1;break;case c.ShareModalActionTypes.FETCH_TEAM_POLICY_SUCCESS:this._isTeamPolicyLoaded=!0,this._teamPolicy=n.teamPolicy;break;case c.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_SUCCESS:this._memberCounts=new d.MemberCounts({total_unique_users:n.count,users_outside_team:0,exceeds_count:n.exceeds_limit});break;case c.ShareModalActionTypes.FETCH_TWO_LINK_REDESIGN:this._expTwoLinkRedesign=n;break;case c.ShareModalActionTypes.FETCH_PLUS_TO_PRO_TRIALS:this._expPlusToPro=n;break;case c.ShareModalActionTypes.FETCH_MAGNET2018_REQUEST:this._expUjMagnet2018SuggestableUserDataPromise=n.promise,this._expUjMagnet2018SuggestableUserDataTimestamp=n.ts,this._expUjMagnet2018LastEmails=n.emails;break;case c.ShareModalActionTypes.FETCH_MAGNET2018_SUCCESS:this._expUjMagnet2018ShouldLogExposure=this._expUjMagnet2018ShouldLogExposure&&!n.loggedExposure,n.ts>=this._expUjMagnet2018SuggestableUserDataTimestamp&&(this._expUjMagnet2018SuggestableUserDataPromise=void 0,this._expUjMagnet2018SuggestableUserData=n.suggestableUserData);break;case c.ShareModalActionTypes.FETCH_MAGNET2018_FAILURE:n.ts>=this._expUjMagnet2018SuggestableUserDataTimestamp&&(this._expUjMagnet2018SuggestableUserDataPromise=void 0,this._expUjMagnet2018SuggestableUserData=void 0);break;case c.ShareModalActionTypes.FETCH_LINK_SETTINGS_VARIANT:this._expLinkSettingsEmbed=n;break;case c.ShareModalActionTypes.FETCH_SHARE_MODAL_LINK_SETTINGS_VARIANT:this._expLinkSettingsShareModal=n;break;case c.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE:this._modalInfo.contentNameInputValue=n.name,this._modalInfo.contentNameMessageLevel=m.CONTENT_NAME_MESSAGE_LEVELS.INFO,this._modalInfo.contentNameMessage=""===n.name?m.CONTENT_NAME_EMPTY_TOOLTIP:void 0;break;case c.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE:this._modalInfo.isContentNameFocused=n.focus;break;case c.ShareModalActionTypes.MEMBER_ACTION_COMPLETE:
this._modalInfo.pendingMemberAction=this._modalInfo.pendingMemberAction.delete(n.member.memberKey());break;case c.ShareModalActionTypes.MEMBER_ACTION_PENDING:this._modalInfo.pendingMemberAction=this._modalInfo.pendingMemberAction.add(n.member.memberKey());break;case c.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS:var r=n.member;this._members=this._members.setIn([r.type(),r.memberKey(),"access_type"],n.access),this._modalInfo.pendingMemberAction=this._modalInfo.pendingMemberAction.delete(r.memberKey());break;case c.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS:var r=n.member;this._members=this._members.deleteIn([r.type(),r.memberKey()]),this._modalInfo.pendingMemberAction=this._modalInfo.pendingMemberAction.delete(r.memberKey());break;case c.ShareModalActionTypes.SEND_SHARE_FAILURE:this._modalInfo.uiMode=m.MODES.SHARE;break;case c.ShareModalActionTypes.SEND_SHARE_REQUEST:this._modalInfo.uiMode=m.MODES.SHARE_SENDING;break;case c.ShareModalActionTypes.SEND_SHARE_SUCCESS:this._modalInfo.uiMode=m.MODES.SHARE;break;case c.ShareModalActionTypes.SHARE_FOLDER_FAILURE:this._shareFolderPromise=void 0;break;case c.ShareModalActionTypes.SHARE_FOLDER_REQUEST:this._shareFolderPromise=n.promise;break;case c.ShareModalActionTypes.SHARE_FOLDER_SUCCESS:this.setMetadata(n.metadata),this._shareFolderPromise=void 0;break;case c.ShareModalActionTypes.SHARE_MODAL_CLOSE:this._expUjMagnet2018SuggestableUserData=void 0,this._expUjMagnet2018SuggestableUserDataPromise=void 0,this._expUjMagnet2018LastEmails=[],this._modalInfo.initialRecipientTokens=n.tokens||[],this._modalInfo.initialRecipientRawInput=n.value||"";break;case c.ShareModalActionTypes.SHARE_MODAL_OPEN:this.handleShareModalOpen(n);break;case c.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS:this._metadata=void 0,this._isLinkMetadataLoaded=!1,this._hasDisplayableMembers=!1;break;case c.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD:this._shouldBlockMemberListOnPassLoad=!1;break;case c.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS:this._modalInfo&&(this._modalInfo.hasChangedSharingSettings=!0),this.setMetadata(n.metadata);break;case c.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR:this._modalInfo.contentNameMessage=n.errorMsg,this._modalInfo.contentNameMessageLevel=m.CONTENT_NAME_MESSAGE_LEVELS.ERROR;break;case c.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS:var f=s.parent_dir(this.fqPath()),g=h.getNewFolderPathFromContentName(n.contentName,f);this._modalInfo.contentInfo=this._modalInfo.contentInfo.setFQPath(g),t.sharingInfoStore.mapContentIdsToSharingInfo(this._user.id,[g],this)}},e.prototype.handleShareModalOpen=function(e){this._modalInfo=new y(e.shareModalInfo.contentInfo),this._modalInfo.contentNameInputValue=e.initialProps.initialContentName,this._modalInfo.initialRecipientTokens=e.shareModalInfo.initialRecipientTokens||[],this._modalInfo.recipientMessage=e.initialProps.recipientMessage||"",this._modalInfo.onCreateGroupCallback=e.initialProps.onCreateGroupCallback;var t=this._user.role;this._modalInfo.createCommentOnShare="SEND_COMMENT_BY_DEFAULT"===_.SHARING_EXPERIMENTS.SPECTRUM_COMMENTS2_INTEGRATION_MODE[t],this._initialProps=e.initialProps,a.isPointerByExtension(this.displayPath())?this._modalInfo.uiMode=m.MODES.POINTER:e.shareModalInfo.inLinksPage&&(this._modalInfo.uiMode=m.MODES.LINK_ONLY,this._modalInfo.linkOnlyReason=m.LINK_ONLY_REASON.LINKS_PAGE),this._areMembersFullyLoaded=!1,!e.shareModalInfo.contentInfo.pathExists()&&!e.initialProps.initialContentName&&(this._modalInfo.isContentNameFocused=!0,this._modalInfo.contentNameMessage=m.CONTENT_NAME_EMPTY_TOOLTIP)},e.prototype.setMetadata=function(e){var n=e.permissions||this._metadata&&this._metadata.permissions;this._permissions=new b(n),this._metadata=e.set("permissions",n),this._modalInfo&&e.shared_folder_id&&(this._modalInfo.contentInfo=this._modalInfo.contentInfo.setNsId(e.shared_folder_id)),t.sharingInfoStore.mapContentIdsToSharingInfo(this._user.id,p.getContentIdsForMetadata(e),this)},e.prototype.user=function(){return this._user},e.prototype.hasNonOwnerMembers=function(){var e=this._members&&this._members.getMemberCount();if(!e)return!1;if(1===e&&1===this._members.users.count()){return this._members.users.first().account_id!==this._user.account_id}return!0},e.prototype.hasOutsideTeamMembers=function(){var e=this.memberCounts();return(e?e.users_outside_team:0)>0},e.prototype.memberNum=function(){var e=this.memberCounts(),t=this.members();return e&&e.total_unique_users?e.total_unique_users:t?t.getMemberCount():void 0},e.prototype.memberCountWithRecipients=function(){return(this.memberNum()||0)+h.getMemberCountForTokens(this.recipientTokens())},e.prototype.getInitialProps=function(){return this._initialProps},e.prototype.areMembersFullyLoaded=function(){return this._areMembersFullyLoaded===!0},e.prototype.areSharingPrefsLoaded=function(){return this._areSharingPrefsLoaded===!0},e.prototype.canShareLink=function(){return!this.isConfidentialFolder()&&!this.isTeamSharedFolder()&&this.contentInfo().pathExists()&&this.contentInfo().isMounted()},e.prototype.contactsError=function(){return this._expUjMagnet2018SuggestableUserDataPromise?{message:h.loadingIndicator(),level:h.ContactsErrorLevel.Warn}:h.validateContacts(this.recipientTokens(),this._user,this.ownerTeam(),this.folderPolicy(),this.isTeamSharedFolder(),this.isFolderInsideTeamFolderTree(),this.memberCountWithRecipients(),this.expUjMagnet2018SuggestableUserData(),this.contentInfo(),this.recipientMessage())},e.prototype.contentId=function(){return this._modalInfo.contentInfo.id},e.prototype.contentInfo=function(){return this._modalInfo.contentInfo},e.prototype.contentNameInputValue=function(){return this._modalInfo.contentNameInputValue},e.prototype.contentNameMessage=function(){return this._modalInfo.contentNameMessage},e.prototype.contentNameMessageLevel=function(){return this._modalInfo.contentNameMessageLevel},e.prototype.createCommentOnShare=function(){return this._modalInfo.createCommentOnShare},e.prototype.displayPath=function(){return this._modalInfo&&this._modalInfo.contentInfo&&this._modalInfo.contentInfo.displayPath()||this._metadata&&this._metadata.path_display||""},e.prototype.parentFolderName=function(){if(this.displayPath()){var e=this.displayPath().split("/");if(e.length>1)return e[e.length-2]}return""},e.prototype.expTwoLinkRedesign=function(){return this._expTwoLinkRedesign},e.prototype.expPlusToPro=function(){return this._expPlusToPro},e.prototype.expUjMagnet2018SuggestableUserData=function(){return this._expUjMagnet2018SuggestableUserData},e.prototype.expUjMagnet2018SuggestableUserDataPromise=function(){return this._expUjMagnet2018SuggestableUserDataPromise},e.prototype.expUjMagnet2018ShouldLogExposure=function(){return this._expUjMagnet2018ShouldLogExposure},e.prototype.expUjMagnet2018LastEmails=function(){return this._expUjMagnet2018LastEmails},e.prototype.expLinkSettingsEmbed=function(){return this._expLinkSettingsEmbed},e.prototype.expLinkSettingsShareModal=function(){return this._expLinkSettingsShareModal},e.prototype.fetchingMembersRequest=function(){return this._fetchingMembersRequest},e.prototype.fetchingMetadataPromise=function(){return this._fetchingMetadataPromise},e.prototype.filePolicy=function(){return this._metadata&&this._metadata.file_policy},e.prototype.folderPolicy=function(){return this._metadata&&this._metadata.policy},e.prototype.fqPath=function(){return this._modalInfo.contentInfo.displayPath()},e.prototype.hasChangedSharingSettings=function(){return this._modalInfo&&this._modalInfo.hasChangedSharingSettings},e.prototype.hasDisplayableMembers=function(){return this._hasDisplayableMembers},e.prototype.hasParentSharedFolder=function(){return this._metadata&&this._metadata.is_inside_team_folder},e.prototype.initialRecipientRawInput=function(){return this._modalInfo.initialRecipientRawInput},e.prototype.initialRecipientTokens=function(){return this._modalInfo.initialRecipientTokens},e.prototype.isNonUserRelativeContext=function(){return this.getInitialProps().isInContentManager},e.prototype.isFolder=function(){return this._modalInfo.contentInfo.isFolder()},e.prototype.isConfidentialFolder=function(){return Boolean(this._metadata&&this._metadata.is_confidential)},e.prototype.isContentNameFocused=function(){return this._modalInfo.isContentNameFocused},e.prototype.isFolderInsideTeamFolderTree=function(){return this._metadata&&this._metadata.is_inside_team_folder},e.prototype.isInsideSharedFolder=function(){return Boolean(this._metadata&&this._metadata.parent_shared_folder_id||this.contentInfo().isInSharedFolder())},e.prototype.isLinkMetadataLoaded=function(){return this._isLinkMetadataLoaded},e.prototype.isMetadataLoaded=function(){return Boolean(this._metadata)},e.prototype.isOwner=function(){return Boolean(this._metadata&&this._metadata.access_type===u.ACCESS_LEVEL.OWNER)},e.prototype.isOSXPackage=function(){var e=this.displayPath(),t=e.substr(e.lastIndexOf("."));return i.PACKAGE_EXTS.indexOf(t)>=0},e.prototype.isUserOnOwnerTeam=function(){return Boolean(this._metadata&&this._metadata.owner_team&&this._metadata.owner_team.id===this._user.team_dbtid)},e.prototype.isTeamPolicyLoaded=function(){return this._isTeamPolicyLoaded},e.prototype.isTeamSharedFolder=function(){return Boolean(this._metadata&&this._metadata.is_team_folder||this.contentInfo().isTeamSharedFolder())},e.prototype.isTokenizerEmpty=function(){return 0===this.recipientRawInput().length&&0===this.recipientTokens().length},e.prototype.linkMetadata=function(){return this._linkMetadata},e.prototype.sharedLinks=function(){return this._sharedLinks||[]},e.prototype.editRighteousLink=function(){return this.sharedLinks().filter(function(e){return"editor"===e.link_permissions.link_access_level})[0]},e.prototype.viewRighteousLink=function(){return this.sharedLinks().filter(function(e){return"viewer"===e.link_permissions.link_access_level})[0]},e.prototype.linkOnlyReason=function(){return this._modalInfo.linkOnlyReason},e.prototype.memberCounts=function(){return this._memberCounts},e.prototype.members=function(){return this._members},e.prototype.metadata=function(){return this._metadata},e.prototype.name=function(){var e=this._modalInfo&&this._modalInfo.contentInfo,t=this.metadata();return e&&e.name()||t&&t.name||""},e.prototype.ownerTeam=function(){return this._metadata&&this._metadata.owner_team},e.prototype.parentSharedFolderId=function(){return this._metadata&&this._metadata.parent_shared_folder_id},e.prototype.pendingMemberAction=function(){return this._modalInfo.pendingMemberAction},e.prototype.permissionsObj=function(){return this._permissions||new b},e.prototype.permissions=function(){return this._metadata&&this._metadata.permissions},e.prototype.recipientAccess=function(){return this._modalInfo&&this._modalInfo.recipientAccess?this._modalInfo.recipientAccess:this.permissionsObj().canInviteEditor()?u.ACCESS_LEVEL.WRITER:u.ACCESS_LEVEL.READER},e.prototype.recipientMessage=function(){return this._modalInfo.recipientMessage},e.prototype.onCreateGroupCallback=function(){return this._modalInfo.onCreateGroupCallback},e.prototype.recipientRawInput=function(){return this._modalInfo.recipientRawInput},e.prototype.recipientTokens=function(){return this._modalInfo.recipientTokens},e.prototype.shareAsConfidential=function(){return Boolean(this.getInitialProps().shareAsConfidential)},e.prototype.shareFolderPromise=function(){return this._shareFolderPromise},e.prototype.shouldBlockMemberListOnPassLoad=function(){return this._shouldBlockMemberListOnPassLoad},e.prototype.shouldSyncThisFolder=function(){return this.getInitialProps()?this.getInitialProps().shouldSyncThisFolder:null},e.prototype.teamPolicy=function(){return this._teamPolicy},e.prototype.uiMode=function(){return this._modalInfo.uiMode},e.prototype.createdShareLink=function(){return this._createdShareLink},e.prototype.isCloudDoc=function(){return!(!this._metadata||!this._metadata.is_cloud_doc)},e.prototype.isTwoLinkRedesignEnabled=function(){var e=this.expTwoLinkRedesign();return!!e&&e.is_active&&"ON"===e.variant},e.prototype.isMultipleLinkInterfaceEnabled=function(){return this.isCloudDoc()||this.isTwoLinkRedesignEnabled()},e.prototype.isPlusToProTrialEnabled=function(){var e=this.expPlusToPro();return!!e&&e.is_active&&"ON"===e.variant},e.prototype.hasShowcaseFreemium=function(){return _.SHOWCASE.HAS_SHOWCASE_FREEMIUM},e.prototype.hasCreatedShowcase=function(){return _.SHOWCASE.HAS_CREATED_SHOWCASE},e})();t.SharingInfo=I;var y=(function(){function e(e){this.canRelinquishMembership=!1,this.contentNameInputValue="",this.contentNameMessageLevel=m.CONTENT_NAME_MESSAGE_LEVELS.INFO,this.createCommentOnShare=!1,this.hasChangedSharingSettings=!1,this.initialRecipientRawInput="",this.initialRecipientTokens=[],this.isContentNameFocused=!1,this.isCloudDoc=!1,this.pendingMemberAction=r.Set(),this.recipientMessage="",this.recipientRawInput="",this.recipientTokens=[],this.shareAsConfidential=!1,this.uiMode=m.MODES.MEMBERSHIP,this.contentInfo=e}return e})();t.SharingModalInfo=y}),define("modules/clean/sharing/stores/sharing_info_util",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContentIdsForMetadata=function(e){return[e.shared_folder_id,e.id,e.path_lower].filter(Boolean)},t.getContentIdsForContentInfo=function(e){var t=[];return e.isSharedFolder()?t.push(e.sharedFolderId()):(e.extras.fileId&&t.push(e.extras.fileId),e.extras.nsId&&e.extras.nsPath&&t.push("ns:"+e.nsId()+e.nsPath())),e.displayPath()&&t.push(e.displayPath()),t}}),define("modules/clean/sharing/strings",["require","exports","tslib","modules/clean/sharing/access_level","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=n.__importStar(s);var a,o,l,c,d,u,p,h=s.i18n_default_project("sharing")._,m=(a={},a[r.ACCESS_LEVEL.OWNER]=h("Owner"),a[r.ACCESS_LEVEL.WRITER]=h("Can edit"),a[r.ACCESS_LEVEL.READER]=h("Can view"),a[r.ACCESS_LEVEL.READER_NO_COMMENT]=h("View-only"),a);t.ACCESS_NAME=m;var _=(o={},o[r.ACCESS_LEVEL.OWNER]=h("Owner"),o[r.ACCESS_LEVEL.WRITER]=h("Can edit"),o[r.ACCESS_LEVEL.READER]=h("Can comment"),o[r.ACCESS_LEVEL.READER_NO_COMMENT]=h("Can view"),o);t.ACCESS_NAME_NO_COMMENT=_;var f=(l={},l[i.MEMBER_ACTION.MAKE_EDITOR]=h("People can edit, delete, comment, and add the files to their Dropbox"),l[i.MEMBER_ACTION.MAKE_VIEWER]=h("People can view, download, and comment"),l[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]=h("People can only view and download the files"),l);t.MEMBER_ACTION_FOLDER=f;var g=(c={},c[i.MEMBER_ACTION.MAKE_EDITOR]=h("People can edit, delete, comment, and add the file to their Dropbox"),c[i.MEMBER_ACTION.MAKE_VIEWER]=h("People can view, download, and comment"),c[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]=h("People can only view and download the file"),c);t.MEMBER_ACTION_FILE=g;var S=(d={},d[i.MEMBER_ACTION.MAKE_EDITOR]=h("People can edit and comment"),d[i.MEMBER_ACTION.MAKE_VIEWER]=h("People can view and comment"),d);t.MEMBER_ACTION_CLOUD_DOC=S;var E=(u={},u[i.MEMBER_ACTION.MAKE_EDITOR]=h("Lets them view, comment, and edit."),u[i.MEMBER_ACTION.MAKE_VIEWER]=h("Lets them view and comment, but not edit."),u[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]=h("Lets them view only. They can’t see comments."),u);t.MEMBER_ACTION_FOLDER_NO_COMMENT=E;var v=(p={},p[i.MEMBER_ACTION.MAKE_EDITOR]=h("Lets them view, comment, and edit."),p[i.MEMBER_ACTION.MAKE_VIEWER]=h("Lets them view and comment, but not edit."),p[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]=h("Lets them view only. They can’t see comments."),p);t.MEMBER_ACTION_FILE_NO_COMMENT=v}),define("modules/clean/sharing/views/constants",["require","exports","tslib","external/lodash","modules/core/i18n"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importStar(i);var s,a=i.i18n_default_project("sharing")._;(function(e){e[e.NO_MEMBERS=0]="NO_MEMBERS",e[e.INPUT_CONTENT_NAME=1]="INPUT_CONTENT_NAME"})(s=t.BANNERS||(t.BANNERS={}));var o;(function(e){e[e.INFO=0]="INFO",e[e.ERROR=1]="ERROR"})(o=t.CONTENT_NAME_MESSAGE_LEVELS||(t.CONTENT_NAME_MESSAGE_LEVELS={}));var l;(function(e){e.LINK_ONLY="link-only",e.LOADING="loading",e.MEMBERSHIP="membership",e.POINTER="pointer",e.SHARE="share",e.SHARE_SENDING="share-sending"})(l=t.MODES||(t.MODES={}));(function(e){e.INSIDE_SHARED_FOLDER="inside_shared_folder",e.CONTAINS_SHARED_FOLDER="contains_shared_folder",e.LINKS_PAGE="links_page"})(t.LINK_ONLY_REASON||(t.LINK_ONLY_REASON={})),t.CONTENT_NAME_EMPTY_TOOLTIP=a("Name your shared folder"),t.MODE_VALUES=r.values(l),t.BANNER_VALUES=r.values(s),t.CONTENT_NAME_MESSAGE_LEVEL_VALUES=r.values(o)}),define("modules/clean/sharing/views/exp_pro_bundle_tracker",["require","exports","modules/clean/growth/user_action/tracker"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerProps=n.TrackerProps,t.trackerProject="uj_showcase_upsell",t.proBundleFeatureName="sharegrowth_pro_bundle",t.withProBundleTracking=n.withGrowthTracking(t.trackerProject);(function(e){e.VIEW="sharegrowth_pro_bundle__view",e.CLICK_CTA="sharegrowth_pro_bundle__click_cta"})(t.ProBundleTrackerActions||(t.ProBundleTrackerActions={}))}),define("modules/clean/sharing/views/exp_pro_bundle_upsell",["require","exports","tslib","modules/clean/react/tooltip","modules/core/browser","modules/clean/react/image","modules/clean/react/button","react","modules/clean/react/css","modules/core/i18n","modules/constants/trademark","modules/clean/static_urls","modules/clean/sharing/views/exp_pro_bundle_tracker"],function(e,t,n,r,i,s,a,o,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),o=n.__importStar(o),t.ProBundleUpsellHeader=function(e){var i=o.createElement("div",{className:"pro-bundle-upsell-header"},o.createElement("div",null,c._("What’s included in %(trademark_dbx_professional)s?").format({trademark_dbx_professional:d.DROPBOX_PROFESSIONAL})),o.createElement("div",{className:"pro-bundle-upsell-header__icon"},o.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},o.createElement("g",{fill:"none",fillRule:"evenodd"},o.createElement("path",{d:"M12 20a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-1.5a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13z",fill:"#B4BBC2"}),o.createElement("path",{stroke:"#B4BBC2",d:"M11.5 12h1v3.5h-1zM11.5 8.5h1v1h-1z"}))))),s=n.__assign({showHeader:!1,element:i,position:r.TooltipPosition.BOTTOM},e);return o.createElement(t.ProBundleUpsellTooltip,n.__assign({},s))};var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logProBundleTooltipShow=function(){t.expProBundleTrack(p.ProBundleTrackerActions.VIEW)},t.onButtonClickHandler=function(){t.expProBundleTrack(p.ProBundleTrackerActions.CLICK_CTA),i.redirect("/buy/professional?_tk=sg_pro_bundle_tooltip")},t}return n.__extends(t,e),t.prototype.expProBundleTrack=function(e){this.props.track(e)},t.prototype.renderProBundleTooltipContent=function(){var e=o.createElement("div",{className:"pro-bundle-upsell-tooltip__header"},o.createElement("div",{className:"pro-bundle-upsell-tooltip__header-title"},c._("Professional Only Feature")),o.createElement("div",{className:"pro-bundle-upsell-tooltip__header-subtitle"},c._("What’s included in %(trademark_dbx_professional)s:").format({trademark_dbx_professional:d.DROPBOX_PROFESSIONAL})));return o.createElement("div",{className:"pro-bundle-upsell-tooltip"},this.props.showHeader?e:null,o.createElement("div",{className:"pro-bundle-upsell-tooltip__item"},o.createElement(s.Image,{src:u.static_url("/static/images/sharing/share_growth/folder-vfl-ZpgoZ.png"),alt:c._("Folder icon"),width:12,className:"pro-bundle-upsell-tooltip__item-icon pro-bundle-upsell-tooltip__item-icon-space"}),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text-container"},o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text"},c._("More space.")),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-subtext"},c._("Get plenty of storage for all of your work.")," "))),o.createElement("div",{className:"pro-bundle-upsell-tooltip__item"},o.createElement(s.Image,{src:u.static_url("/static/images/sharing/share_growth/download-vfl4Xd3kD.png"),alt:c._("Download icon"),width:12,className:"pro-bundle-upsell-tooltip__item-icon pro-bundle-upsell-tooltip__item-icon-sync"}),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text-container"},o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text"},c._("Smart sync.")),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-subtext"},c._("Access all of your files from your desktop, without taking up all your hard drive space.")))),o.createElement("div",{className:"pro-bundle-upsell-tooltip__item"},o.createElement(s.Image,{src:u.static_url("/static/images/sharing/magnet/lock_icon-vflACHeZZ.svg"),alt:c._("Lock icon"),width:12,className:"pro-bundle-upsell-tooltip__item-icon pro-bundle-upsell-tooltip__item-icon-share"}),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text-container"},o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text"},c._("Sharing Controls.")),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-subtext"},c._("Manage the visibility, access, and download permissions of everything you share.")))),o.createElement("div",{className:"pro-bundle-upsell-tooltip__item"},o.createElement(s.Image,{src:u.static_url("/static/images/sharing/share_growth/showcase-vflnrZJ2i.png"),alt:c._("Showcase icon"),width:12,className:"pro-bundle-upsell-tooltip__item-icon pro-bundle-upsell-tooltip__item-icon-showcase"}),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text-container"},o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-text"},c._("Showcase.")),o.createElement("span",{className:"pro-bundle-upsell-tooltip__item-subtext"},c._("Share your work with customized branding and track who engages with your files.")))),o.createElement("div",{className:"pro-bundle-upsell-tooltip__upgrade-button-container"},o.createElement(a.Button,{className:"pro-bundle-upsell-tooltip__upgrade-button",onClick:this.onButtonClickHandler},c._("Upgrade to Professional"))))},t.prototype.render=function(){return o.createElement(r.Tooltip,{position:this.props.position,tooltip_classname:"pro-bundle-upsell-tooltip",tooltip_contents:this.renderProBundleTooltipContent(),on_show:this.logProBundleTooltipShow,interaction_enabled:!0,hide_delay:100},this.props.element)},t})(o.Component);t.ProBundleUpsellTooltipComponent=h,t.ProBundleUpsellTooltip=l.requireCssWithComponent(p.withProBundleTracking(h),["/static/css/growth/showcase_upsell/pro_bundle-vflyZBquU.css","/static/css/legacy_packages/components-vflbDMbD3.css"])}),define("modules/clean/sharing/views/exp_showcase_share_interstitial",["require","exports","tslib","react","spectrum/modal","modules/clean/bem","modules/clean/growth/user_action/tracker","modules/clean/react/css","modules/clean/react/modal","modules/clean/static_urls","modules/clean/account/email","modules/core/i18n","modules/clean/account/email_verify_reasons"],function(e,t,n,r,i,s,a,o,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),p=n.__importStar(p);(function(e){e.CONTROL="CONTROL",e.V1="V1"})(t.ShowcaseInterstitialVariants||(t.ShowcaseInterstitialVariants={}));var h;(function(e){e.CLOSE="uj_showcase_share_interstitial__close",e.VIEW="uj_showcase_share_interstitial__view",e.CLICK_SHARE="uj_showcase_share_interstitial__click_share",e.CLICK_SHOWCASE="uj_showcase_share_interstitial__click_showcase"})(h=t.ShowcaseInterstitialEvents||(t.ShowcaseInterstitialEvents={}));var m=s.bem("showcase-share-interstitial");t.showShowcaseInterstitial=function(e){if(!e.user.is_email_verified){return d.EmailVerification.getForRole(e.user.role).show_verify_modal(null,p.SHARE_FOLDER)}l.Modal.showInstance(r.createElement(t.ShowcaseShareInterstitial,n.__assign({},e)))};var _=(function(e){function t(t){var n=e.call(this,t)||this;return n.onRequestClose=function(){n.props.track(h.CLOSE),n.setState({open:!1})},n.onClickShare=function(e){e.preventDefault(),n.props.track(h.CLICK_SHARE),n.props.onClickShare()},n.onClickShowcase=function(e){e.preventDefault(),n.props.track(h.CLICK_SHOWCASE),n.props.onClickShowcase()},n.state={open:!0},n}return n.__extends(t,e),t.prototype.render=function(){var e=this.state.open;return r.createElement(i.Modal,{open:e,className:m(),ariaLabel:u._("Choose a way to share"),onRequestClose:this.onRequestClose,displayCloseButton:!0},r.createElement("div",{className:m("content")},r.createElement("span",{className:m("title")},r.createElement("div",null,u._("Find the best way to share.")),r.createElement("div",null,u._("What’s the main reason you’re sharing this file?"))),r.createElement("div",{className:m("options")},r.createElement("button",{className:m("option","sharing"),onClick:this.onClickShare},r.createElement("div",{className:m("option-img-wrapper")},r.createElement("img",{className:m("option-img"),src:c.static_url("/static/images/growth/showcase_upsell/create_and_collaborate@2x-vfljEt8Rt.png"),alt:""})),r.createElement("span",{className:m("option-name")},u._("To collaborate")),r.createElement("span",{className:m("option-desc")},u._("Work on this file with other people. Swap ideas,\n                get feedback, and keep everyone in sync."))),r.createElement("button",{className:m("option","showcase"),onClick:this.onClickShowcase},r.createElement("div",{className:m("option-img-wrapper")},r.createElement("img",{className:m("option-img"),src:c.static_url("/static/images/growth/showcase_upsell/try_showcase@2x-vfle_w-WK.png"),alt:""})),r.createElement("span",{className:m("option-name")},u._("To display or present work")),r.createElement("span",{className:m("option-desc")},u._("Share in a visual layout. Present work with your logo\n                and branding, and let people comment on it."))))))},t})(r.Component);t.ShowcaseShareInterstitialComponent=_,t.ShowcaseShareInterstitial=a.withGrowthTracking("uj_showcase_upsell",{mount:h.VIEW})(o.requireCssWithComponent(_,["/static/css/growth/showcase_upsell/showcase_share_interstitial-vfli-2had.css"]))}),define("modules/clean/sharing/views/inherited_members",["require","exports","tslib","external/classnames","react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/snackbar","modules/clean/react/sprite","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/views/inherited_members_helpers","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/core/i18n","spectrum/icon_content","spectrum/modal"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),a=n.__importStar(a);var g=i.default.createElement,S=(function(e){function t(t){var n=e.call(this,t)||this;return n.onToggleShowMemberList=function(){0!==n.props.members.length&&n.setState({areMembersExpanded:!n.state.areMembersExpanded})},n.handleToggleInheritanceClick=function(e){n.props.actionHandler.handleSetConfidentialClick(!1,n.props.ownerTeamName)},n.state={areMembersExpanded:!1},n}return n.__extends(t,e),t.prototype.renderMembersList=function(){return this.state.areMembersExpanded?i.default.createElement("div",null,i.default.createElement("div",{className:"u-mar-top-xs u-mar-horizontal-xs u-pad-top-xs inherited-member-list__divider"}),i.default.createElement("div",null,i.default.createElement("ul",{className:"u-pad-horizontal-s u-pad-vertical-xs inherited-member-list__member"},this.props.children))):void 0},t.prototype.renderRemoveButton=function(){return this.props.canUpdateConfidentiality?i.default.createElement("button",{className:"inherited-member-list__remove-button button-as-link",onClick:this.handleToggleInheritanceClick},m._("Remove",{comment:"Shown on button that can be clicked to remove access to subfolder"})):void 0},t.prototype.renderTriangle=function(){return 0===this.props.members.length?i.default.createElement("div",{className:"u-pad-horizontal-xs"}):i.default.createElement("a",{href:"#",className:"u-pad-horizontal-xxs o-flag__fix inherited-member-list__triangle",onClick:this.onToggleShowMemberList},g(l.Sprite,{alt:m._("Toggle whether inherited members are displayed or hidden"),group:"web",name:this.state.areMembersExpanded?"triangle_open_1x":"triangle_closed_1x"}))},t.prototype.render=function(){var e,t=a.parent_dir(this.props.actionHandler.getSharingInfo().displayPath());if("/"===t)e=m._("Members of %(team_name)s shared workspace").format({team_name:s.Emstring.em_snippet(this.props.ownerTeamName,d.SNIPPET_SIZES.DISPLAY_NAME)});else{var n=a.filename(t);e=m._("Members of “%(folder_name)s” folder").format({folder_name:s.Emstring.em_snippet(n,d.SNIPPET_SIZES.FILENAME)})}var o=0,l=null;this.props.memberCounts&&(l=this.props.contentInfo.isSharedFolder()?this.props.memberCounts.total_unique_inherited_members:this.props.memberCounts.total_unique_users),null!=l?o=l:this.props.members.forEach(function(e){e instanceof c.GroupMembershipInfo?o+=e.member_count:o++});var u=m.ungettext("%(members_count)s member","%(members_count)s members",o).format({members_count:o}),p=r.default([{"u-mar-bottom-xs":!0,"inherited-member-list__outer-expanded":this.state.areMembersExpanded,"inherited-member-list__outer-closed":!this.state.areMembersExpanded,"inherited-member-list__outer-spectrum":!0}]),h=r.default([{"inherited-member-list__inner":!this.state.areMembersExpanded}]);return i.default.createElement("div",{className:p},i.default.createElement("div",{className:h},i.default.createElement("div",{className:"o-flag inherited-member-list__toggle-show-member",onClick:this.onToggleShowMemberList},this.renderTriangle(),i.default.createElement("div",{className:"o-flag__flex u-pad-vertical-xs u-pad-right-s"},i.default.createElement("div",{className:"o-flag"},i.default.createElement("div",{className:"o-flag__fix"},i.default.createElement(_.IconContent,{name:"folder_shared-small"})),i.default.createElement("div",{className:"o-flag__flex u-pad-left-s"},i.default.createElement("div",{className:"inherited-member-list__member-str u-font-strong"},e),i.default.createElement("div",{className:"inherited-member-list__member-count-str u-font-meta"},u)),i.default.createElement("div",{className:"o-flag__fix u-pad-right-xxs"},this.renderRemoveButton())))),i.default.createElement("div",null,this.renderMembersList())))},t})(i.default.Component);t.InheritedMembers=S;var E=(function(e){function t(t){var n=e.call(this,t)||this;n._onToggleConfidentialFolderFalse=function(){n._onToggleConfidentialFolder(!1)},n.state={isAccepting:!1};var r=t.actionHandler.getSharingInfo().displayPath(),i=t.actionHandler.getSharingInfo().parentFolderName();return n.contentGenerator=new u.SetInheritedMembersUIConfidentialModalContentGenerator(t.initialIsConfidentialFolder,r,t.teamName,i),n}return n.__extends(t,e),t.prototype._onToggleConfidentialFolder=function(e){var t=this,n=!e,r=e===this.props.initialIsConfidentialFolder;e||this.setState({isAccepting:!0});var s=this.props,a=s.actionHandler,l=s.contentInfo;o.Snackbar.sync(this.contentGenerator.syncSnackMessage(r),!0);var c=l.isSharedFolder();return a.handleSetConfidential(r).then(function(e){a.fetchDataAndShowShareModal(),r&&p.WebUserActionLog.log(t.props.userId,n?h.WebUserActionLogEvent.CONF_BY_MANAGE_ACCESS:h.WebUserActionLogEvent.CONF_BY_UNDO_AFTER_RESTORE_ACCESS,{ns_id:e.shared_folder_id,original_folder_type:c?h.WebUserActionLogExtraValue.SHARED_FOLDER:h.WebUserActionLogExtraValue.FILE_FOLDER})}).then(function(){var e=t.contentGenerator.completeSnackMessage(r);if(!n)return void o.Snackbar.complete(e);o.Snackbar.show(i.default.createElement(o.Snackbar,{title:e,timeoutDelayMs:1e4,actionButtonText:m._("Undo"),onActionClick:function(){return t._onToggleConfidentialFolder(!0)},closeButtonText:m._("Close"),variant:"complete"}))}).catch(function(e){
return u.handleApiError(e,t.contentGenerator.failSnackMessage(r),function(){return t.setState({isAccepting:!1})})})},t.prototype.render=function(){return i.default.createElement(f.UtilityModal,{ariaLabel:this.contentGenerator.getTitleContent(),title:this.contentGenerator.getTitleContent(),overlayClickClose:!0,primaryAction:this.contentGenerator.getActionString(),secondaryAction:m._("Cancel"),onPrimaryAction:this._onToggleConfidentialFolderFalse,onSecondaryAction:this.props.onCancel,open:!0,onRequestClose:this.props.onCancel,overlayClassName:"file-viewer-modal-overlay"},this.contentGenerator.getBodyContent())},t})(i.default.Component);t.SetInheritedMembersUIConfidentialModal=E;var v=(function(e){function t(t){var n=e.call(this,t)||this;n.actionCompleteCallback=function(){var e=n.props.actionHandler;o.Snackbar.complete(n.contentGenerator.getSnackBarCompleteString()),n.setState({removing:!1}),e.fetchDataAndShowShareModal()},n.removeTheSelectedMember=function(){var e=n.props,t=e.member,r=e.actionHandler,i=e.isUserSelf,s=r.getContentInfo().id;return i?r.relinquishMembershipSimple(s,!1):r.removeMemberSimple(s,t.memberId(),!1)},n.changeAccessOfSelectedMember=function(){var e=n.props,t=e.newAccessLevel,r=e.actionHandler,i=e.member,s=t;return r.changeMemberAccessSimple(r.getContentInfo().id,i.memberId(),s)},n.changeConfidentialAccess=function(){var e=n.props,t=e.actionHandler,r=e.userId,i=e.isSharedFolder,s=e.isDowngrading;n.setState({removing:!0});var a=function(){return s?n.changeAccessOfSelectedMember():n.removeTheSelectedMember()};return t.shareIfFileFolder(n.contentGenerator.getSnackBarRemovingString()).then(function(){return t.handleSetConfidential(!0,!0).then(function(){return n.logWebUserAction(r,s,t.getContentInfo().id,i)})}).then(a).then(n.actionCompleteCallback).catch(function(e){return u.handleApiError(e,n.contentGenerator.getSnackBarFailString(),function(){return n.setState({removing:!1})})})},n.state={removing:!1};var r=n.props,i=r.member,s=r.teamName,a=r.parentFolderName,l=r.currentFolderName,d=r.isDowngrading,p=r.isUserSelf;return n.contentGenerator=new u.SingleInheritedUserAccessChangeModalContentGenerator(d,s,a,l,i.displayName()||"",i instanceof c.GroupMembershipInfo,p),n}return n.__extends(t,e),t.prototype.render=function(){return i.default.createElement(f.UtilityModal,{ariaLabel:this.contentGenerator.getConfirmModalTitleString(),title:this.contentGenerator.getConfirmModalTitleString(),overlayClickClose:!0,primaryAction:this.contentGenerator.getButtonText(),secondaryAction:m._("Cancel"),onPrimaryAction:this.changeConfidentialAccess,onSecondaryAction:this.props.actionHandler.openShareModal,open:!0,onRequestClose:this.props.actionHandler.openShareModal,overlayClassName:"file-viewer-modal-overlay"},this.renderBody())},t.prototype.renderBody=function(){return i.default.createElement("div",null,i.default.createElement("div",{className:"confirmation-modal__content"},this.contentGenerator.getConfirmModalContent()),i.default.createElement("br",null))},t.prototype.logWebUserAction=function(e,t,n,r){p.WebUserActionLog.log(e,t?h.WebUserActionLogEvent.CONF_BY_DOWNGRADE_MEMBER:h.WebUserActionLogEvent.CONF_BY_REMOVE_MEMBER,{ns_id:n,original_folder_type:r?h.WebUserActionLogExtraValue.SHARED_FOLDER:h.WebUserActionLogExtraValue.FILE_FOLDER})},t})(i.default.Component);t.SingleInheritedUserAccessChangeModal=v}),define("modules/clean/sharing/views/inherited_members_helpers",["require","exports","tslib","react","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/filepath","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/sharing/constants","modules/core/i18n","modules/core/notify"],function(e,t,n,r,i,s,a,o,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a);t.handleApiError=function(e,t,n){i.catchApiError(function(){return n&&n(),c.Snackbar.close(),e instanceof i.ServerError?c.Snackbar.fail(t):l.Modal.close(),p.Notify.error(e.message||u._("We were unable to complete your request.")),e})(e)};var h=(function(){function e(e,t,n,r){this.initialIsConfidentialFolder=e,this.teamName=n;var i=a.parent_dir(t);this.folderName=a.filename(t),this.topMostLevelFolder="/"===i,this.parentFolderName=r,this.folderSnippet=s.Emstring.em_snippet(this.folderName,15),this.parentFolderSnippet=s.Emstring.em_snippet(this.parentFolderName,15),this.teamSnippet=s.Emstring.em_snippet(this.teamName,d.SNIPPET_SIZES.DISPLAY_NAME)}return e.prototype.getActionString=function(){var e=s.Emstring.em_snippet(this.teamName,d.SNIPPET_SIZES.DISPLAY_NAME),t=this.topMostLevelFolder?u._("Share with %(team_name)s").format({team_name:e}):u._("Share");return this.initialIsConfidentialFolder?t:u._("Remove")},e.prototype.getTitleContent=function(){return this.initialIsConfidentialFolder?this.topMostLevelFolder?u._("Share “%(folder_name)s” with everyone at %(team_name)s?").format({folder_name:this.folderSnippet,team_name:this.teamSnippet}):u._("Share “%(folder_name)s” with everyone who can access “%(parent_folder_name)s”?").format({folder_name:this.folderSnippet,parent_folder_name:this.parentFolderSnippet}):this.topMostLevelFolder?u._("Remove members of %(team_name)s?").format({team_name:this.teamSnippet}):u._("Remove members of “%(folder_name)s” folder?").format({folder_name:this.parentFolderSnippet})},e.prototype.getBodyContent=function(){var e;return e=this.initialIsConfidentialFolder?this.topMostLevelFolder?o.reactFormat(u._("<strong>%(folder_name)s</strong> won’t be shared privately any more.\n             Everyone at %(team_name)s will have access to this folder.").format({team_name:this.teamSnippet,folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):o.reactFormat(u._("Everyone who can access <strong>%(parent_folder_name)s</strong> will be able to access this folder.").format({parent_folder_name:this.parentFolderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):this.topMostLevelFolder?o.reactFormat(u._("Members of %(team_name)s won’t be able to access <strong>%(folder_name)s</strong>.").format({team_name:this.teamSnippet,folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):o.reactFormat(u._("Members of <strong>%(parent_folder_name)s</strong> folder won’t be able to access\n             <strong>%(folder_name)s</strong>.").format({parent_folder_name:this.parentFolderSnippet,folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}),r.default.createElement("div",null,r.default.createElement("div",{className:"confirmation-modal__content"},e),r.default.createElement("br",null))},e.prototype.syncSnackMessage=function(e){return e?o.reactFormat(u._("Removing members from <strong>%(folder_name)s</strong>…").format({folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):this.topMostLevelFolder?o.reactFormat(u._("Sharing <strong>%(folder_name)s</strong> with everyone…").format({folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):o.reactFormat(u._("Sharing <strong>%(folder_name)s</strong> with members of <strong>%(parent_folder_name)s</strong>…").format({folder_name:this.folderSnippet,parent_folder_name:this.parentFolderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})})},e.prototype.completeSnackMessage=function(e){return e?o.reactFormat(u._("Members removed from <strong>%(folder_name)s</strong>.").format({folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):this.topMostLevelFolder?o.reactFormat(u._("<strong>%(folder_name)s</strong> shared with everyone.").format({folder_name:this.folderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})}):o.reactFormat(u._("<strong>%(folder_name)s</strong> shared with members of <strong>%(parent_folder_name)s</strong>.").format({folder_name:this.folderSnippet,parent_folder_name:this.parentFolderSnippet}),{strong:r.default.createElement("strong",{style:{fontWeight:500}})})},e.prototype.failSnackMessage=function(e){return e?u._("Couldn’t remove members. Try removing them again."):u._("Couldn’t share folder. Try sharing again.")},e})();t.SetInheritedMembersUIConfidentialModalContentGenerator=h;var m=(function(){function e(e,t,n,i,s,a,l){var c=this;this.getButtonText=function(){return c.isDowngrading?u._("Change access"):c.isTsdPlusOne?u._("Remove everyone"):u._("Remove")},this.getConfirmModalTitleString=function(){return c.isRelinquishment?u._("Remove yourself from “%(parent_folder)s”?").format({parent_folder:c.parentFolderName}):c.isDowngrading?u._("Change how members can access “%(current_folder)s”?").format({current_folder:c.currentFolderName}):c.isTsdPlusOne?u._("Remove everyone at %(team_name)s?").format({team_name:c.teamName}):u._("Remove a member of “%(parent_folder)s”?").format({parent_folder:c.parentFolderName})},this.getConfirmModalTitle=function(){var e={current_folder:c.currentFolderName,parent_folder:c.parentFolderName,team_name:c.teamName,b:r.default.createElement("b",{style:{fontWeight:500}})},t="";return t=c.isRelinquishment?u._("<b>Remove yourself from “%(parent_folder)s”?</b>"):c.isDowngrading?u._("<b>Change how members can access “%(current_folder)s”?</b>"):c.isTsdPlusOne?u._("<b>Remove everyone at %(team_name)s?</b>"):u._("<b>Remove a member of “%(parent_folder)s”?</b>"),o.reactFormat(t,e)},this.getConfirmModalContent=function(){var e={member_name:c.memberName,parent_folder:c.parentFolderName,current_folder:c.currentFolderName,team_name:c.teamName,b:r.default.createElement("b",{style:{fontWeight:500}}),br:r.default.createElement("br",null)},t="";return t=c.isRelinquishment?u._("You won’t be able to see future changes to this shared folder, and new members of <b>%(parent_folder)s</b> won’t have access to this folder automatically."):c.isTsdPlusOne?c.isDowngrading?u._("%(member_name)s will only be able to view this folder, and new %(team_name)s members won’t be able to access it automatically.<br/>To add more people to this folder in the future, you’ll need to invite them directly."):u._("%(team_name)s members won’t be able to see future changes to <b>%(current_folder)s</b> automatically.<br/>To give people access to this folder in the future, you’ll need to invite them directly."):c.isDowngrading?u._("%(member_name)s will only be able to view this folder, and new members of <b>%(parent_folder)s</b> won’t be able to access it automatically.<br/>To add more people to this folder in the future, you’ll need to invite them directly."):u._("%(member_name)s and new members of the <b>%(parent_folder)s</b> folder, won’t be able to see future changes to this shared folder.<br/>To add more people to this folder in the future, you’ll need to invite them directly."),o.reactFormat(t,e)},this.getSnackBarRemovingString=function(){var e={b:r.default.createElement("b",{style:{fontWeight:500}}),current_folder:c.currentFolderName},t=c.isDowngrading?u._("Changing access for <b>%(current_folder)s</b>…"):c.memberIsGroup?u._("Removing members from <b>%(current_folder)s</b>…"):u._("Removing member from <b>%(current_folder)s</b>…");return o.reactFormat(t,e)},this.getSnackBarCompleteString=function(){var e={b:r.default.createElement("b",{style:{fontWeight:500}}),current_folder:c.currentFolderName},t=c.isDowngrading?u._("Access changed for <b>%(current_folder)s</b>."):c.memberIsGroup?u._("Members removed from <b>%(current_folder)s</b>."):u._("Member removed from <b>%(current_folder)s</b>.");return o.reactFormat(t,e)},this.getSnackBarFailString=function(){return c.isDowngrading?u._("Couldn’t change access. Try changing access again."):c.memberIsGroup?u._("Couldn’t remove members. Try removing them again."):u._("Couldn’t remove member. Try removing them again.")},this.isDowngrading=e,this.teamName=t,this.parentFolderName=n,this.currentFolderName=i,this.memberName=s,this.isTsdPlusOne=""===n,this.memberIsGroup=a,this.isRelinquishment=l}return e})();t.SingleInheritedUserAccessChangeModalContentGenerator=m}),define("modules/clean/sharing/views/member_list",["require","exports","tslib","external/immutable","external/classnames","react","modules/clean/filepath","modules/clean/sharing/access_level","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/member_list_item","modules/clean/sharing/views/viewer_info","modules/clean/sharing/ui_util","modules/clean/viewer","modules/core/i18n","modules/clean/sharing/views/wrapped_group_viewers_maker","modules/clean/react/pass/store"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),s=n.__importDefault(s),a=n.__importStar(a),_=n.__importStar(_);var S=_.i18n_default_project("sharing")._,E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderMembersListItem=function(e,n,r){var i=e.memberKey(),a=t.props.groupSeenStateInfo[e.memberId()]?t.renderWrappedGroupViewersElement(e):void 0,l=t.props.canUpdateConfidentiality&&e.is_inherited,d=!!l||t.props.canRelinquishMembership,p=function(n){var r=n===c.MEMBER_ACTION.REMOVE,i=!r&&o.isLowerAccess(e.access_type,n),s=r||i&&e.inherited_access_type&&o.isLowerAccess(e.inherited_access_type,n);if(l&&s){var a=t.props.ownerTeamName;return t.props.actionHandler.handleInheritedMemberAccessChange(e,a,i,i?n:void 0)}return t.props.actionHandler.handleMemberAccessChange(e,n)};return s.default.createElement(u.SharingMemberListItem,{canInviteMembers:t.props.canInviteMembers,canMakeViewerNoComment:t.props.canMakeViewerNoComment,canRelinquishMembership:d,contentInfo:t.props.contentInfo,wrappedGroupViewersElement:a,isInheritedMember:r,isMemberActionPending:t.props.pendingMemberAction.has(i),isPresent:t.props.shouldShowPassUI&&t.isMemberCurrentlyViewing(e),key:i,member:e,user:t.props.user,onAccessChangeInBubbleMenu:p,showLinkViewerDisclosure:t.isLinkMember(e,n)})},t}return n.__extends(t,e),t.prototype.render=function(){var e=h.makeMemberSortCmp(this.props.user,this.props.presentAccountIds||r.Set(),this.shouldSortUsingPassRules()),t=this.membersByInheritance(),n=t.get(!1);n&&(n=n.sort(e));var i=t.get(!0);i&&(i=i.sort(e));var a=null;return this.props.areMembersFullyLoaded||(a=s.default.createElement("div",{className:"sharing-member-list__loading c-loader u-mar-horizontal-auto u-l-b"},S("Loading more members..."))),s.default.createElement("div",{className:"sharing-member-list"},this.renderInheritedUI(n,i),a)},t.prototype.shouldSortUsingPassRules=function(){var e=g.passStore.getPassPermissions(this.props.contentInfo.extras.fileId);return null!=e&&(e.canReadPresence||e.canReadSeenState)},t.prototype.renderInheritedUI=function(e,t){var n=this,a=r.Set(this.props.linkMembers),o=this.renderInheritedMembers(a,t),l=null;e&&e.count()>0&&(l=s.default.createElement("div",null,e.map(function(e){return n.renderMembersListItem(e,a)}).toArray()));var c=i.default({"o-list-ui":!0});return s.default.createElement("ul",{className:c},o,l)},t.prototype.renderInheritedMembers=function(e,t){var n=this,r=this.props,i=r.isConfidentialFolder,a=r.ownerTeamName;if(this.shouldShowInherited()&&a&&!i)return s.default.createElement(d.InheritedMembers,{actionHandler:this.props.actionHandler,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,memberCounts:this.props.memberCounts,members:t?t.toArray():[],ownerTeamName:a},t&&t.map(function(t){return n.renderMembersListItem(t,e,!0)}))},t.prototype.isLinkMember=function(e,t){return e instanceof l.UserMembershipInfo&&t.contains(e)},t.prototype.isMemberCurrentlyViewing=function(e){return!this.memberIsAssumed(e)&&(e instanceof l.UserMembershipInfo&&this.props.presentAccountIds&&this.props.presentAccountIds.has(e.account_id))},t.prototype.memberIsAssumed=function(e){return e instanceof l.UserMembershipInfo&&e.account_id===this.props.user.account_id&&m.Viewer.get_viewer().is_assume_user_session},t.prototype.membersByInheritance=function(){var e=this,t=function(t){return e.shouldShowInherited()&&t.is_inherited},n=this.props,i=n.membership,s=n.linkMembers,a=n.guestMembers;if(!i)return s.length>0||a.length>0?r.List(s).concat(a).groupBy(t):r.Map();var o=i.groups,l=i.invitees,c=i.users;return o.valueSeq().concat(l.valueSeq(),c.valueSeq(),s,a).groupBy(t)},t.prototype.shouldShowInherited=function(){return!!this.props.ownerTeamName&&this.props.user.is_cdm_member&&!a.inSubDirectory(this.props.user.cdm_tmf_path,this.props.actionHandler.getSharingInfo().displayPath())},t.prototype.extractGroupSeenStateAndViewers=function(e){var t=this,n=this.props.groupSeenStateInfo[e.memberId()],r=[];return this.props.presentAccountIds&&(r=n.map(function(e){return new p.ViewerInfo(e)}).filter(function(e){return null!=e.time_last_seen||t.props.presentAccountIds.has(e.account_id)})),{singleGroupSeenStateInfo:n,viewers:r}},t.prototype.renderWrappedGroupViewersElement=function(e){var t=this.extractGroupSeenStateAndViewers(e).viewers;return t.length?f.WrappedGroupViewersMaker.make(t,this.props.presentAccountIds):{element:null,elementText:""}},t.displayName="SharingMemberList",t.defaultProps={disabled:!1,groupSeenStateInfo:{},guestMembers:[],linkMembers:[]},t})(s.default.Component);t.SharingMemberList=E}),define("modules/clean/sharing/views/member_list_item",["require","exports","tslib","external/classnames","react","modules/clean/avatar/avatar_with_default","modules/clean/em_string","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","modules/clean/sharing/constants","modules/clean/datetime","modules/clean/previews/util","modules/clean/react/pass/utils","modules/clean/react/title_bubble","modules/clean/sharing/share_modal_dropdown_util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/views/viewer_info","modules/clean/static_urls","modules/core/i18n","modules/core/user_i18n","spectrum-sharing/member_row","modules/clean/sharing/access_level","modules/clean/sharing/strings","modules/clean/sharing/constants"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importDefault(s),S=n.__importStar(S),E=n.__importStar(E);var C=S.i18n_default_project("sharing"),M=C._,T=C.ungettext,N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMemberRowChange=function(e,n){t.props.onAccessChangeInBubbleMenu(n)},t}return n.__extends(t,e),t.prototype.shouldLinkToGroup=function(){return this.props.member instanceof _.GroupMembershipInfo&&(!!this.props.member.same_team&&(!!this.props.user.is_team_admin||!!this.props.member.is_member&&this.props.member.group_management_type!==_.GroupManagementType.system_managed))},t.prototype.linkToGroup=function(e,t,n){var s="/team#groups/%(id)s".format({id:e.group_id}),a=r.default({"u-font-meta":!n,"sharing-member-info__group-name-link":!0,"sharing-member-info__display-name-title":n});return i.default.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:a,title:e.group_name},t)},t.prototype.renderAvatar=function(e,t){var n=this.props.member.displayName()||"",r=this.getAvatarInitials(),a=t?"SQUARE":"CIRCLE",c=p.AnonymousViewerUtils.isAnonymousUserId(this.props.member.memberId())?this.props.member.memberId():n;return i.default.createElement("div",{className:"o-flag__fix"},i.default.createElement(s.default,{dimension:l.AVATAR_DIMENSION_BY_SIZE.MEDIUM,photoUrl:e,shape:a,defaultAvatar:i.default.createElement(o.InitialsAvatarWithColorDerivedFromName,{dimension:l.AVATAR_DIMENSION_BY_SIZE.MEDIUM,shape:a,initials:r,name:c,alt:""})}))},t.prototype.getDisplayName=function(e,t){var n;this.props.member.displayName()&&(n=this.props.member.displayName()),n=void 0!==n?n:"";var r=this.getLastSeenText(e);this.props.isPresent?r=this.getPresentText():e&&(r=this.getLastSeenText(e));var i=this.getDisabledMessage(t),s=0,o=0;r&&(s=new a.Emstring("  ·  %s".format(r)).length),i&&(o=new a.Emstring("  ·  %s".format(i)).length);var l=c.SNIPPET_SIZES.DISPLAY_NAME-s-o,d=a.Emstring.em_snippet(n,l);return this.shouldLinkToGroup()&&!this.shouldRenderGroupCount()?this.linkToGroup(this.props.member,d,!0):d},t.prototype.getAvatarInitials=function(){var e,t=this.props.member.displayName()||"";return this.props.member instanceof f.ViewerInfo||(e=this.props.member.initials),e=e||E.getInitials(t)},t.prototype.getPresentText=function(){return M("Viewing now")},t.prototype.getLastSeenText=function(e){var t="";return e&&(t=M("Viewed %(time_str)s").format({time_str:d.ago(e,!1,!0,!0)})),t},t.prototype.getDisabledMessage=function(e){var t="";return e&&e.disabled&&(t=M("Deleted")),t},t.prototype.getOffTeamMessage=function(e){var t="",n=e&&!e.email;return!this.props.user.is_team||this.props.member.same_team||n||(t=M("Outside your Dropbox team")),t},t.prototype.getMemberDetails=function(e,t){var n;return e?n=this.shouldLinkToGroup()?this.linkToGroup(this.props.member,e,!1):e:t&&t.email&&t.email_verified&&(n=t.email),n},t.prototype.isAllowedToRelinquishMembership=function(){return this.props.member.memberId()===this.props.user.account_id&&this.props.canRelinquishMembership},t.prototype.getOptionGroup=function(){if(!(this.props.member instanceof f.ViewerInfo)){for(var e=[],t="",n=I.ACCESS_NAME[this.props.member.access_type],r=m.getMemberActionInfo(this.isAllowedToRelinquishMembership(),this.props.canMakeViewerNoComment),i=0,s=r;i<s.length;i++){var a=s[i],o=a[0],l=a[1];this.props.member.access_type===l.value&&(t=l.value);var c=this.getOptionGroupOption(o,l);c&&e.push(c)}return{id:"optionGroup%s".format(this.props.member.memberId()),label:n,options:e,selectedApiId:t,enabled:!this.props.isMemberActionPending}}},t.prototype.getOptionGroupOption=function(e,t){if(!(this.props.member instanceof f.ViewerInfo)&&m.shouldShowMemberAction(e,t.value,this.props.member.access_type,this.props.member.permissions,this.isAllowedToRelinquishMembership())){var n="";return n=this.props.contentInfo&&this.props.contentInfo.isFolder()?t.folder_description?t.folder_description:"":t.file_description?t.file_description:"",t.value===y.MEMBER_ACTION.REMOVE?{apiId:t.value,label:t.title,tooltip:n,variant:"red"}:{apiId:t.value,label:t.title,tooltip:n,variant:t.value===b.ACCESS_LEVEL.READER?"border":"default"}}},t.prototype.renderSeenStateInfo=function(e,t,n){var r,s;return u.shouldShowPlatformInfo()?(r=t.toLocaleString(void 0,{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric"}),s=p.getOnPlatformText(n)):(r=t.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"}),s=t.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"})),i.default.createElement(h.TitleBubble,{content:i.default.createElement("div",null,r,s&&i.default.createElement("br",null),s),className:"timestamp-tooltip",children:i.default.createElement("span",null,e),position:h.TitleBubble.POSITIONS.BOTTOM,isTargetPositionFixed:!0})},t.prototype.shouldRenderGroupCount=function(){return this.props.member instanceof _.GroupMembershipInfo&&this.props.member.member_count},t.prototype.render=function(){var e,t,n=void 0,r=!1,s=null,a=void 0,o="",l=this.props.member;if(l instanceof _.UserMembershipInfo){if(o=l.account_id,n=l.account,!n)return null;s=n.profile_photo_url||null,t=l.platform_type,e=l.time_last_seen}else l instanceof _.GroupMembershipInfo?(o=l.group_id,r=!0,"team"===l.group_type&&(s=g.static_url("/static/images/icons/team_24@2x-vflR8kGKs.png")),this.shouldRenderGroupCount()&&(a=T("%(member_num)s member","%(member_num)s members",l.member_count).format({member_num:l.member_count}))):l instanceof f.ViewerInfo&&(o=l.account_id,n={email:l.email,email_verified:!!l.email},s=l.photo_circle_url,e=l.time_last_seen);var c;return this.props.wrappedGroupViewersElement&&this.props.wrappedGroupViewersElement.element?c=this.props.wrappedGroupViewersElement.element:this.props.isPresent?c=this.getPresentText():e&&(c=this.renderSeenStateInfo(this.getLastSeenText(e),e,t)),i.default.createElement(v.MemberRow,{id:o,avatarUrl:null!=s?s:"",avatarElement:this.renderAvatar(s,r),initialAvatarShape:r?"square":"circle",displayName:this.getDisplayName(e,n),disabledMessage:this.getDisabledMessage(n),description:this.getMemberDetails(a,n),passString:c,offTeamMessage:this.getOffTeamMessage(n),present:this.props.isPresent,initials:this.getAvatarInitials(),loadingSpinnerVisible:this.props.isMemberActionPending,optionGroup:this.getOptionGroup(),onChange:this.onMemberRowChange,variant:this.props.isInheritedMember?"borderless":"default"})},t.displayName="SharingMemberListItem",t.defaultProps={canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,disabled:!1,isPresent:!1,isViewOnly:!1},t})(i.default.Component);t.SharingMemberListItem=N}),define("modules/clean/sharing/views/modal_content_spectrum",["require","exports","tslib","modules/core/browser","external/classnames","react","external/react-dom-factories","spectrum-sharing/sharing_modal_message_field","modules/clean/contacts/util","modules/clean/filepath","modules/clean/react/bubble_dropdown_v2","modules/clean/react/css","modules/clean/keycode","modules/clean/react/async/loadable","modules/clean/react/pass/constants","modules/clean/react/snackbar","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/share_modal_header_section","modules/clean/sharing/views/member_list","modules/clean/sharing/views/modal_link_info","spectrum-sharing/sharing_modal_banner","modules/clean/sharing/views/share_modal_contacts_section","modules/clean/sharing/views/share_modal_footer_link_section","modules/clean/sharing/views/share_modal_pointer_mode","modules/clean/web_timing_logger","modules/clean/sharing/views/share_modal/redesign/modal_content","modules/clean/sharing/views/share_modal/contacts_error_banner","modules/clean/sharing/views/share_modal/sharing_modal_no_permissions_section","modules/constants/sharing","modules/core/i18n","modules/clean/sharing/views/wrapped_sharing_modal_checkbox_row","modules/clean/sharing/views/share_modal/confidential_folder_section"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I,y,C,M,T,N,k,A,w,L,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importDefault(i),s=n.__importDefault(s),a=n.__importStar(a),l=n.__importDefault(l),c=n.__importStar(c),M=n.__importStar(M),w=n.__importStar(w),t.MODES=g.MODES;var F=w.i18n_default_project("sharing")._,R=h.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/sharing/views/share_modal_footer_section"],t,n)}).then(n.__importStar).then(function(e){return e.ShareModalFooterSection})}}),O=(function(t){function d(){var r=null!==t&&t.apply(this,arguments)||this;return r.isGoldenGateTeamOverLimit=function(){return f.shouldEnforceMemberLimits(r.props.user,r.props.isTeamSharedFolder,r.props.isFolderInsideTeamFolderTree)&&(null!=r.props.memberCounts?r.props.memberCounts.total_unique_users:0)>=f.GoldenGate.SHARING_TOTAL_LIMIT},r.handleCheckChanged=function(e){r.props.actionHandler.changeCreateCommentCheckbox(e)},r.handleMessageChanged=function(e){r.props.actionHandler.changeRecipientMessage(e.target.value)},r.modalLinkInfoProps=function(){return{actionHandler:r.props.actionHandler,contentInfo:r.props.contentInfo,linkMetadata:r.props.linkMetadata,mode:r.props.mode,user:r.props.user,onLinkSettingsClick:r.props.onLinkSettingsClick,isLinkMetadataLoaded:r.props.isLinkMetadataLoaded,isTeamSharedFolder:r.props.isTeamSharedFolder,canShareLink:r.props.canShareLink,permissions:r.props.sharingPermissions}},r.linkSectionProps=function(){return{actionHandler:r.props.actionHandler,contentInfo:r.props.contentInfo,mode:r.props.mode,user:r.props.user,onLinkSettingsClick:r.props.onLinkSettingsClick,isLinkMetadataLoaded:r.props.isLinkMetadataLoaded,isTeamSharedFolder:r.props.isTeamSharedFolder,canShareLink:r.props.canShareLink,permissions:r.props.sharingPermissions}},r._addEveryoneGroup=function(){return r.contactsSection.addExternalContacts([l.default.teamGroupInfoToContact(r.props.teamGroupInfo)])},r.headerSectionProps=function(){return{ref:r.setHeaderSectionRef,actionHandler:r.props.actionHandler,contentInfo:r.props.contentInfo,contentNameMessage:r.props.contentNameMessage,contentNameMessageLevel:r.props.contentNameMessageLevel,canEdit:r.props.canEdit,isTeamSharedFolder:r.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:r.props.isFolderInsideTeamFolderTree,isInContentManager:r.props.isInContentManager,isConfidentialFolder:r.props.isConfidentialFolder,isContentNameFocused:r.props.isContentNameFocused,isCreatingNewFolder:r.isCreatingNewFolder(),isMetadataLoaded:r.props.isMetadataLoaded,initialContentName:r.props.initialContentName,onModalCloseClick:r.props.onModalCloseClick,onSettingsButtonClick:r.props.onSettingsClick,onContentNameInputChange:r.handleContentNameInputChange,onContentNameInputKeyUp:r.handleContentNameInputKeyUp,ownerTeam:r.props.ownerTeam,sharingInfo:r.props.actionHandler.getSharingInfo(),showPassFileSettings:r.props.showPassFileSettings,user:r.props.user}},r.contactsSectionProps=function(){return{ref:r.setContactsSectionRef,actionHandler:r.props.actionHandler,contentInfo:r.props.contentInfo,canInviteEditor:r.props.sharingPermissions.canInviteEditor(),canInviteViewer:r.props.sharingPermissions.canInviteViewer(),context:"spectrum",focusOnMount:r.props.contentInfo.pathExists(),initialTypeaheadTokens:r.getInitialTypeaheadTokens(),isFolderInsideTeamFolderTree:r.props.isFolderInsideTeamFolderTree,isInContentManager:r.props.isInContentManager,isTeamSharedFolder:r.props.isTeamSharedFolder,memberCountWithRecipients:r.props.memberCountWithRecipients,ownerTeam:r.props.ownerTeam,shouldLogContactSearch:!0,typeaheadPlaceholder:r.getTypeaheadPlaceholder(),user:r.props.user,showContactImport:!r.props.isTeamSharedFolder,teamGroupInfo:r.props.isTeamSharedFolder?r.props.teamGroupInfo:void 0}},r.handleContentNameInputChange=function(e){r.props.actionHandler.handleContentNameChange(e.currentTarget.value)},r.handleContentNameInputKeyUp=function(e){e.keyCode===p.KeyCode.ENTER&&r.contactsSection&&r.contactsSection.focusTypeaheadInput()},r.handleShareButtonClick=function(t){var i=r.props,s=i.actionHandler,a=i.recipientMessage,o=i.user;if(r.isCreatingNewFolder())return s.setContentNameAndSendShare(r.contactsSection).catch(function(){r.headerSection.selectContentNameInput()});var l=r.comments2IntegrationIsOn()&&a&&s.getSharingInfo().createCommentOnShare(),c=l?r.extractUserContacts():[];return s.sendShare(r.contactsSection).then(function(r){return l?new Promise(function(t,n){e(["modules/clean/sharing/actions/comments2_integration"],t,n)}).then(n.__importStar).then(function(e){(0,e.processAndDispatchAddCommentAction)(t,o,a,c)}):Promise.resolve(null)})},r.setContactsSectionRef=function(e){r.contactsSection=e},r.setHeaderSectionRef=function(e){r.headerSection=e},r}return n.__extends(d,t),d.prototype.componentDidMount=function(){this.logTTI()},d.prototype.componentDidUpdate=function(e,t){return this.logTTI()},d.prototype.logTTI=function(){return"GRANT_ACCESS"===this.props.contentInfo.extras.origin&&this.props.isMetadataLoaded&&M.mark_time_to_interactive(),this.props.mode===g.MODES.LINK_ONLY&&this.props.isLinkMetadataLoaded?this.props.actionHandler.logIfHaventBefore("VIEW_LINK_ONLY_MODAL"):this.props.isMetadataLoaded&&(this.props.actionHandler.logIfHaventBefore("VIEW_SHARE_MODAL"),!this._shouldRenderMainLoading())?this.props.actionHandler.logIfHaventBefore("MEMBER_LIST_LOADED",{member_count:this.props.actionHandler.getSharingInfo().memberNum()}):void 0},d.prototype.render=function(){var e=this.props.actionHandler.getSharingInfo(),t=i.default("unified-share-modal","unified-share-modal--"+this.props.mode,{
"unified-share-modal--two-link":e.isMultipleLinkInterfaceEnabled()});switch(this.props.mode){case g.MODES.LINK_ONLY:return s.default.createElement("div",{className:t},s.default.createElement(S.ShareModalHeaderSection,n.__assign({},this.headerSectionProps())),this.props.linkOnlyReason!==g.LINK_ONLY_REASON.LINKS_PAGE&&this._renderLinkOnlyNoPermissionSection(),this._renderMainLinkOnly());case g.MODES.POINTER:return s.default.createElement(C.ShareModalPointerMode,{className:t,sharingInfo:this.props.sharingInfo,onClickCloseButton:this.props.onModalCloseClick});default:return this.renderRedesignedSharingModal()?s.default.createElement(T.ModalContent,{className:t,actionHandler:this.props.actionHandler,headerProps:this.headerSectionProps(),isMetadataLoaded:this.props.isMetadataLoaded,contactsProps:this.contactsSectionProps(),linkProps:this.modalLinkInfoProps(),contactsError:this.props.contactsError,permissions:this.props.sharingPermissions,noPermissionsSectionProps:this.noPermissionsSectionProps(),inShareMode:this.inShareMode(),messageFieldProps:this.messageFieldProps(),shareButtonProps:this.shareButtonProps(),user:this.props.user,showConfidentialFolderSection:this.shouldRenderConfidentialFolderSection(),confidentialFolderSectionProps:this.confidentialFolderSectionProps(),canManageMembership:this.props.areMembersFullyLoaded&&this._showSharingMemberList(),members:this.props.members,memberListProps:this.memberListProps()}):(A.SHARING_EXPERIMENTS.ENABLE_SHARING_MODAL_REDESIGN&&this.logRedesignNotRendered(),s.default.createElement("div",{className:t},s.default.createElement(S.ShareModalHeaderSection,n.__assign({},this.headerSectionProps())),this._renderToSection(),s.default.createElement(N.ContactsErrorBanner,n.__assign({},this.props.contactsError)),this.shouldRenderConfidentialFolderSection()&&s.default.createElement(P.ConfidentialFolderSection,n.__assign({},this.confidentialFolderSectionProps())),this._renderMainSection(),this.shouldRenderFooterSection()&&this.renderFooterSection()))}},d.prototype.renderRedesignedSharingModal=function(){var e=this.props.isInContentManager||this.props.showContentManagerBridge||this.props.isTeamSharedFolder||this.isGoldenGateTeamOverLimit()||this.props.sharingInfo.isCloudDoc();return A.SHARING_EXPERIMENTS.ENABLE_SHARING_MODAL_REDESIGN&&!e},d.prototype.logRedesignNotRendered=function(){var e=this.props,t=e.actionHandler,n=e.isInContentManager,r=e.showContentManagerBridge,i=e.isTeamSharedFolder,s=e.sharingInfo;t.logIfHaventBefore("REDESIGN_ON_BUT_NOT_RENDERED",{isInContentManager:n,showContentManagerBridge:r,isTeamSharedFolder:i,isGoldenGateTeamOverLimit:Boolean(this.isGoldenGateTeamOverLimit()),isCloudDoc:s.isCloudDoc()})},d.prototype._renderToSection=function(){return this.props.isMetadataLoaded?this.props.showContentManagerBridge?this._renderContentManagerBridge():this.props.sharingPermissions.canInvite()?this.isGoldenGateTeamOverLimit()?this._renderOverLimitSection():s.default.createElement(I.ShareModalContactsSection,n.__assign({},this.contactsSectionProps())):s.default.createElement(k.SharingModalNoPermissionsSection,n.__assign({},this.noPermissionsSectionProps())):a.div({className:"unified-share-modal__section unified-share-modal__section--to"},a.div({className:"unified-share-modal__to-placeholder"}," "))},d.prototype.noPermissionsSectionProps=function(){return{isFolder:this.props.contentInfo.isFolder(),isTeamSharedFolder:this.props.isTeamSharedFolder,members:this.props.members,teamName:this.props.ownerTeam&&this.props.ownerTeam.name}},d.prototype._shouldRenderContentSettingsShareButton=function(){return this.props.isMetadataLoaded&&(this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings||this.inShareMode()||this.props.isInContentManager)},d.prototype.inShareMode=function(){return[g.MODES.SHARE,g.MODES.SHARE_SENDING].includes(this.props.mode)},d.prototype.shouldRenderFooterSection=function(){return!!this.props.isMetadataLoaded&&(this._shouldRenderLinkRowInFooter()||this._shouldRenderContentSettingsShareButton())},d.prototype.renderFooterSection=function(){var e=i.default(["unified-share-modal__section","unified-share-modal__section--no-border","unified-share-modal__section--footer","unified-share-modal__section--footer-no-padding","clearfix"]);return s.default.createElement("div",{className:e},this._shouldRenderLinkRowInFooter()?this._renderLinkRowContent():this._renderRegularFooterContent())},d.prototype.comments2IntegrationIsOn=function(){var e=A.SHARING_EXPERIMENTS.SPECTRUM_COMMENTS2_INTEGRATION_MODE[this.props.user.role];return this.props.contentInfo.isFile()&&("SEND_COMMENT_WITH_OPT_IN"===e||"SEND_COMMENT_BY_DEFAULT"===e)},d.prototype.shareButtonProps=function(){return{mode:this.props.mode,contentInfo:this.props.contentInfo,contactsError:this.props.contactsError,contentNameMessage:this.props.contentNameMessage,isInContentManager:this.props.isInContentManager,isTeamSharedFolder:this.props.isTeamSharedFolder,isTokenizerEmpty:this.props.isTokenizerEmpty,onShareButtonClick:this.handleShareButtonClick}},d.prototype._renderRegularFooterContent=function(){if(this.comments2IntegrationIsOn()){var e=this.props,t=e.actionHandler,r=e.recipientMessage,i=e.mode;return s.default.createElement(R,n.__assign({},this.shareButtonProps()),s.default.createElement(L.WrappedSharingModalCheckboxRow,{checked:t.getSharingInfo().createCommentOnShare(),disabled:0===r.length||i===g.MODES.SHARE_SENDING,labelText:F("Post this message as a comment"),onCheckChanged:this.handleCheckChanged}))}return s.default.createElement(R,n.__assign({},this.shareButtonProps()))},d.prototype._shouldRenderMainLoading=function(){var e=this.props.isMetadataLoaded,t=this.props.hasNonOwnerMembers||this.props.areMembersFullyLoaded,n=!this.props.isPassEnabled||this._isPassInfoLoaded(),r=this.props.shouldBlockMemberListOnPassLoad&&!n;return!e||!t||r},d.prototype._renderMainSection=function(){if(this._shouldRenderMainLoading())return this._renderMainLoading();switch(this.props.mode){case g.MODES.MEMBERSHIP:return this._renderMainMembership();case g.MODES.SHARE:case g.MODES.SHARE_SENDING:return this._renderMainShare();default:return null}},d.prototype.getLinkOnlyReasonMessage=function(){switch(this.props.linkOnlyReason){case g.LINK_ONLY_REASON.INSIDE_SHARED_FOLDER:return s.default.createElement("span",null,F("This folder can only be shared as a link because it’s in a shared folder.")," ",s.default.createElement("a",{href:"/help/1931",target:"_blank",rel:"noopener noreferrer"},F("Learn more")));case g.LINK_ONLY_REASON.CONTAINS_SHARED_FOLDER:return s.default.createElement("span",null,F("This folder can only be shared as a link because it contains a shared folder.")," ",s.default.createElement("a",{href:"/help/1931",target:"_blank",rel:"noopener noreferrer"},F("Learn more")));default:return F("This folder can only be shared as a link.")}},d.prototype._renderLinkOnlyNoPermissionSection=function(){var e;return e=this.props.actionHandler.getSharingInfo().isOSXPackage()?F("This package file can only be shared as a link."):this.getLinkOnlyReasonMessage(),s.default.createElement(b.SharingModalBanner,{message:e})},d.prototype.confidentialFolderSectionProps=function(){return{contentInfo:this.props.contentInfo,ownerTeam:this.props.ownerTeam,actionHandler:this.props.actionHandler}},d.prototype.shouldRenderConfidentialFolderSection=function(){return this.props.isConfidentialFolder&&this.props.canUpdateConfidentiality},d.prototype._renderContentManagerBridge=function(){var e=this.props.actionHandler.getSharingInfo(),t=c.parent_dir(e.displayPath()),n=e.name(),r=f.genContentManagerBridgeUri({containingFolder:t,filenameToSelect:n}),i=s.default.createElement("span",null,F("You can manage folder membership in the Admin Console.")," ",s.default.createElement("a",{href:r.toString(),target:"_blank",rel:"noopener"},F("Open in a new tab.")));return s.default.createElement(b.SharingModalBanner,{message:i})},d.prototype._renderOverLimitSection=function(){var e=F("This folder is over its %(member_limit)s-member limit.",{comment:"member limit is a number greater than 200"}).format({member_limit:f.GoldenGate.SHARING_TOTAL_LIMIT}),t=s.default.createElement("div",null,s.default.createElement("div",null,e),s.default.createElement("div",null,F("Please remove some members.")," ",s.default.createElement("a",{href:"/help/9292",target:"_blank",rel:"noopener"},F("Learn more."))));return s.default.createElement(b.SharingModalBanner,{message:t})},d.prototype._renderMainLoading=function(){return a.div({className:i.default(["unified-share-modal__main","unified-share-modal__section","unified-share-modal__section--no-border",this.shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer-spectrum"])},a.div({className:"unified-share-modal__loader-wrapper"},a.div({className:"c-loader"},F("Loading..."))))},d.prototype._renderMainLinkOnly=function(){return a.div({className:i.default(["unified-share-modal__main","unified-share-modal__main--link-only","unified-share-modal__section","unified-share-modal__section--no-border",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this.props.isLinkMetadataLoaded?this._renderLinkRowContent():this._renderLinkOnlyLoading())},d.prototype._renderLinkOnlyLoading=function(){return a.div({className:"unified-share-modal__link-info--loading"},a.div({className:"c-loader c-loader--spinner--blue u-l-b u-mar-horizontal-auto"},F("Loading…")))},d.prototype._showSharingMemberList=function(){return!!this.props.hasNonOwnerMembers||(this.props.isFolderInsideTeamFolderTree?1===this.props.members.users.size||!this.props.isConfidentialFolder&&this.props.user.is_cdm_member:this.props.guestMembers.length>0||this.props.linkMembers.length>0)},d.prototype._renderMemberList=function(){return s.default.createElement("div",{className:i.default(["unified-share-modal__section","unified-share-modal__section--no-padding","unified-share-modal__section--no-border"])},s.default.createElement(E.SharingMemberList,n.__assign({},this.memberListProps())))},d.prototype.memberListProps=function(){return{actionHandler:this.props.actionHandler,areMembersFullyLoaded:this.props.areMembersFullyLoaded,canInviteMembers:this.props.sharingPermissions.canInvite(),canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,disabled:this.props.showContentManagerBridge,groupSeenStateInfo:this.props.groupSeenStateInfo,guestMembers:this.props.guestMembers,isConfidentialFolder:this.props.isConfidentialFolder,linkMembers:this.props.linkMembers,memberCounts:this.props.memberCounts,membership:this.props.members,ownerTeamName:this.props.ownerTeam?this.props.ownerTeam.name:void 0,pendingMemberAction:this.props.pendingMemberAction,presentAccountIds:this.props.presentAccountIds,shouldShowPassUI:this.props.isPassEnabled&&m.fetchingStatusIsSuccessful(this.props.passFetchingStatus),user:this.props.user}},d.prototype._renderTeamSharedFolderBanner=function(){var e;return e=null!=this.props.teamGroupInfo?[a.p({className:"u-mar-top-xxl"},a.a({onClick:this._addEveryoneGroup},F("Add everyone at %(team_name)s").format({team_name:this.props.ownerTeam.name}))),a.p({},F("Or, add groups to this team folder.")+" ",a.a({onClick:this.props.onCreateGroupCallback},F("Create a group")))]:a.p({className:"u-mar-top-xxl"},F("Add groups to this team folder.")+" ",a.a({onClick:this.props.onCreateGroupCallback},F("Create a group"))),a.div({className:i.default(["unified-share-modal__section","unified-share-modal__section--no-border"])},a.div({className:i.default(["unified-share-modal__no-members-banner","u-font-center","u-font-meta","u-font-center","u-font-meta"])},e))},d.prototype._renderMainMembership=function(){var e=i.default(["unified-share-modal__main",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0]);return this._showSharingMemberList()?s.default.createElement("div",{className:e},this._renderMemberList()):this.props.isTeamSharedFolder?s.default.createElement("div",{className:e},this._renderTeamSharedFolderBanner()):s.default.createElement("div",{className:e},s.default.createElement(o.SharingModalMessageField,n.__assign({},this.messageFieldProps())))},d.prototype.messageFieldProps=function(){return{placeholder:F("Add a message (optional)"),onChange:this.handleMessageChanged,value:this.props.recipientMessage}},d.prototype._renderMainShare=function(){return s.default.createElement("div",{className:"unified-share-modal__main"},!this.props.isTeamSharedFolder&&s.default.createElement(o.SharingModalMessageField,n.__assign({},this.messageFieldProps())))},d.prototype._renderLinkRowContent=function(){if(!this.props.isInContentManager){return this.props.actionHandler.getSharingInfo().isMultipleLinkInterfaceEnabled()?s.default.createElement(y.ShareModalFooterLinkSection,n.__assign({},this.linkSectionProps())):this.props.isLinkMetadataLoaded?s.default.createElement("div",{className:"unified-share-modal__link-info"},s.default.createElement(v.ModalLinkInfo,n.__assign({},this.modalLinkInfoProps()))):a.div({className:"unified-share-modal__link-info--filler-spectrum"})}},d.prototype._isPassInfoLoaded=function(){return m.fetchingStatusIsComplete(this.props.passFetchingStatus)},d.prototype._shouldRenderLinkRowInFooter=function(){return this.props.mode!==g.MODES.SHARE&&this.props.mode!==g.MODES.SHARE_SENDING&&!this.props.isInContentManager},d.prototype.getInitialTypeaheadTokens=function(){var e=this.props,t=e.recipientTokens,n=e.initialRecipientTokens;return t?n.concat(t):n},d.prototype.getTypeaheadPlaceholder=function(){return F(this.props.isTeamSharedFolder?"Group names":this.props.user.is_team?"Email, name, or group":"Email or name")},d.prototype.isCreatingNewFolder=function(){var e=this.props.contentInfo;return e.isFolder()&&!e.extras.exists},d.prototype.extractUserContacts=function(){return this.contactsSection.getContacts().filter(function(e){var t=e.dbx_account_id,n=e.email;return void 0!==t||void 0!==n}).map(function(e){var t=e.dbx_account_id,n=e.email,r=e.name;return t?{accountId:t,displayName:r}:{email:n,displayName:r}})},d.displayName="ShareModalContentSpectrum",d.defaultProps={headerId:"unified-share-modal-title",initialRecipientRawInput:"",initialRecipientTokens:[],isTeamSharedFolder:!1,mode:g.MODES.MEMBERSHIP,onFolderSettingsClick:null,guestMembers:[],linkMembers:[],onCreateGroupCallback:function(){r.redirect("/team#groups/newgroup")}},d})(s.default.Component),D=u.requireCssWithComponent(O,["/static/css/spectrum/index.web-vflI9cXf0.css","/static/js/spectrum-sharing/index.web-vflfIOyqH.css","/static/css/react/contacts_tokenizer-vflQsfYaG.css","/static/css/scooter/scooter-scoped-vflWuydQl.css","/static/css/sharing/share_modal-vfl6JbngH.css","/static/css/modal-vflYDGbgV.css"],[d.BubbleDropdown,_.Snackbar]);t.ShareModalContentSpectrum=D}),define("modules/clean/sharing/views/modal_link_info",["require","exports","tslib","jquery","external/classnames","react","modules/clean/clipboard_v2","modules/clean/react/util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/link_description","modules/clean/sharing/ui_util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/views/constants","modules/core/i18n","spectrum-sharing/sharing_modal_footer_link"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importDefault(s),h=n.__importStar(h);var _,f=h.i18n_default_project("sharing")._;(function(e){e.CAN_LINK="CAN_LINK",e.INVITE_NO_LINK="INVITE_NO_LINK",e.NO_INVITE_NO_LINK="NO_INVITE_NO_LINK",e.CANT_LINK_TEAM_FOLDER="CANT_LINK_TEAM_FOLDER",e.ERROR_FETCHING_LINK_INFO="ERROR_FETCHING_LINK_INFO"})(_=t.LinkabilityStates||(t.LinkabilityStates={}));var g=(function(e){function t(t){var n=e.call(this,t)||this;return n.onClickButtonLinkSettings=function(){n.props.mode===p.MODES.LINK_ONLY?n.props.actionHandler&&n.props.actionHandler.handleLinkSettingsClick():n.props.onLinkSettingsClick()},n.setTextInputRef=function(e){return n.urlField=e,e},n.onClickButtonCreateLink=function(){n.setState({creatingLink:!0},function(){return n.handleCreateLinkClicked()})},n.handleCreateLinkClicked=function(){if(n.props.actionHandler)return n.props.actionHandler.createSharedLink()},n.handleCopyLinkClicked=function(){if(!n.state.showingUrl){var e={};n.props.linkMetadata&&(e.type="shmodel",e.visibility=n.props.linkMetadata.link_permissions.resolved_visibility,e.expiration=n.props.linkMetadata.expires),n.props.contentInfo&&(d.logTiburonEvent(n.props.contentInfo,n.props.user.id,"CLICK_TIB_COPY_LINK",e),d.logTiburonEvent(n.props.contentInfo,n.props.user.id,"COPY_SHARED_LINK",e))}return o.setStatePromise(n,{showingUrl:!n.state.showingUrl,creatingLink:!1}).then(function(){if(n.urlField){var e=n.urlField;e.focus(),e.select(),n.clipboard.do_copy()}})},n.state={showingUrl:!1,creatingLink:!1},n.clipboard=null,n}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.clipboard=new a.ClipboardV2(this.props.linkMetadata&&this.props.linkMetadata.url,function(){return u.sharingNotificationSuccess(f("Link copied to clipboard"))},function(){u.sharingNotificationError(f("Unable to copy the link, please copy manually"))},this.handleCopyLinkClicked)},t.prototype.componentDidMount=function(){this.setupCopy()},t.prototype.componentDidUpdate=function(){this.setupCopy()},t.prototype.setupCopy=function(){var e=r.default(".copy-link-button");e.length&&this.clipboard.setupCopy(e,r.default(".copy-link-container"))},t.prototype.getLinkabilityState=function(){var e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();return e&&e.isCloudDoc()?this.getLinkabilityStateForCloudDoc():this.props.isTeamSharedFolder?_.CANT_LINK_TEAM_FOLDER:this.props.canShareLink||this.props.mode===p.MODES.LINK_ONLY?_.CAN_LINK:this.props.permissions.canInvite()?_.INVITE_NO_LINK:_.NO_INVITE_NO_LINK},t.prototype.getLinkabilityStateForCloudDoc=function(){var e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo(),t=this.props.permissions,n=this.props.isLinkMetadataLoaded&&void 0===this.props.linkMetadata;return!e.isTwoLinkRedesignEnabled()&&n?_.ERROR_FETCHING_LINK_INFO:this.props.linkMetadata||t.canCreateViewLink()?_.CAN_LINK:_.NO_INVITE_NO_LINK},t.prototype.render=function(){var e=this.getLinkabilityState();return e===_.NO_INVITE_NO_LINK?this.renderSpectrumCantLinkOrShare():e===_.INVITE_NO_LINK?this.renderSpectrumCantLinkCDM():e===_.CANT_LINK_TEAM_FOLDER?this.renderSpectrumCantLinkTeamFolder():e===_.ERROR_FETCHING_LINK_INFO?this.renderSpectrumErrorFetchingLinkInfo():this.props.linkMetadata?this.state.showingUrl?this.renderSpectrumCopyLink():this.renderSpectrumLink():this.state.creatingLink?this.renderSpectrumLoading():e===_.CAN_LINK?this.renderSpectrumNoLink():null},t.prototype.spectrumClassNames=function(){return i.default({"scl-sharing-modal-footer-link--no-border":this.props.mode===p.MODES.LINK_ONLY,"scl-sharing-modal-footer-link--no-spacing":this.props.mode===p.MODES.LINK_ONLY})},t.prototype.renderSpectrumCantLinkOrShare=function(){return s.default.createElement(m.SharingModalFooterLink,{body:f("Link not available")})},t.prototype.renderSpectrumCantLinkCDM=function(){var e=s.default.createElement("a",{href:"/help/business/team-folders",target:"_blank",rel:"noopener noreferrer"},f("Learn more"));return s.default.createElement(m.SharingModalFooterLink,{className:this.spectrumClassNames(),body:f("Link not available. To share, invite specific people."),actions:e})},t.prototype.renderSpectrumCantLinkTeamFolder=function(){var e=s.default.createElement("a",{href:"/help/business/team-folders",target:"_blank",rel:"noopener noreferrer"},f("Learn more"));return s.default.createElement(m.SharingModalFooterLink,{className:this.spectrumClassNames(),body:f("Link not available"),actions:e})},t.prototype.renderSpectrumErrorFetchingLinkInfo=function(){return s.default.createElement(m.SharingModalFooterLink,{className:this.spectrumClassNames(),body:f("We were unable to retrieve information about shared links")})},t.prototype.renderSpectrumLink=function(){var e;e=a.ClipboardV2.is_supported()?s.default.createElement("span",{className:"copy-link-button"},f("Copy link")):f("Show link");var t=i.default(this.spectrumClassNames(),"scl-sharing-modal-footer-link--link-options");return s.default.createElement(m.SharingModalFooterLinkOptions,{className:t,statusLinkCreated:this.renderLinkDescription(),textButtonLinkSettings:f("Link settings"),textButtonCopyLink:e,buttonCopyClassName:"button-as-link copy-link-container",onClickButtonLinkSettings:this.onClickButtonLinkSettings,onClickButtonCopyLink:this.handleCopyLinkClicked})},t.prototype.renderSpectrumCopyLink=function(){var e=null!=this.props.linkMetadata?this.props.linkMetadata.url:"";return s.default.createElement(m.SharingModalFooterLinkCopy,{className:this.spectrumClassNames(),sharedLinkUrl:e,labelSharedLinkUrl:f("Shared link URL"),textButton:f("Hide link"),textInputRef:this.setTextInputRef,onClickButton:this.handleCopyLinkClicked})},t.prototype.renderSpectrumNoLink=function(){return s.default.createElement(m.SharingModalFooterLinkCreate,{className:this.spectrumClassNames(),statusNoLinkCreated:f("No link created yet"),textButtonCreateLink:f("Create link"),onClickButtonCreateLink:this.onClickButtonCreateLink})},t.prototype.renderSpectrumLoading=function(){return s.default.createElement(m.SharingModalFooterLinkLoading,{className:this.spectrumClassNames(),statusCreatingLink:f("Creating link")})},t.prototype.renderLinkDescription=function(){var e=null;this.props.linkMetadata instanceof l.LinkMetadata&&(e=c.formatLinkDescription(this.props.linkMetadata));var t=null;return null!==e&&(t=s.default.createElement("span",{className:"unified-share-modal-link-info__description"},e)),s.default.createElement("span",null,t)},t.displayName="ModalLinkInfo",t})(s.default.Component);t.ModalLinkInfo=g}),define("modules/clean/sharing/views/righteous_modal_link_info",["require","exports","tslib","jquery","modules/core/i18n","external/classnames","react","modules/clean/clipboard_v2","modules/clean/sharing/views/constants","modules/clean/react/util","modules/clean/sharing/views/modal_link_info","spectrum-sharing/sharing_modal_footer_link","spectrum-sharing/scooter_loader","spectrum/button","spectrum/icon_acl","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/link_description","modules/clean/sharing/ui_util"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g){"use strict";function S(e){switch(e){case"editor":return a.default.createElement(m.IconAcl,{name:"link-edit"});default:return a.default.createElement(m.IconAcl,{name:"link-view"})}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),s=n.__importDefault(s),a=n.__importDefault(a);var E=i.i18n_default_project("sharing")._;t.getSpectrumLinkIcon=S;var v=(function(e){function t(t){var n=e.call(this,t)||this;return n.getSpectrumLinkText=function(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can edit")),a.default.createElement("br",null),n.renderLinkDescription());case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can view")),a.default.createElement("br",null),n.renderLinkDescription());default:return n.renderLinkDescription()}},n.setTextInputRef=function(e){return n.urlField=e,e},n.getSpectrumNoLinkText=function(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can edit")),a.default.createElement("br",null),E("No link created yet."));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can view")),a.default.createElement("br",null),E("No link created yet."));default:return E("No link created yet")}},n.onClickButtonCreateLink=function(){n.setState({creatingLink:!0},function(){return n.handleCreateLinkClicked()})},n.handleCreateLinkClicked=function(){if(n.props.actionHandler)return n.props.actionHandler.createSharedLink(n.props.linkAccessLevel)},n.getSpectrumLoadingText=function(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can edit")),a.default.createElement("br",null),E("Creating edit link..."),a.default.createElement(p.ScooterLoader,null));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can view")),a.default.createElement("br",null),E("Creating view link..."),a.default.createElement(p.ScooterLoader,null));default:return}},n.handleCopyLinkClicked=function(){if(!n.state.showingUrl){var e={};n.props.linkMetadata&&(e.type="shmodel",e.visibility=n.props.linkMetadata.link_permissions.resolved_visibility,e.expiration=n.props.linkMetadata.expires),n.props.contentInfo&&(g.logTiburonEvent(n.props.contentInfo,n.props.user.id,"CLICK_TIB_COPY_LINK",e),g.logTiburonEvent(n.props.contentInfo,n.props.user.id,"COPY_SHARED_LINK",e))}return c.setStatePromise(n,{showingUrl:!n.state.showingUrl,creatingLink:!1}).then(function(){if(n.urlField){var e=n.urlField;e.focus(),e.select(),n.clipboard.do_copy()}})},n.state={showingUrl:!1,creatingLink:!1},n.clipboard=null,n}return n.__extends(t,e),t.prototype.getLinkabilityState=function(){var e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo(),t=this.props.permissions;return e&&e.isCloudDoc()?this.getLinkabilityStateForCloudDoc():this.props.isTeamSharedFolder?d.LinkabilityStates.CANT_LINK_TEAM_FOLDER:(e.isFolder()||!e.isMetadataLoaded()||t.canCreateViewLink())&&(this.props.canShareLink||this.props.mode===l.MODES.LINK_ONLY)?d.LinkabilityStates.CAN_LINK:t.canInvite()?d.LinkabilityStates.INVITE_NO_LINK:d.LinkabilityStates.NO_INVITE_NO_LINK},t.prototype.getLinkabilityStateForCloudDoc=function(){var e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();return this.props.linkMetadata?d.LinkabilityStates.CAN_LINK:"editor"===this.props.linkAccessLevel&&e.permissionsObj().canCreateEditLink()?d.LinkabilityStates.CAN_LINK:"viewer"===this.props.linkAccessLevel&&e.permissionsObj().canCreateViewLink()?d.LinkabilityStates.CAN_LINK:d.LinkabilityStates.NO_INVITE_NO_LINK},t.prototype.componentWillMount=function(){var e=this;this.clipboard=new o.ClipboardV2(this.props.linkMetadata&&this.props.linkMetadata.url,function(){return"editor"===e.props.linkAccessLevel?_.sharingNotificationSuccess(E("Edit link copied and ready to share. Sign-in required to edit file.")):_.sharingNotificationSuccess(E("View link copied and ready to share."))},function(){_.sharingNotificationError(E("Unable to copy the link, please copy manually"))},this.handleCopyLinkClicked)},t.prototype.componentDidMount=function(){this.setupCopy()},t.prototype.componentDidUpdate=function(){this.setupCopy()},t.prototype.setupCopy=function(){var e=r.default(".copy-link-button");e.length&&this.clipboard.setupCopy(e,r.default(".copy-link-container"))},t.prototype.spectrumClassNames=function(){return s.default("scl-sharing-modal-footer-link--no-border")},t.prototype.render=function(){var e=this.getLinkabilityState();return e===d.LinkabilityStates.NO_INVITE_NO_LINK?this.renderSpectrumCantLinkOrShare():e===d.LinkabilityStates.INVITE_NO_LINK?this.renderSpectrumCantLinkCDM():e===d.LinkabilityStates.CANT_LINK_TEAM_FOLDER?this.renderSpectrumCantLinkTeamFolder():this.props.linkMetadata?this.state.showingUrl?this.renderSpectrumCopyLink():this.renderSpectrumLink():this.state.creatingLink?this.renderSpectrumLoading():e===d.LinkabilityStates.CAN_LINK?this.renderSpectrumNoLink():null},t.prototype.getSpectrumLinkNoAvailableCloudDocText=function(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can edit")),a.default.createElement("br",null),E("Link not available"));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can view")),a.default.createElement("br",null),E("Link not available"));default:return E("Link not available")}},t.prototype.renderSpectrumCantLinkOrShare=function(){return a.default.createElement(u.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),body:this.getSpectrumLinkNoAvailableCloudDocText(this.props.linkAccessLevel)})},t.prototype.getSpectrumCantLinkCDMCloudDocText=function(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can edit")),a.default.createElement("br",null),E("Link not available. To share, invite specific people."));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,E("Can view")),a.default.createElement("br",null),E("Link not available. To share, invite specific people."));default:return E("Link not available. To share, invite specific people.")}},t.prototype.renderSpectrumCantLinkCDM=function(){var e=a.default.createElement("a",{href:"/help/business/team-folders",target:"_blank",rel:"noopener noreferrer"},E("Learn more"));return a.default.createElement(u.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),body:this.getSpectrumCantLinkCDMCloudDocText(this.props.linkAccessLevel),actions:e})},t.prototype.renderSpectrumCantLinkTeamFolder=function(){var e=a.default.createElement("a",{href:"/help/business/team-folders",target:"_blank",rel:"noopener noreferrer"},E("Learn more"));return a.default.createElement(u.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),body:this.getSpectrumLinkNoAvailableCloudDocText(this.props.linkAccessLevel),actions:e})},t.prototype.renderLinkDescription=function(){var e;if(this.props.linkMetadata){var t=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();e=f.formatLinkDescriptionPlainText(this.props.linkMetadata,t.isUserOnOwnerTeam())}return a.default.createElement("span",{className:"unified-share-modal-link-info__description"},e)},t.prototype.renderSpectrumLink=function(){var e;return e=o.ClipboardV2.is_supported()?a.default.createElement("span",{className:"copy-link-button"},E("Copy link")):E("Show link"),a.default.createElement(u.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),body:this.getSpectrumLinkText(this.props.linkAccessLevel),actions:a.default.createElement(h.Button,{className:"button-as-link copy-link-container",key:"copy",variant:"borderless",onClick:this.handleCopyLinkClicked},e)})},t.prototype.renderSpectrumCopyLink=function(){var e=null!=this.props.linkMetadata?this.props.linkMetadata.url:"";return a.default.createElement(u.SharingModalFooterLinkCopy,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),sharedLinkUrl:e,labelSharedLinkUrl:E("Shared link URL"),textButton:E("Hide link"),textInputRef:this.setTextInputRef,onClickButton:this.handleCopyLinkClicked})},t.prototype.renderSpectrumNoLink=function(){return a.default.createElement(u.SharingModalFooterLinkCreate,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),statusNoLinkCreated:this.getSpectrumNoLinkText(this.props.linkAccessLevel),textButtonCreateLink:E("Create link"),onClickButtonCreateLink:this.onClickButtonCreateLink})},t.prototype.renderSpectrumLoading=function(){return a.default.createElement(u.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:S(this.props.linkAccessLevel),body:this.getSpectrumLoadingText(this.props.linkAccessLevel)})},t.displayName="RighteousModalLinkInfo",t})(a.default.Component);t.RighteousModalLinkInfo=v}),define("modules/clean/sharing/views/share_modal/confidential_folder_section",["require","exports","tslib","react","modules/clean/react_format","spectrum-sharing/sharing_modal_banner","modules/core/i18n","spectrum/button"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),
a=n.__importStar(a);var l=a.i18n_default_project("sharing")._,c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.restoreAccessToConfidentialFolder=function(){var e=t.props,n=e.ownerTeam,r=e.actionHandler,i=n?n.name:"";r.handleSetConfidentialClick(!0,i)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.contentInfo,t=r.default.createElement("div",{className:"confidential-folder-section"},i.reactFormat(l("<b>Invite only.</b> Members of parent folders can’t access."),{b:r.default.createElement("b",null)})," ",e.pathExists()&&r.default.createElement(o.Button,{onClick:this.restoreAccessToConfidentialFolder,className:"button-as-link",key:"restore access",variant:"styleless","aria-label":l("Restore access")},l("Restore access")));return r.default.createElement(s.SharingModalBanner,{type:"dark",message:t})},t})(r.default.Component);t.ConfidentialFolderSection=c}),define("modules/clean/sharing/views/share_modal/contacts_error_banner",["require","exports","tslib","react","modules/clean/sharing/ui_util","spectrum-sharing/sharing_modal_banner"],function(e,t,n,r,i,s){"use strict";function a(e){var t,n=e.level,a=void 0===n?"defaultLevel":n,o=e.message;if(!o)return null;var l=(t={},t[i.ContactsErrorLevel.Error]="error",t[i.ContactsErrorLevel.Warn]="warn",t.defaultLevel="default",t)[a];return r.default.createElement(s.SharingModalBanner,{className:"contacts-error-banner",type:l,message:o})}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),t.ContactsErrorBanner=a}),define("modules/clean/sharing/views/share_modal/redesign/contacts_section",["require","exports","tslib","react","modules/clean/sharing/views/share_modal_contacts_section","modules/clean/sharing/views/share_modal/redesign/loading_section","modules/core/i18n"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a);var o=a.i18n_default_project("sharing")._,l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.isMetadataLoaded,a=e.contactsProps,l=e.permissions;return t?l.canInvite()?r.default.createElement("div",{className:"redesign-share-modal-contacts-section"},r.default.createElement("div",{className:"redesign-share-modal-contacts-section__to-label"},o("Invite")),r.default.createElement(i.ShareModalContactsSection,n.__assign({},a))):null:r.default.createElement(s.LoadingSection,{sectionName:"contacts-section",toLabel:o("Invite")})},t})(r.default.Component);t.ContactsSection=l}),define("modules/clean/sharing/views/share_modal/redesign/header_subtitle",["require","exports","tslib","react","modules/clean/react_format","modules/core/i18n","spectrum/button"],function(e,t,n,r,i,s,a){"use strict";function o(e){return 0===e.other_member_count?p("Shared with <membership_link>%(members)s</membership_link>").format(e):h("Shared with %(members)s and <membership_link>%(other_member_count)s other</membership_link>","Shared with %(members)s and <membership_link>%(other_member_count)s others</membership_link>",e.other_member_count).format(e)}function l(e,t,n){var r=t>3?2:1,i=t-r;return{members:e.getMemberSlice({numMembersToGet:r,excludedUserAccountIds:[n.account_id]}).map(function(e){return e.displayName()}).join(", "),other_member_count:i}}function c(e,t){return e.includesUserDirectly(t)?e.getMemberCount()-1:e.getMemberCount()}function d(e){var t=e.user,n=e.members,s=e.onClick,d=e.disabled,u=c(n,t);return 0===u?r.default.createElement("div",null):r.default.createElement("div",null,i.reactFormat(o(l(n,u,t)),{membership_link:d?r.default.createElement("span",null):r.default.createElement(a.Button,{onClick:s,className:"button-as-link",key:"manage membership",variant:"styleless","aria-label":p("Manage Membership")})}))}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),s=n.__importStar(s);var u=s.i18n_default_project("sharing"),p=u._,h=u.ungettext;t.HeaderSubtitle=d}),define("modules/clean/sharing/views/share_modal/redesign/loading_section",["require","exports","tslib","react"],function(e,t,n,r){"use strict";function i(e){var t=e.sectionName,n=e.toLabel,i="redesign-share-modal-"+t;return r.default.createElement("div",{className:i},r.default.createElement("div",{className:i+"__to-label"},n),r.default.createElement("div",{className:"loading-field"}))}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),t.LoadingSection=i}),define("modules/clean/sharing/views/share_modal/redesign/member_list_modal_body",["require","exports","tslib","react","external/classnames","modules/clean/sharing/views/member_list","modules/clean/sharing/views/share_modal/confidential_folder_section"],function(e,t,n,r,i,s,a){"use strict";function o(e){var t=e.showConfidentialFolderSection,o=e.confidentialFolderSectionProps,l=e.memberListProps;return r.default.createElement("div",null,t&&r.default.createElement(a.ConfidentialFolderSection,n.__assign({},o)),r.default.createElement("div",{className:i.default(["unified-share-modal__section","unified-share-modal__section--no-border","unified-share-modal__main"])},r.default.createElement(s.SharingMemberList,n.__assign({},l))))}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),t.MemberListModalBody=o}),define("modules/clean/sharing/views/share_modal/redesign/modal_content",["require","exports","tslib","react","external/classnames","modules/clean/react/css","modules/clean/sharing/views/share_modal_header_section","modules/clean/sharing/views/share_modal/sharing_modal_no_permissions_section","modules/clean/sharing/views/share_modal/redesign/header_subtitle","modules/clean/sharing/views/righteous_modal_link_info","modules/clean/sharing/views/share_modal/redesign/share_mode_modal_body","modules/clean/sharing/views/share_modal/redesign/member_list_modal_body","modules/clean/sharing/views/share_modal/redesign/loading_section","modules/clean/sharing/views/share_modal/redesign/contacts_section","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m){"use strict";function _(e){var t=e.linkProps,i=f("Or share a link");return t.isLinkMetadataLoaded?r.default.createElement("div",{className:"redesign-share-modal-link-section"},r.default.createElement("div",{className:"redesign-share-modal-link-section__to-label"},i),r.default.createElement(c.RighteousModalLinkInfo,n.__assign({},t,{linkAccessLevel:"viewer"}))):r.default.createElement(p.LoadingSection,{sectionName:"link-section",toLabel:i})}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),m=n.__importStar(m);var f=m.i18n_default_project("sharing")._,g=(function(e){function t(t){var n=e.call(this,t)||this;return n.renderMemberList=function(){n.props.actionHandler.log("MEMBER_LIST_LINK_CLICKED"),n.setState({showMemberList:!0})},n.state={showMemberList:!1},n}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,s=e.headerProps,c=e.canManageMembership,d=e.user,u=e.members,p=e.noPermissionsSectionProps,h=u&&r.default.createElement(l.HeaderSubtitle,{user:d,members:u,onClick:this.renderMemberList,disabled:!c||this.state.showMemberList});return r.default.createElement("div",{className:i.default([t,"redesign-share-modal"])},r.default.createElement(a.ShareModalHeaderSection,n.__assign({},s,{subTitle:h})),this.showNoPermissionsSection()&&r.default.createElement(o.SharingModalNoPermissionsSection,n.__assign({},p)),this.renderBody())},t.prototype.renderBody=function(){var e=this.props,t=e.isMetadataLoaded,i=e.contactsProps,s=e.linkProps,a=e.permissions,o=e.inShareMode;return this.state.showMemberList?r.default.createElement(u.MemberListModalBody,n.__assign({},this.props)):o?r.default.createElement("div",null,r.default.createElement(h.ContactsSection,{isMetadataLoaded:t,permissions:a,contactsProps:i}),r.default.createElement(d.ShareModeModalBody,n.__assign({},this.props))):r.default.createElement("div",null,r.default.createElement(h.ContactsSection,{isMetadataLoaded:t,permissions:a,contactsProps:i}),r.default.createElement(_,{linkProps:s}))},t.prototype.showNoPermissionsSection=function(){var e=this.props,t=e.isMetadataLoaded,n=e.permissions;return t&&!n.canInvite()},t})(r.default.Component),S=s.requireCssWithComponent(g,["/static/css/sharing/redesign_share_modal-vflYtcQ0M.css"]);t.ModalContent=S}),define("modules/clean/sharing/views/share_modal/redesign/share_mode_modal_body",["require","exports","tslib","react","modules/clean/sharing/views/share_modal/contacts_error_banner","spectrum-sharing/sharing_modal_message_field","modules/clean/sharing/views/share_modal_footer_section","modules/core/i18n"],function(e,t,n,r,i,s,a,o){"use strict";function l(e){var t=e.contactsError,o=e.messageFieldProps,l=e.shareButtonProps;return r.default.createElement("div",null,r.default.createElement(i.ContactsErrorBanner,n.__assign({},t)),r.default.createElement(s.SharingModalMessageField,n.__assign({},o,{placeholder:c("Say something")})),r.default.createElement(a.ShareModalFooterSection,n.__assign({},l,{contactsError:t})))}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importStar(o);var c=o.i18n_default_project("sharing")._;t.ShareModeModalBody=l}),define("modules/clean/sharing/views/share_modal/sharing_modal_no_permissions_section",["require","exports","tslib","react","modules/clean/react_format","spectrum-sharing/sharing_modal_banner","modules/core/i18n","external/lodash"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a),o=n.__importStar(o);var l=a.i18n_default_project("sharing")._,c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getNoPermissionMessage=function(){return t.props.isTeamSharedFolder?t.getTeamSharedFolderMessage():l(t.props.isFolder?"You don’t have permission to manage membership of this folder":"You don’t have permission to manage membership of this file")},t}return n.__extends(t,e),t.prototype.render=function(){return r.default.createElement(s.SharingModalBanner,{message:this.getNoPermissionMessage()})},t.prototype.getTeamSharedFolderMessage=function(){return this.renderTeamFolderNoPermissionMessage()?l("This folder is automatically shared with all members of %(team_name)s").format({team_name:this.props.teamName}):i.reactFormat(l("Only <admin_link>admins</admin_link> and <group_link>group managers</group_link> can change team folder membership."),{admin_link:r.default.createElement("a",{href:"/team?_tk=left_nav_team",target:"_blank",rel:"noreferrer"}),group_link:r.default.createElement("a",{href:"/help/7232#transfer",target:"_blank",rel:"noreferrer"})})},t.prototype.renderTeamFolderNoPermissionMessage=function(){return o.get(this.props,"members.groups",{}).some(function(e){return"team"===e.group_type&&o.get(e,"permissions.make_editor.allow")&&o.get(e,"permissions.make_viewer.allow")})},t})(r.default.Component);t.SharingModalNoPermissionsSection=c}),define("modules/clean/sharing/views/share_modal_contacts_section",["require","exports","tslib","react","modules/core/browser","modules/clean/contacts/config","spectrum/typeahead","modules/clean/analytics","spectrum-sharing/sharing_contact_token","spectrum-sharing/sharing_modal_contacts_field","spectrum-sharing/member_row","modules/clean/sharing/access_level","modules/clean/contacts/contact","modules/clean/contacts/util","modules/clean/contacts/data_v2","modules/clean/contacts/types","modules/clean/react/flag","modules/clean/react/image","modules/clean/sharing/constants","modules/clean/sharing/strings","modules/clean/sharing/ui_util","modules/clean/static_urls","modules/clean/profile_services/profile_services_link","modules/clean/profile_services/popup_handler","modules/core/exception","modules/clean/profile_services/profile_services_constants","modules/core/notify","modules/core/i18n","external/react-dom","modules/core/user_i18n"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f,g,S,E,v,b,I,y,C,M,T,N,k,A){"use strict";function w(e,t,n){return void 0!==e&&null!==e&&"function"==typeof e[t]?n(e,t):void 0}function L(e,t){return void 0!==e&&null!==e?t(e):void 0}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),s=n.__importStar(s),h=n.__importDefault(h),_=n.__importDefault(_),M=n.__importDefault(M),N=n.__importStar(N),k=n.__importStar(k),A=n.__importStar(A);var P=N.i18n_default_project("sharing")._,F=/[,|;>]+/,R=(function(){function e(){}return e.prototype.getKey=function(){return"expand-importer"},e})();t.ExpandImport=R;var O=(function(){function e(e){var t=e.provider,n=e.connected;this.provider=t,this.connected=n}return e.prototype.getKey=function(){return"third-party-import"+this.provider},e})();t.ThirdPartyImport=O;var D=(function(e){function t(t){var n=e.call(this,t)||this;return n.updateRecipientData=function(){n.props.actionHandler.recipientsChange(n.state.typeaheadTokens,n.typeaheadInput.value)},n.filterContacts=function(e){return n.props.isSendingForSignature?e.type!==_.default.FB&&!!e.email&&e.email!==n.props.user.email:n.props.isTeamSharedFolder?e.type!==_.default.FB&&!!e.group_id:n.props.isInContentManager?e.type!==_.default.FB:e.type!==_.default.FB&&e.email!==n.props.user.email},n.handleAccessTypeChange=function(e){n.props.actionHandler.changeRecipientAccess(e)},n.handleTypeaheadOnChange=function(e){if(F.test(e)){var t=n.tokenizeValidRawInputs(e);if(t.length>0)return n.validateAndAddTokens(t),void n.typeahead.setState({inputValue:""})}n._logSearchBegin(e),n.showSuggestions(e),n.updateRecipientData()},n.handleExpandImport=function(){var e=[];Array.from(M.default.importable_contact_services()).map(function(t){if(n.profile_services){var r=new O({provider:t,connected:n.profile_services.service_is_connected(t)});e.push(r)}}),n.setState({typeaheadSuggestions:e})},n.handleThirdPartyImport=function(e){var t;if(C.assert((t=e.provider,Array.from(M.default.importable_contact_services()).includes(t)),"invalid party contact provider "+e.provider),n.profile_services&&n.profile_services.service_is_connected(e.provider)){var r=P("You’re already connected to %(service_name)s").format({service_name:M.default.to_name(e.provider)});return void T.Notify.success(r)}return n.link_handler.auth_service_with_user(e.provider,n.props.user.id,function(e){return I.ProfileServicesLinkingHandler.show_import_notifications(e)})},n.handleTypeaheadSelect=function(e,t,r){if(e||r)if(e instanceof R)n.handleExpandImport();else if(e instanceof O)n.handleThirdPartyImport(e);else{n._logTokenSelect(e,t,r);var i=e?[e]:n.tokenizeAllRawInputs(r);n.validateAndAddTokens(i),n.setState({typeaheadSuggestions:[]})}},n.handleTypeaheadRemoveToken=function(e){var t=n.state.typeaheadTokens.filter(function(t){return t!==e});n._logTokenChangeEvent(e,!0),n.setState({typeaheadTokens:t})},n.renderExpandImport=function(){return r.default.createElement("div",{className:"typeahead-option"},r.default.createElement(f.Flag,{leftAttachment:(function(){return r.default.createElement(g.Image,{className:"u-pad-right-s",src:b.static_url("/static/images/icons/icon-import-vflOL9sCs.png"),srcHiRes:b.static_url("/static/images/icons/icon-import@2x-vfluE8TBO.png")})})()},r.default.createElement("div",{className:"option-primary option-only"},P("Import contacts"))))},n.renderThirdPartyImport=function(e){return r.default.createElement(x,{import:e})},n.renderMemberRow=function(e){var t=e.name||e.email,n=A.getInitials(t);return r.default.createElement(d.MemberRow,{id:e.getKey(),initials:n,avatarUrl:e.photo_url,description:e.email,displayName:t,tag:"div",variant:"narrow"})},n.renderTypeaheadSuggestion=function(e){return e instanceof R?n.renderExpandImport():e instanceof O?n.renderThirdPartyImport(e):n.renderMemberRow(e)},n.renderTypeaheadTokenContent=function(e){var t=e.name||e.email,i={did_select_suggestion:!1};n._logTokenChangeEvent(e,!1,i);var s=v.validateContact(e,n.props.user,n.props.ownerTeam,n.props.actionHandler.getSharingInfo().folderPolicy(),n.props.isTeamSharedFolder,n.props.isFolderInsideTeamFolderTree,n.props.memberCountWithRecipients),a={state:s.state,msg:s.msg};return r.default.createElement(l.SharingContactToken,{avatarUrl:e.photo_url,displayName:t,validation:a})},n.setTypeaheadRef=function(e){n.typeahead=e},n.setTypeaheadInputRef=function(e){n.typeaheadInput=e},n.finishLogging=function(e){var t=n.contactsDataSource.getStats().numLocalContacts;if(n._flush_unfinished_queries_cache(),n.props.shouldLogContactSearch)return n.contact_search_logger.log_records(n.props.user.id,e,t)},n._logTokenSelect=function(e,t,r){var i={search_expr:r,selected_pos:t||0,num_query_results:n.state.typeaheadSuggestions.length,did_select_suggestion:!0};n._logTokenChangeEvent(e,!1,i)},n._logTokenChangeEvent=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r={}),n.contact_search_logger&&e){if(!t){var s={context:n._getLoggingContext(),contact_type:e.type,contact_id:e.getContactID(),contact_name:e.name,sort_variant:null,event_ts:w(i.performance(),"now",function(e){return e.now()})};for(var a in r)r[a]&&(s[a]=r[a]);return n.contact_search_logger.add_record(s)}var o=e.getContactID();return o?n.contact_search_logger.flag_record_as_removed(o):void 0}},n._logSearchComplete=function(e,t,r){if(void 0===r&&(r=!0),n._shouldLogSearch()&&e){var s=i.performance().now(),a=n.unfinished_contact_search_queries[e];if(a){var o=a.begin_time;!("ttfr"in a)&&t>0&&(a.ttfr=Math.floor(s-o)),r?(a.local_duration=Math.floor(s-o),a.num_local_results=t):(a.remote_duration=Math.floor(s-o),a.num_additional_remote_results=t),a.num_results+=t;return(function(){return n.contactsDataSource.isSearchLocalOnly()&&r||!r})()?(a=n._prepareSearchStatsForLogging(a,e,s,!0),n.contact_search_logger.add_timing_record(a),n.contact_search_logger.count_search(a.is_slow),delete n.unfinished_contact_search_queries[e]):void 0}}},n._logSearchBegin=function(e){if(n._shouldLogSearch()&&e){var t=i.performance().now();return n._flush_unfinished_queries_cache(t),n.unfinished_contact_search_queries[e]={begin_time:t,num_results:0}}},n._shouldLogSearch=function(){return n.props.shouldLogContactSearch&&null!=n.contact_search_logger&&null!=L(i.performance(),function(e){return e.now})},n._flush_unfinished_queries_cache=function(e){if(n._shouldLogSearch()){null==e&&(e=i.performance().now());for(var t in n.unfinished_contact_search_queries)if(n.unfinished_contact_search_queries[t]){var r=n.unfinished_contact_search_queries[t];e&&e-r.begin_time<s.CONTACTS_SEARCH_PREEMPTED_THRESHOLD&&(r.is_preempted=!0),r=n._prepareSearchStatsForLogging(r,t,e,!1),n.contact_search_logger.add_timing_record(r),n.contact_search_logger.count_search(r.is_slow)}return n.unfinished_contact_search_queries={}}},n._prepareSearchStatsForLogging=function(e,t,r,i){var s=e.begin_time;e.duration=Math.floor(r-s),"ttfr"in e?e.is_slow=e.ttfr>100:i&&0===e.num_results?e.is_slow=!1:e.is_slow=e.duration>100;var a=n.contactsDataSource.getStats().localContactsDownloadedTime;return e.started_before_download=null==a||s<a,"is_preempted"in e||(e.is_preempted=!1),e.context=n._getLoggingContext(),e.query_length=t.length,e.is_finished=i,e},n._getLoggingContext=function(){var e="spectrum_tokenizer";return null!=n.props.context&&(e+="_"+n.props.context),e},n.state={typeaheadTokens:[],typeaheadSuggestions:[]},n.link_handler=new I.ProfileServicesLinkingHandler,n.profile_services=null,n.props.teamGroupInfo||n.props.showContactImport&&n.props.user&&(n.profile_services=I.LinkedProfileServices.get_linked_profile_services_for_user(n.props.user.id)),n}return n.__extends(t,e),t.prototype.getContacts=function(){var e=this.typeaheadInput.value;if(""!==e){var t=this.tokenizeAllRawInputs(e);this.validateAndAddTokens(t)}return this.state.typeaheadTokens},t.prototype.focusTypeaheadInput=function(){k.findDOMNode(this.typeaheadInput).focus()},t.prototype.addExternalContacts=function(e){this.validateAndAddTokens(e)},t.prototype.componentDidMount=function(){this.contactsDataSource=this.initContactsDataSource(this.props.user,this.filterContacts),this.props.shouldLogContactSearch&&(this.contact_search_logger=new o.ContactSearchLogger(this._getLoggingContext(),this.contactsDataSource.searchModeName),this.unfinished_contact_search_queries={}),this.props.initialTypeaheadTokens&&this.props.initialTypeaheadTokens.length>0&&this.validateAndAddTokens(this.props.initialTypeaheadTokens),this.props.focusOnMount&&this.focusTypeaheadInput()},t.prototype.componentDidUpdate=function(e,t){this.contactsDataSource=this.initContactsDataSource(this.props.user,this.filterContacts),this.state.typeaheadSuggestions.length>0&&this.state.typeaheadSuggestions[0]instanceof R&&this.typeahead.setState({suggestionsListSelectedIndex:-1}),t.typeaheadTokens!==this.state.typeaheadTokens&&this.updateRecipientData()},t.prototype.render=function(){var e=this.props.isTeamSharedFolder?P("Add groups:",{comment:"Label for with whom to share"}):P("To:",{comment:"Label for with whom to share"}),t=this.props.isSendingForSignature?"Recipient will not be able to edit the contents of this PDF":P("Only folders can be shared with edit access");return r.default.createElement(c.SharingModalContactsField,{contactsField:this.renderContactsField(),labelledAccessTypes:this.getAccessTypes(),onAccessTypeChange:this.handleAccessTypeChange,selectedAccessType:this.getSelectedAccessType(),toLabel:e,showNoEditTooltip:this.props.contentInfo.isFile()&&!this.props.canInviteEditor,noEditText:t})},t.prototype.initContactsDataSource=function(e,t){return new m.ContactsDataSourceV2(e,t,!1)},t.prototype.getAccessTypes=function(){var e=[],t=function(e){return P("change permission for users to %(label)s").format({label:e})},n=E.ACCESS_NAME,r=this.props.contentInfo&&this.props.contentInfo.isFolder()?E.MEMBER_ACTION_FOLDER:this.props.actionHandler.getSharingInfo().isCloudDoc()?E.MEMBER_ACTION_CLOUD_DOC:E.MEMBER_ACTION_FILE;return this.props.canInviteEditor&&e.push({apiId:u.ACCESS_LEVEL.WRITER,ariaLabel:t(u.ACCESS_LEVEL.WRITER),label:n[u.ACCESS_LEVEL.WRITER],details:r[S.MEMBER_ACTION.MAKE_EDITOR]}),this.props.canInviteViewer&&e.push({apiId:u.ACCESS_LEVEL.READER,ariaLabel:t(u.ACCESS_LEVEL.READER),label:n[u.ACCESS_LEVEL.READER],details:r[S.MEMBER_ACTION.MAKE_VIEWER]}),this.props.isSendingForSignature&&e.push({apiId:u.ACCESS_LEVEL.SIGNER,ariaLabel:t(u.ACCESS_LEVEL.SIGNER),label:P("Can view and complete form"),details:"Recipient can only view and complete the form"}),e},t.prototype.getSelectedAccessType=function(){for(var e,t=this.props.actionHandler.getSharingInfo(),n=this.getAccessTypes(),r=0,i=n;r<i.length;r++){var s=i[r];s.apiId===t.recipientAccess()&&(e=s)}return e},t.prototype.shouldDisallowInput=function(){return this.props.isSendingForSignature&&this.state.typeaheadTokens.length>0},t.prototype.renderContactsField=function(){return r.default.createElement(a.Typeahead,{ref:this.setTypeaheadRef,className:this.shouldDisallowInput()?"esignature-typeahead-no-placeholder":"",height:160,inputProps:{ref:this.setTypeaheadInputRef,placeholder:this.shouldDisallowInput()?"":this.props.typeaheadPlaceholder},listItemHeight:48,onChange:this.handleTypeaheadOnChange,onRemoveToken:this.handleTypeaheadRemoveToken,onSelect:this.handleTypeaheadSelect,renderSuggestion:this.renderTypeaheadSuggestion,renderTokenContent:this.renderTypeaheadTokenContent,suggestions:this.state.typeaheadSuggestions,suggestionsBuffer:0,tokens:this.createTypeaheadTokenObjects()})},t.prototype.createTypeaheadTokenObjects=function(){var e=this,t=this.state.typeaheadTokens,n=[];return t.forEach(function(t){var r,i=t.getKey(),s=t,a=v.validateContact(t,e.props.user,e.props.ownerTeam,e.props.actionHandler.getSharingInfo().folderPolicy(),e.props.isTeamSharedFolder,e.props.isFolderInsideTeamFolderTree,e.props.memberCountWithRecipients);r="invalid"===a.state?"error":"warn"===a.state?"warning":"default",n.push({key:i,variant:r,content:s})}),n},t.prototype.showSuggestions=function(e){var t=this,n=function(e){if(!e)return[];var n=t.state.typeaheadTokens.map(function(e){return e.getKey()});return e.filter(function(e){return!n.includes(e.getKey())})},r=[],i=function(i){r.push.apply(r,n(i)),t.setSuggestions(r),t._logSearchComplete(e,(null!=i?i.length:void 0)||0,!0)},s=function(i){var s=n(i);e===t.typeaheadInput.value&&s.length>0&&(r[r.length-1]instanceof R?r.push.apply(r,s.concat(r.pop())):r.push.apply(r,s),t.setState({typeaheadSuggestions:r})),t._logSearchComplete(e,i.length,!1)};this.contactsDataSource.search(e,i,s)},t.prototype.setSuggestions=function(e){var t=e;this.props.teamGroupInfo?t.push(h.default.teamGroupInfoToContact(this.props.teamGroupInfo)):this.props.showContactImport&&t.push(new R),this.setState({typeaheadSuggestions:t})},t.prototype.tokenizeAllRawInputs=function(e){var t=this.tokenizeValidRawInputs(e);return t.length>0?t:[p.Contact.buildFromRawEmail(e)]},t.prototype.tokenizeValidRawInputs=function(e){return(e.match(/['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}/gi)||[]).map(p.Contact.buildFromRawEmail)},t.prototype.validateAndAddTokens=function(e){var t=this,n=e.reduce(function(e,t){return t.pending&&t.query&&e.push(t.query),e},[]),r=function(n){for(var r=[],i=t.state.typeaheadTokens.map(function(e){return e.getKey()}),s=0,a=e;s<a.length;s++){var o=a[s],l=o;if(l.pending&&l.query){var c=t.contactsDataSource.normalizeQuery(l.query),d=t.determineQueryMatch(c,n[c]);d&&(l=d)}var u=l.getKey();i.includes(u)||(i.push(u),r.push(l))}t.setState({typeaheadTokens:t.state.typeaheadTokens.concat(r)})};return this.contactsDataSource.searchBatch(n,r,r)},t.prototype.determineQueryMatch=function(e,t){if(!t||!e)return null;for(var n={email:[],name:[]},r=0,i=t;r<i.length;r++){var s=i[r],a=s.email?this.contactsDataSource.normalizeQuery(s.email):null,o=s.name?this.contactsDataSource.normalizeQuery(s.name):null;e===a?n.email.push(s):e===o&&n.name.push(s)}for(var l=0,c=["email","name"];l<c.length;l++){var d=c[l];if(1===n[d].length)return n[d][0]}return null},t.defaultProps={shouldLogContactSearch:!1},t})(r.default.Component);t.ShareModalContactsSection=D;var x=(function(e){function t(t){var n=e.call(this,t)||this;return n.show_contact_import_spinner=function(e){if(n.props.import.provider===e.provider)return n.setState({showLoading:!0})},n.state={showLoading:!1},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){return this.authCompleteListenerToken=y.addAuthCompleteListener(this.show_contact_import_spinner)},t.prototype.componentWillUnmount=function(){return y.removeAuthCompleteListener(this.authCompleteListenerToken)},t.prototype.render=function(){var e=this.props.import,t=e.provider,n=e.connected,i=M.default.to_img_legacy(t),s=M.default.to_name(t);!n&&this.state.showLoading&&(s=P("Importing %(service_name)s Contacts").format({service_name:s}));var a=n?P("Connected"):"";return r.default.createElement("div",{className:"typeahead-option"},r.default.createElement(f.Flag,{leftAttachment:(function(){return r.default.createElement(g.Image,{className:"u-pad-right-s",src:b.static_url(i[0]),srcHiRes:b.static_url(i[1])})})()},r.default.createElement("div",{className:"option-primary"},s),r.default.createElement("div",{className:"option-secondary u-font-meta"},a)))},t.displayName="ThirdPartyImportOption",t})(r.default.PureComponent)}),define("modules/clean/sharing/views/share_modal_footer_link_section",["require","exports","tslib","react","modules/core/i18n","external/classnames","spectrum/button","modules/clean/sharing/views/righteous_modal_link_info","spectrum-sharing/sharing_modal_footer_link_list","modules/clean/sharing/views/constants"],function(e,t,n,r,i,s,a,o,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),s=n.__importDefault(s);var d=i.i18n_default_project("sharing")._,u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickButtonLinkSettings=function(){t.props.mode===c.MODES.LINK_ONLY?t.props.actionHandler.handleLinkSettingsClick():t.props.onLinkSettingsClick()},t}return n.__extends(t,e),t.prototype.renderSharedLinks=function(){var e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();if(e.isCloudDoc()){var t=void 0,n=void 0;return e&&e.sharedLinks()&&(t=e.editRighteousLink(),n=e.viewRighteousLink()),[this.renderModalLinkInfo(t,"editor"),this.renderModalLinkInfo(n,"viewer")]}var r=e.sharedLinks()[0];return this.renderModalLinkInfo(r,"viewer")},t.prototype.renderModalLinkInfo=function(e,t){return r.default.createElement(o.RighteousModalLinkInfo,{key:t,actionHandler:this.props.actionHandler,contentInfo:this.props.contentInfo,linkMetadata:e,linkAccessLevel:t,mode:this.props.mode,user:this.props.user,onLinkSettingsClick:this.props.onLinkSettingsClick,isLinkMetadataLoaded:this.props.isLinkMetadataLoaded,isTeamSharedFolder:this.props.isTeamSharedFolder,canShareLink:this.props.canShareLink,permissions:this.props.permissions})},t.prototype.renderActions=function(){var e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();if(e.sharedLinks()&&e.sharedLinks().length>0&&(!e.isCloudDoc()||e.permissionsObj().canCreateEditLink()||e.permissionsObj().canCreateViewLink()))return r.default.createElement(a.Button,{variant:"borderless",onClick:this.onClickButtonLinkSettings},d("Link settings"))},t.prototype.render=function(){var e=this;return r.default.createElement("div",{className:"unified-share-modal-two-link-model"},(function(){return e.props.isLinkMetadataLoaded?r.default.createElement(l.SharingModalFooterLinkList,{className:s.default({"scl-sharing-modal-footer-link-list--no-border":e.props.mode===c.MODES.LINK_ONLY}),title:d("Share a link instead"),actions:e.renderActions()},e.renderSharedLinks()):void 0})())},t})(r.default.Component);t.ShareModalFooterLinkSection=u}),define("modules/clean/sharing/views/share_modal_footer_section",["require","exports","tslib","react","external/lodash","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","spectrum-sharing/sharing_modal_footer_inband","external/react-redux","modules/clean/react/comments2/data/selectors","modules/clean/react/comments2/data/store","modules/clean/react/comments2/data/types","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),p=n.__importStar(p);var h=p.i18n_default_project("sharing")._,m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickButtonShare=function(){var e=t.props,n=e.commentsEnabledForFile,r=e.dispatch;(0,e.onShareButtonClick)(n?r:i.noop)},t}return n.__extends(t,e),t.prototype.isInbandFooterDisabled=function(){return this.props.isTokenizerEmpty||this.props.contactsError&&this.props.contactsError.level===s.ContactsErrorLevel.Error||null!=this.props.contentNameMessage},t.prototype.render=function(){var e=this.props,t=e.mode,n=e.children,s=e.commentsEnabledForFile;switch(t){case a.MODES.SHARE:return r.default.createElement(o.SharingModalFooterInband,{isButtonShareDisabled:this.isInbandFooterDisabled(),textButtonShare:h(this.props.isTeamSharedFolder?"Add":"Share"),onClickButtonShare:this.onClickButtonShare},s&&n);case a.MODES.SHARE_SENDING:return r.default.createElement(o.SharingModalFooterInband,{isButtonShareDisabled:!0,textButtonShare:h(this.props.isTeamSharedFolder?"Adding...":"Sharing..."),onClickButtonShare:i.noop},s&&n);case a.MODES.MEMBERSHIP:return this.props.isInContentManager&&!this.props.contentInfo.pathExists()?r.default.createElement(o.SharingModalFooterInband,{isButtonShareDisabled:!1,textButtonShare:h(this.props.isTeamSharedFolder?"Add":"Share"),onClickButtonShare:this.onClickButtonShare}):null;default:return null}},t})(r.default.PureComponent);t.ShareModalFooterSectionInternal=m;var _=l.connect(function(e){return{commentsEnabledForFile:c.getContextStatus(e)===u.Comments2ContextStatus.Comments2}})(m),f=function(e){return r.default.createElement(l.Provider,{store:d.getStoreForComments2()
},r.default.createElement(_,n.__assign({},e)))};t.ShareModalFooterSection=f}),define("modules/clean/sharing/views/share_modal_header_section",["require","exports","tslib","external/classnames","react","react-dom","spectrum-sharing/sharing_modal_header","modules/clean/react/bubble","modules/clean/sharing/views/constants","modules/clean/em_string","modules/core/i18n","modules/clean/react/icon/folder_icon","modules/clean/sharing/share_modal_icon","modules/clean/sharing/constants"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importStar(s),o=n.__importDefault(o),d=n.__importStar(d);var m=d.i18n_default_project("sharing"),_=m._,f=m.ungettext,g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleContentNameFocus=function(){t.props.actionHandler.handleContentNameFocusChange(!0)},t.handleContentNameBlur=function(){t.props.actionHandler.handleContentNameFocusChange(!1)},t.setHeaderInputRef=function(e){t.headerInput=e},t}return n.__extends(t,e),t.prototype.selectContentNameInput=function(){this.headerInput&&s.findDOMNode(this.headerInput.input).select()},t.prototype.render=function(){return this.props.isCreatingNewFolder&&!this.props.initialContentName?i.default.createElement(a.SharingModalHeaderInput,{inputAutoFocus:!0,ref:this.setHeaderInputRef,icon:i.default.createElement(u.SharedFolderIcon,null),inputAriaLabel:this.props.contentNameMessage,inputPlaceholder:this.props.isContentNameFocused?void 0:_("Folder name"),onClickCloseButton:this.props.onModalCloseClick,onInputChange:this.props.onContentNameInputChange,onInputFocus:this.handleContentNameFocus,onInputBlur:this.handleContentNameBlur,onInputKeyUp:this.props.onContentNameInputKeyUp},this.shouldShowContentNameBubble()&&this.renderContentNameBubble()):i.default.createElement(a.SharingModalHeaderTitle,{closeButtonVisible:!0,icon:this.getIcon(),subTitle:this.props.subTitle||this.getMemberCountsString(),onClickCloseButton:this.props.onModalCloseClick,onClickSettingsButton:this.props.onSettingsButtonClick,settingsButtonVisible:this.props.isMetadataLoaded&&this.isContentSettingsEnabled(),title:this.getHeaderTitle()})},t.prototype.getHeaderTitle=function(){return this.props.initialContentName?this.props.initialContentName:c.Emstring.em_snippet(this.props.sharingInfo.name(),h.SNIPPET_SIZES.FILENAME)},t.prototype.isContentNameInputError=function(){return this.props.contentNameMessageLevel===l.CONTENT_NAME_MESSAGE_LEVELS.ERROR},t.prototype.shouldShowContentNameBubble=function(){return this.props.contentNameMessage&&(this.props.isContentNameFocused||this.isContentNameInputError())},t.prototype.renderContentNameBubble=function(){return i.default.createElement(o.default,{arrow:o.default.ARROW.TOP,className:r.default("unified-share-modal__content-name__tooltip","u-pad-xs","u-font-strong",{"unified-share-modal__content-name__tooltip-error":this.isContentNameInputError()})},this.props.contentNameMessage)},t.prototype.getIcon=function(){var e=this.props.contentInfo;if(e.isFolder()){if(!e.extras.exists)return i.default.createElement(u.SharedFolderIcon,null);if(!this.props.isMetadataLoaded)return i.default.createElement(u.SimpleFolderIcon,null)}return i.default.createElement(p.ShareModalIcon,{alt:"",className:"unified-share-modal__title-icon",filename:this.props.sharingInfo.name(),isSharedFolder:e.isSharedFolder(),isFolder:e.isFolder(),isTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree===!0,isViewOnly:!this.props.canEdit,isConfidentialFolder:this.props.isInContentManager&&this.props.isConfidentialFolder,pathExists:e.pathExists()})},t.prototype.getOutsideTeamString=function(){var e=this.props.sharingInfo,t=e.memberCounts();if(e.hasOutsideTeamMembers())return f("%(outside_team_count)s outside your Dropbox team","%(outside_team_count)s outside your Dropbox team",t.users_outside_team).format({outside_team_count:t.users_outside_team})},t.prototype.getMemberCountsString=function(){var e=this.props.sharingInfo.memberNum();if(e&&!this.props.isSendingForSignature){var t=this.props.sharingInfo.memberCounts(),n=this.getOutsideTeamString(),r=t&&t.exceeds_count;return(n?f("%(member_num)s member (%(outside_team_string)s)","%(member_num)s members (%(outside_team_string)s)",e,{comment:'Description of the count of total folder members and count of outside-of-team folder members, like "10 members (3 outside of your Dropbox team)"'}):f("%(member_num)s member","%(member_num)s members",e)).format({member_num:e+(r?"+":""),outside_team_string:n})}},t.prototype.isContentSettingsEnabled=function(){return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings},t})(i.default.Component);t.ShareModalHeaderSection=g}),define("modules/clean/sharing/views/share_modal_pointer_mode",["require","exports","tslib","react","modules/core/i18n","modules/clean/clipboard_v2","modules/clean/sharing/ui_util","modules/clean/sharing/ui_notifications_util","spectrum/icon_content","spectrum-sharing/sharing_modal_header","spectrum-sharing/sharing_modal_footer_link"],function(e,t,n,r,i,s,a,o,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i);var u=i.i18n_default_project("sharing")._,p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCopyLinkClicked=function(){t.urlInput.focus(),t.urlInput.select(),t.clipboard.do_copy(),t.logCopyEvent()},t.setTextInputRef=function(e){return t.urlInput=e,e},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.setupCopy()},t.prototype.componentDidUpdate=function(){this.setupCopy()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.sharingInfo,i=e.onClickCloseButton;return r.default.createElement("div",{className:t},r.default.createElement(c.SharingModalHeaderTitle,{closeButtonVisible:!0,icon:r.default.createElement(l.IconContent,{name:"dlink-small"}),onClickCloseButton:i,title:n.name()}),r.default.createElement(d.SharingModalFooterLinkCopy,{labelSharedLinkUrl:u("Shared link URL"),isIconHidden:!0,inputProps:{autoFocus:!1},onClickButton:this.handleCopyLinkClicked,sharedLinkUrl:this.getLinkUrl(),textButton:u("Copy link"),textInputRef:this.setTextInputRef}))},t.prototype.getLinkUrl=function(){return this.props.sharingInfo.isLinkMetadataLoaded()?this.props.sharingInfo.sharedLinks()[0].url:""},t.prototype.setupCopy=function(){if(this.props.sharingInfo.isLinkMetadataLoaded()){this.clipboard=new s.ClipboardV2(this.getLinkUrl(),function(){return o.sharingNotificationSuccess(u("Link copied to clipboard"))},function(){return o.sharingNotificationError(u("Unable to copy the link, please copy manually"))},this.handleCopyLinkClicked);var e=document.querySelector(".scl-sharing-modal-footer-link__actions .mc-button"),t=document.querySelector(".scl-sharing-modal-footer-link__actions");this.clipboard.setupCopy(e,t)}},t.prototype.logCopyEvent=function(){var e=this.props.sharingInfo.user(),t=this.props.sharingInfo.contentInfo(),n={type:"pointer"};a.logTiburonEvent(t,e.id,"COPY_SHARED_LINK",n)},t})(r.default.Component);t.ShareModalPointerMode=p}),define("modules/clean/sharing/views/sharing_settings_file_folder_policy_view",["require","exports","tslib","react","modules/core/i18n","modules/clean/sharing/views/sharing_settings_policy_view","modules/clean/sharing/sharing_settings_constants"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i);var o=i.i18n_default_project("sharing")._,l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return this.renderPolicies()},t.prototype.renderPolicies=function(){var e=this,t=this.props.policies.map(function(t){var n=e.getPolicyDict(t);return e.renderPolicy(t,n)});return r.default.createElement("div",null,t)},t.prototype.renderPolicy=function(e,t){var n,r,i,s=this;n=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),r=n[0],i=n[1];var o;if(t.type===a.DROPDOWN){var l=function(t){s.props.onPolicyUpdate(e,t)},c=Object.keys(t.optionsDict);o=this.renderDropdown(e,r,t.optionsDict,c,l,!i)}else if(t.type===a.TOGGLE){var d=function(n,r){for(var i=0,a=Object.keys(t.optionsDict);i<a.length;i++){var o=a[i];t.optionsDict[o].value===n&&s.props.onPolicyUpdate(e,o)}};o=this.renderToggle(e,r,t.optionsDict,d,!i)}return this.renderPolicyRow(e,t,i,o)},t.prototype.isTeamMemberFolder=function(){return!this.isTeamFolderTree()&&this.props.ownerTeam},t.prototype.isTeamFolderTree=function(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree},t.prototype.getMemberPolicyQuestion=function(){return o(this.isTeamFolderTree()?"Limit who can be added as a member of folders.":"Limit who can be added as a member of this folder.")},t.prototype.getAclUpdatePolicyQuestion=function(){return o(this.isTeamFolderTree()?"Choose who can add people to folders.":"Choose who can add people to this folder.")},t.prototype.getViewerInfoPolicyDescription=function(){return o(this.props.ownerTeam?this.props.isFolder?"Show who viewed files in this folder to team members and people who can edit.":"Show who viewed this file to team members and people who can edit.":this.props.isFolder?"Show who’s viewing files in this folder to people who can edit.":"Show who’s viewing this file to people who can edit.")},t.prototype.getPolicyDict=function(e){switch(e){case a.MEMBER_POLICY:return{title:o("Folder membership"),description:this.getMemberPolicyQuestion(),optionsDict:{anyone:{label:o("Anyone")},team:{label:o("Only team members")}},type:a.DROPDOWN};case a.ACL_UPDATE_POLICY:return{title:o("Manage access"),description:this.getAclUpdatePolicyQuestion(),optionsDict:{editors:{label:o(this.isTeamFolderTree()||this.isTeamMemberFolder()?"Team members who can edit":"Folder members"),description:o(this.isTeamFolderTree()||this.isTeamMemberFolder()?"Team members with edit access can add people.":"Members with edit access can add people.")},owner:{label:o(this.isTeamFolderTree()?"Only Team Admins":"Only you"),description:o(this.isTeamFolderTree()?"Only Team Admins.":"Only you (the owner) can add people.")}},type:a.DROPDOWN};case a.VIEWER_INFO_POLICY:return{title:o("Viewer info"),description:this.getViewerInfoPolicyDescription(),optionsDict:{enabled:{label:o("On"),value:!0},disabled:{label:o("Off"),value:!1}},type:a.TOGGLE};case a.FOLDER_LINK_AUDIENCE_POLICY:if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return{title:o("Link restrictions"),description:o("Prevent non-members from accessing this folder via link."),optionsDict:{members:{label:o("On"),value:!0},anyone:{label:o("Off"),value:!1}},type:a.TOGGLE};default:throw new Error("Policy name not found")}},t})(s.SharingSettingsPolicyView);t.SharingSettingsFileFolderPolicyView=l}),define("modules/clean/sharing/views/sharing_settings_link_policies",["require","exports","tslib","modules/core/i18n","modules/clean/react/badge","modules/clean/sharing/sharing_settings_constants"],function(e,t,n,r,i,s){"use strict";function a(e,t,n){var r=n?i.BadgeVariant.PRO:void 0;switch(e){case s.REQUESTED_VISIBILITY:return{title:l("Who has access"),badge:r,description:(function(){return l(t?"Control who can view the folder with this link.":"Control who can view the file with this link.")})(),optionsDict:{public:{label:l("Anyone with link"),description:(function(){return l(t?"Anyone with this link can view the folder.":"Anyone with this link can view the file.")})()},team_only:{label:l("Team members"),description:(function(){return l(t?"Team members with this link can view the folder.":"Team members with this link can view the file.")})()},password:{label:l("People with password"),description:(function(){return l(t?"Password protect this link for viewing the folder.":"Password protect this link for viewing the file.")})()}},type:s.DROPDOWN};case s.EXPIRES:return{title:l("Expiration"),badge:r,description:l("Disable this link on a specific date."),optionsDict:{enabled:{label:l("On"),value:!0},disabled:{label:l("Off"),value:!1}},type:s.TOGGLE};case s.ALLOW_DOWNLOAD:return{title:l("Disable downloads"),badge:r,description:l("Prevent people with this link from downloading."),descriptionLinkUrl:"/help/files-folders/set-link-permissions",descriptionLinkText:l("Learn more"),optionsDict:{enabled:{label:l("On"),value:!0},disabled:{label:l("Off"),value:!1}},type:s.TOGGLE};case s.COMMENTS:return{title:l("Comments"),description:(function(){return l(t?"Anyone with this link viewing the folder can comment.":"Anyone with this link viewing the file can comment.")})(),descriptionLinkUrl:"/help/desktop-web/commenting#comments",descriptionLinkText:l("Learn more"),optionsDict:{},type:s.TEXT};default:throw new Error("Policy name not found")}}function o(e,t,n){var r=n?i.BadgeVariant.PRO:void 0;switch(e){case s.REQUESTED_VISIBILITY:return{title:l("Link access"),badge:r,description:(function(){return l(t?"Control who can access the folder via this link.":"Control who can access the file via this link.")})(),optionsDict:{public:{label:l("Anyone"),description:(function(){return l(t?"Anyone with the link can access the folder.":"Anyone with the link can access the file.")})()},team_only:{label:l("Team members"),description:(function(){return l(t?"Team members with the link can access the folder.":"Team members with the link can access the file.")})()},password:{label:l("Only people with the password"),description:(function(){return l(t?"Set a password to limit access to the folder via link.":"Set a password to limit access to the file via link.")})()}},type:s.DROPDOWN};case s.EXPIRES:return{title:l("Expiration"),badge:r,description:l("Disable the shared link on a specific date."),optionsDict:{enabled:{label:l("On"),value:!0},disabled:{label:l("Off"),value:!1}},type:s.TOGGLE};case s.ALLOW_DOWNLOAD:return{title:l("Disable downloads"),badge:r,description:l("Prevent people from downloading via link."),descriptionLinkUrl:"/help/files-folders/set-link-permissions",descriptionLinkText:l("Learn more"),optionsDict:{enabled:{label:l("On"),value:!0},disabled:{label:l("Off"),value:!1}},type:s.TOGGLE};case s.COMMENTS:return{title:l("Add comments"),description:(function(){return l(t?"Anyone viewing the files in this folder via link can comment.":"Anyone viewing the file via link can comment.")})(),descriptionLinkUrl:"/help/desktop-web/commenting#comments",descriptionLinkText:l("Learn more"),optionsDict:{},type:s.TEXT};default:throw new Error("Policy name not found")}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var l=r.i18n_default_project("sharing")._;t.getShmodelInMultipleLinksPolicyDict=a,t.getShmodelPolicyDict=o}),define("modules/clean/sharing/views/sharing_settings_link_policy_view",["require","exports","tslib","external/classnames","react","modules/core/i18n","modules/clean/sharing/constants","spectrum/datepicker","spectrum/input","modules/clean/filepath","modules/clean/datetime","modules/clean/em_string","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/views/sharing_settings_policy_view","spectrum-sharing/sharing_modal_banner","modules/clean/sharing/api/types/metadata","modules/clean/sharing/sharing_settings_constants"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importStar(s),a=n.__importStar(a);var g=s.i18n_default_project("sharing")._,S=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderLinkVisibility=function(){if(t.props.linkPolicy){var e,n=t.props.linkPolicy.requested_visibility,r=t.props.linkMetadata.link_permissions,s=r.visibility_policies.filter(function(e){return e.allowed}),a=r.visibility_policies[0].disallowed_reason;s.length<2&&(a===_.VisibilityDisallowedReason.restricted_by_shared_folder||a===_.VisibilityDisallowedReason.delete_and_recreate)&&(e=i.default.createElement(m.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:t.renderRestrictedBySharedFolderVisibility()}));var o,l,c=n===_.RequestedVisibilityPolicy.password,d=s.length>1,u=t.getPolicyDict(f.REQUESTED_VISIBILITY),p=s.map(function(e){return e.policy}),h=function(e){t.handlePolicyUpdate(f.REQUESTED_VISIBILITY,e)};if(l=t.renderDropdown(f.REQUESTED_VISIBILITY,n||"",u.optionsDict,p,h,!d),o=l,c){var g=r.visibility_policies.filter(function(e){return e.allowed&&e.policy===_.RequestedVisibilityPolicy.password}).length>0;o=i.default.createElement("div",null,l,i.default.createElement("div",{className:"u-pad-top-s"},t.renderPasswordInput(!g)))}return t.renderPolicyRow(f.REQUESTED_VISIBILITY,u,d,o,e)}},t.renderRestrictedBySharedFolderVisibility=function(){var e=t.props.linkMetadata.link_permissions.resolved_visibility,n=t.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason;return i.default.createElement("span",null,i.default.createElement("span",{className:"shared-link-settings-modal__visibility-text"},(function(){if(e===_.ResolvedVisibilityPolicy.shared_folder_only){var n=t.props.linkMetadata.link_permissions.restricting_shared_folder_path;return n=u.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),g("Only members of the shared folder “%(shared_folder_name)s” can view this link.").format({shared_folder_name:n})}return e===_.ResolvedVisibilityPolicy.only_you?g("Only you can view this link."):void 0})())," ",i.default.createElement("span",{className:"shared-link-settings-modal__visibility-advice u-font-meta"},(function(){return n===_.VisibilityDisallowedReason.restricted_by_shared_folder?g("To change who can access the link, go to the shared folder options."):n===_.VisibilityDisallowedReason.delete_and_recreate?g("To change who can access the link, delete this link and create a new one."):void 0})()))},t.renderExpire=function(){if(t.props.linkPolicy){var e,n=t.props.linkMetadata.link_permissions.can_remove_expiry,r=t.props.linkMetadata.link_permissions.can_set_expiry,s=n&&r,a=t.getPolicyDict(f.EXPIRES),o=null!=t.props.linkPolicy.expires,l=null!=t.props.linkPolicy.expires?"enabled":"disabled",c=t.renderToggle(f.EXPIRES,l,a.optionsDict,t.onExpireToggleChange,!s);return e=c,o&&(e=i.default.createElement("div",{className:"policy-expire"},c,t.renderDatepickerInput())),t.renderPolicyRow(f.EXPIRES,a,s,e)}},t.onExpireToggleChange=function(e,n){if(t.props.linkPolicy)if(e){var r=t.props.linkPolicy.expires;t.props.linkPolicy.expires||(r=d.daysAfterToday(30)),t.handlePolicyUpdate("expires",r)}else t.handlePolicyUpdate("expires",null)},t.renderDownload=function(){if(t.props.linkPolicy){var e,n=t.props.linkMetadata.link_permissions.can_disallow_download,r=t.props.linkMetadata.link_permissions.can_allow_download,s=t.props.linkMetadata.link_permissions.allow_download,a=null!=n&&null!=r&&null!=s,o=p.shouldRenderNoPreviewFileWarning(!t.props.isFolder,t.props.linkMetadata),l=n&&!o,d=t.props.linkPolicy.allow_download?"disabled":"enabled",u=t.getPolicyDict(f.ALLOW_DOWNLOAD),h=function(e,n){t.handlePolicyUpdate("allow_download",!e)},_=t.renderToggle(f.ALLOW_DOWNLOAD,d,u.optionsDict,h,!l);if(o){var S=c.file_extension(t.props.linkMetadata.name),E=S.toUpperCase();e=i.default.createElement(m.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:g("%(file_extension)s files can’t be previewed. Downloads must be enabled to share.",{comment:'as in "People can’t view this .PDF file'}).format({file_extension:"."+E})})}var v=t.renderPolicyRow(f.ALLOW_DOWNLOAD,u,l,_,e);return a||(v=i.default.createElement("div",null)),v}},t.renderComments=function(){var e=t.props.linkMetadata.link_permissions.team_restricts_comments,n=t.getPolicyDict(f.COMMENTS),r=t.renderPolicyRow(f.COMMENTS,n,!e);return e&&(r=i.default.createElement("div",null)),r},t.onDatepickerInputChange=function(e){t.handlePolicyUpdate("expires",e)},t.renderDatepickerInput=function(){return i.default.createElement(o.DatepickerInput,{disabledDays:t.getDisabledDays(),selectedDay:t.props.linkPolicy.expires,onDayClick:t.onDatepickerInputChange,placeholder:g("mm/dd/yyyy")})},t.onPasswordInputChange=function(e){t.handlePolicyUpdate(e.target.name,e.target.value)},t.handlePolicyUpdate=function(e,n){"expires"===e&&n instanceof Date&&null!=n&&(n.setHours(23),n.setMinutes(59),n.setSeconds(59));var r=t.props.linkPolicy.set(e,n);t.props.onPolicyUpdate(t.props.linkMetadata,r)},t}return n.__extends(t,e),t.prototype.render=function(){return i.default.createElement("div",null,this.renderLinkVisibility(),this.renderExpire(),this.renderDownload(),this.renderComments())},t.prototype.getPolicyDict=function(e){return this.props.getPolicyDict(e,this.props.isFolder,this.props.inPlusToProTrials)},t.prototype.getDisabledDays=function(){var e=Date.now();return{before:new Date(e)}},t.prototype.renderPasswordInput=function(e){return i.default.createElement("label",{className:r.default({"u-font-meta":e}),key:"visibility-label"},i.default.createElement(l.Input,{autoFocus:!0,className:"password-input__input",disabled:e,name:"link_password",onChange:this.onPasswordInputChange,placeholder:g("Set password"),type:"password",variant:this.props.linkPolicy.link_password?"default":"invalid",value:null!=this.props.linkPolicy.link_password?this.props.linkPolicy.link_password:"123456"}))},t})(h.SharingSettingsPolicyView);t.SharingSettingsLinkPolicyView=S}),define("modules/clean/sharing/views/sharing_settings_links_section",["require","exports","tslib","react","spectrum/button","spectrum-sharing/card","modules/clean/sharing/views/sharing_settings_link_policy_view","modules/clean/sharing/views/sharing_settings_righteous_link_policy_view","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/delete_link_modal","modules/clean/sharing/views/righteous_modal_link_info","modules/clean/sharing/views/sharing_settings_link_policies","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),p=n.__importStar(p);var h=p.i18n_default_project("sharing")._,m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClickDeleteLink=function(e){c.deleteLinkWithConfirm({client:t.props.client,url:e.url,contentName:e.name,onDeleteLink:function(){t.props.onDeleteLink(e)}})},t}return n.__extends(t,e),t.prototype.render=function(){var e=[];if(this.props.sharingInfo.isCloudDoc()){var t=this.props.sharingInfo.editRighteousLink(),n=this.props.sharingInfo.viewRighteousLink();e.push(this.renderLinkPolicy("editor",t)),e.push(this.renderLinkPolicy("viewer",n))}else{var i=this.props.sharingInfo.sharedLinks()[0];e.push(this.renderLinkPolicy("viewer",i))}return r.default.createElement("div",{className:"scl-sharing-settings-links-section"},e)},t.prototype.renderLinkPolicy=function(e,t){if(!t)return this.renderEmptyLinkPolicy(e);var n,i=this.props.updatedLinkPolicies[t.url],c=l.getLinkPolicy(t);return n=t.isRighteousLink()?r.default.createElement(o.SharingSettingsRighteousLinkPolicyView,{linkPolicy:i||c,linkMetadata:t,onPolicyUpdate:this.props.onPolicyUpdate}):r.default.createElement(a.SharingSettingsLinkPolicyView,{linkPolicy:i||c,linkMetadata:t,isFolder:t.isFolder(),inPlusToProTrials:this.props.inPlusToProTrials,onPolicyUpdate:this.props.onPolicyUpdate,getPolicyDict:u.getShmodelInMultipleLinksPolicyDict}),r.default.createElement(s.Card,{key:t.url||e,icon:d.getSpectrumLinkIcon(e),title:this.renderTitle(e),actions:this.renderLinkActions(t)},n)},t.prototype.renderLinkActions=function(e){return r.default.createElement(_,{linkMetadata:e,onClickDeleteLink:this.handleClickDeleteLink})},t.prototype.canCreateLink=function(e){return this.props.sharingInfo.isCloudDoc()&&"editor"===e?this.props.sharingInfo.permissionsObj().canCreateEditLink():this.props.sharingInfo.permissionsObj().canCreateViewLink()},t.prototype.renderEmptyLinkPolicy=function(e){return r.default.createElement(s.Card,{icon:d.getSpectrumLinkIcon(e),title:this.renderTitle(e)},r.default.createElement("div",{className:"sharing-settings-modal__link-policy"},r.default.createElement("div",{className:"sharing-settings-modal__link-policy-text"},h(this.canCreateLink(e)?"No link created yet.":"Link not available."))))},t.prototype.renderTitle=function(e){return h("editor"===e?"Link for editing":"Link for viewing")},t})(r.default.Component);t.SharingSettingsLinksSection=m;var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClickDelete=function(e){e.preventDefault(),t.props.onClickDeleteLink(t.props.linkMetadata)},t}return n.__extends(t,e),t.prototype.render=function(){return this.canDeleteLink()?r.default.createElement(i.Button,{variant:"borderless",onClick:this.handleClickDelete},h("Delete link")):null},t.prototype.canDeleteLink=function(){return this.props.linkMetadata.link_permissions.can_revoke},t})(r.default.Component);t.SharingSettingsLinkActions=_}),define("modules/clean/sharing/views/sharing_settings_policy_view",["require","exports","tslib","react","spectrum/toggle","spectrum-sharing/sharing_modal_settings_row","modules/clean/sharing/sharing_settings_dropdown","modules/clean/react/badge"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);var l=(function(e){function t(t){var n=e.call(this,t)||this;return n.sharingModalSettingsRowLinkClicked=function(e){window.open(e,"_blank")},n.renderPolicyRow=function(e,t,i,a,l){var c=r.default.createElement("span",null,t.title,t.badge?r.default.createElement(o.Badge,{variant:t.badge,color:o.BadgeColor.PINK}):void 0);return r.default.createElement(s.SharingModalSettingsRow,{policyFieldName:e,key:t.title,displayName:c,displayNameTitle:t.title,description:t.description,descriptionLinkUrl:t.descriptionLinkUrl,descriptionLinkText:t.descriptionLinkText,descriptionLinkOnClicked:n.sharingModalSettingsRowLinkClicked,rightSideElement:a,bottomElement:l})},n}return n.__extends(t,e),t.prototype.renderDropdown=function(e,t,n,i,s,o){return r.default.createElement(a.SettingDropdown,{currentValue:t,valuesList:i,optionsDict:n,onValueSelected:s,disabled:o})},t.prototype.renderToggle=function(e,t,n,s,a){var o=a?function(e,t){}:s;return r.default.createElement(i.Toggle,{ariaLabel:"toggle",className:"sharing-settings-modal__toggle",labelContent:n[t].label,checked:n[t].value,interactive:!a,disabled:a,onCheckedChange:o})},t})(r.default.Component);t.SharingSettingsPolicyView=l}),define("modules/clean/sharing/views/sharing_settings_righteous_link_policy_view",["require","exports","tslib","modules/core/i18n","modules/clean/sharing/views/sharing_settings_policy_view","modules/clean/sharing/sharing_settings_constants"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var a=r.i18n_default_project("sharing")._,o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderAudience=function(){var e=t.props.linkMetadata.link_permissions,n=t.props.linkPolicy.audience,r=t.getPolicyDict(s.AUDIENCE),i=e.audience_options.filter(function(e){return e.allowed}).map(function(e){return e.audience}),a=i.length>1,o=function(e){t.handlePolicyUpdate(s.AUDIENCE,e)},l=t.renderDropdown(s.AUDIENCE,n||"",r.optionsDict,i,o,!a);return t.renderPolicyRow(s.AUDIENCE,r,a,l)},t.handlePolicyUpdate=function(e,n){var r=t.props.linkPolicy.set(e,n);t.props.onPolicyUpdate(t.props.linkMetadata,r)},t}return n.__extends(t,e),t.prototype.render=function(){return this.renderAudience()},t.prototype.getPolicyDict=function(e){var t=this;switch(e){case s.AUDIENCE:return{title:a("Who has access"),description:(function(){return a("editor"===t.props.linkMetadata.link_permissions.link_access_level?"Control who can edit the file with this link.":"Control who can view the file with this link.")})(),optionsDict:{public:{label:a("Anyone with link"),description:(function(){return a("editor"===t.props.linkMetadata.link_permissions.link_access_level?"Anyone with this link can edit the file.":"Anyone with this link can view the file.")})()},team:{label:a("Team members"),description:(function(){return a("editor"===t.props.linkMetadata.link_permissions.link_access_level?"Team members with this link can edit the file.":"Team members with this link can view the file.")})()},no_one:{label:a("No one"),description:a("The link is off and does not grant additional access to anyone.")}},type:s.DROPDOWN};default:throw new Error("Policy name not found")}},t})(i.SharingSettingsPolicyView);t.SharingSettingsRighteousLinkPolicyView=o}),define("modules/clean/sharing/views/viewer_info",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){e.when_last_seen&&(this.time_last_seen=new Date(1e3*e.when_last_seen));var t=e.seen_state_user;this.account_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.photo_circle_url=t.photo_circle_url,this.same_team=!0}return e.prototype.displayName=function(){return this.display_name},e.prototype.memberId=function(){return this.account_id},e})();t.ViewerInfo=n}),define("modules/clean/sharing/views/wrapped_group_viewers_maker",["require","exports","tslib","react","modules/clean/datetime","modules/clean/em_string","modules/clean/react/title_bubble","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,r,i,s,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),l=n.__importStar(l);var c=l.i18n_default_project("sharing"),d=c._,u=c.ungettext;(function(e){function t(e,t){for(var i=u("%(num_viewers)d viewer","%(num_viewers)d viewers",e.length).format({num_viewers:e.length}),s=e.length<=10,o=s?e.length:9,l=n(e[0],t),c=1;c<o;c++)l=l.concat(n(e[c],t));if(!s){var d=e.length-o,p=u("and %(num_others)d other","and %(num_others)d others",d).format({num_others:d});l=l.concat(r.default.createElement("tr",null,r.default.createElement("td",{className:"group-tooltip__viewers-table-cell group-tooltip__member-name"},p)))}return{element:r.default.createElement(a.TitleBubble,{content:r.default.createElement("table",{className:"group-tooltip__viewers-table"},r.default.createElement("tbody",null,l)),className:"group-tooltip",children:r.default.createElement("span",{className:"u-font-meta sharing-member-info__viewer-count-text"},i),position:a.TitleBubble.POSITIONS.BOTTOM,isTargetPositionFixed:!0}),elementText:i}}function n(e,t){var n=t.has(e.account_id)?d("Viewing now"):i.ago(e.time_last_seen,!1,!0);return[r.default.createElement("tr",null,r.default.createElement("td",{className:"group-tooltip__viewers-table-cell group-tooltip__member-name"},s.Emstring.em_snippet(e.displayName(),o.SNIPPET_SIZES.DISPLAY_NAME)),r.default.createElement("td",{className:"group-tooltip__viewers-table-cell dot"},"·"),r.default.createElement("td",{className:"group-tooltip__viewers-table-cell group-tooltip__seen-string"},n))]}e.make=t})(t.WrappedGroupViewersMaker||(t.WrappedGroupViewersMaker={}))}),define("modules/clean/sharing/views/wrapped_sharing_modal_checkbox_row",["require","exports","tslib","react","external/react-dom","modules/clean/sharing/views/hover_close_button","modules/core/i18n","spectrum-sharing/sharing_modal_checkbox_row/index"],function(e,t,n,r,i,s,a,o){"use strict";function l(){d=!0}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importDefault(i),s=n.__importDefault(s),a=n.__importStar(a);var c=a.i18n_default_project("sharing")._,d=!0;t.resetModuleGlobals=l;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={renderInTooltip:d},t.onCloseButtonClick=function(){d=!1,t.setState({renderInTooltip:!1})},t.setCloseButtonRef=function(e){t.closeButton=e&&i.default.findDOMNode(e)},t}return n.__extends(t,e),
t.prototype.render=function(){var e;if(this.state.renderInTooltip){e={className:"checkbox-row-tooltip",content:r.default.createElement("div",{className:"content"},r.default.createElement("div",{className:"text-content"},r.default.createElement("div",{className:"header"},c("Let everyone know")),c("Check this box so others can see your message when viewing this file.")),r.default.createElement("div",null,r.default.createElement(s.default,{ref:this.setCloseButtonRef,className:"c-coach-mark__x",onClick:this.onCloseButtonClick}))),alwaysShow:!0}}return r.default.createElement(o.SharingModalCheckboxRow,n.__assign({},this.props,{tooltipData:e}))},t})(r.default.PureComponent);t.WrappedSharingModalCheckboxRow=u}),define("modules/clean/teams/membership_discovery_util",["require","exports","tslib","external/lodash","modules/clean/ajax","modules/clean/growth/gating","modules/clean/loggers/growth_features_events_logger","modules/clean/react/modal","modules/clean/stormcrow/experiment","modules/constants/teams","modules/constants/trademark","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importStar(i),a=n.__importStar(a),o=n.__importStar(o),c=n.__importStar(c),u=n.__importStar(u);(function(e){e.INVITE_MODAL_CLOSED="magnet-invite-modal-closed"})(t.MembershipDiscoveryEvents||(t.MembershipDiscoveryEvents={})),t.getDiscoverableTeamForFolder=function(e,t){return i.WebRequest({url:"/team/discover/get_discoverable_team_for_folder",type:"POST",data:{ns_id:e},success:function(e){return e=JSON.parse(e),t(null!=e?e.team:void 0)},error:function(){return t()}})},t.sendTeamRequest=function(e,t){return i.WebRequest({url:"/team/discover/join_ajax",data:{team_id:e,cont:"#"},success:function(e){switch(e=JSON.parse(e),null!=e?e.result:void 0){case"request_sent":h.Notify.success(p._("Request to join sent."));break;case"can_join":u.redirect(e.url);break;case"max_team_size_achieved":h.Notify.error(p._("This team has reached the maximum size. Please ask the admins of this team to upgrade to %(trademark_business)s, which allows teams to add as many members as possible.").format({trademark_business:d.TRADEMARK_BUSINESS}));break;case"pending_approval":h.Notify.success(p._("Your request to join is pending."));break;default:h.Notify.error(p._("Invalid request"))}return"function"==typeof t?t(e):void 0},error:function(){return h.Notify.error(p._("Error sending request.")),"function"==typeof t?t():void 0}})},t.sendLimitedTeamInvitations=function(e,t,n,r){return i.WebRequest({url:"/account/team/add_users",subject_user:t,data:{emails:e,team_id:n},success:function(e){if(e=JSON.parse(e),e.num_invited){var t=p.ungettext("Invitation sent.","Invitations sent.",e.num_invited);h.Notify.success(t)}r()},error:function(){var t=p.ungettext("Error sending invitation.","Error sending invitations.",e.length);h.Notify.error(t),r()}})},t.sendAdminTeamInvitations=function(e,n,r,s,l){return i.WebRequest({url:"/account/team/add_users",subject_user:n,data:{emails:e,team_id:r},success:function(t){var i={subject_user_id:n.id,team_id:r,num_suggested_users:e.length};if(a.logMagnetEvent("send_admin_invite_ajax_success",i),t=JSON.parse(t),t.num_invited){var s=p.ungettext("Invitation sent.","Invitations sent.",t.num_invited);h.Notify.success(s)}l()},error:function(i){var c={subject_user_id:n.id,team_id:r,num_suggested_users:e.length,response_text:i.responseText};return a.logMagnetEvent("send_admin_invite_ajax_fail",c),i.responseText.includes("You need an additional license to invite this user.")||i.responseText.includes("You need more licenses to invite these users.")?o.SimpleModal.show({title_text:p._("No available licenses"),body_html:p._("You don’t have enough available licenses to invite additional members. Please visit the admin console to purchase more licenses."),confirm_text:p._("Go to admin console"),confirm_callback:function(){return c={team_id:r,ui_object:"not_enough_licenses_modal"},a.logMagnetEvent("go_to_admin_console_clicked",c),u.redirect(new m.URI({path:"/team/admin/members",query:{invite_emails:btoa(e.join(","))}}))},cancel_text:p._("Not now"),cancel_callback:function(){c={team_id:r,ui_object:"not_enough_licenses_modal"},a.logMagnetEvent("not_now_clicked",c),l()}}):t.sendTeamSuggestions(e,s,function(){return u.redirect(new m.URI({path:"/team/admin/requests",query:{invite_emails:e}}))})}})},t.sendTeamSuggestions=function(e,t,n,r){return i.WebRequest({url:"/team/discover/suggest_ajax",data:{emails:JSON.stringify(e),ns_id:JSON.stringify(t)},success:function(t){var r=p.ungettext("Suggestion sent.","Suggestions sent.",e.length);return h.Notify.success(r),"function"==typeof n?n(t):void 0},error:function(){var t=p.ungettext("Error sending suggestion.","Error sending suggestions.",e.length);return h.Notify.error(t),"function"==typeof r?r():void 0}})},t.isLoggedExpUjMagnet2018=function(e){return e&&(a.EXP_UJ_MAGNET2018_LOGGED_VARIANTS.includes(c.UJ_MAGNET2018_ADMIN)||a.EXP_UJ_MAGNET2018_LOGGED_VARIANTS.includes(c.UJ_MAGNET2018_MEMBER))},t.isOnExpUjMagnet2018=function(e){return e&&(a.EXP_UJ_MAGNET2018_ON_VARIANTS.includes(c.UJ_MAGNET2018_ADMIN)||a.EXP_UJ_MAGNET2018_ON_VARIANTS.includes(c.UJ_MAGNET2018_MEMBER))},t.shouldShowMembershipSuggestionModal=function(e){return e&&(l.Experiment(c.UJ_MAGNET2018_ADMIN).variantIn("V1","V2")||l.Experiment(c.UJ_MAGNET2018_MEMBER).variantIn("V1","V2"))},t.shouldShowMembershipSuggestionBanner=function(){return l.Experiment(c.UJ_MAGNET2018_ADMIN).variantIs("V3")},t.filterSuggestableUsers=function(e,t,n){var s=t.reduce(function(t,n){return n.invalid||!n.email||n.dbx_team_id===e.team_dbtid||n.group_id||t.push(n.email),t},[]);if(s.length>0&&!r.isEqual(s,n)){return{emails:s,promise:new Promise(function(e,t){i.WebRequest({url:"/team/discover/filter_suggestable_ajax",type:"POST",data:{emails:JSON.stringify(s)},success:function(t){var n=JSON.parse(t);n.contacts&&n.contacts.length>0&&a.logMagnetEvent("share_modal_entered_out_of_team",{recipients:n.contacts.map(function(e){return e.id})}),e(n)},error:function(){t()}})}),ts:(new Date).getTime()}}return{}},t.showExpUjMagnet2018PostShare=function(e,t,n){if(t&&t.contacts&&t.contacts.length>0){var r=t.contacts,i=t.experiments;e(t.is_admin,r,t.team_size,i,n)}else n&&u.redirect(n.toString())},t.showExpUjMagnet2018PostShareIfQualified=function(e,n,r,i,s){t.shouldShowMembershipSuggestionModal(e)&&(r?r.then(function(e){t.showExpUjMagnet2018PostShare(n,e,s)}):i?t.showExpUjMagnet2018PostShare(n,i,s):s&&u.redirect(s.toString()))},t.maybeLogExpUjMagnet2018Exposure=function(e,t,n){if(e&&t&&t.contacts&&t.contacts.length>0){var r=t.is_admin?"uj_magnet2018_admin":"uj_magnet2018_member";return s.growthCheckGating(n,r),!0}return!1}}),define("modules/clean/teams/modals/create_team_prompt_modal",["require","exports","tslib","react","modules/clean/ajax","modules/clean/analytics","modules/clean/react/button","modules/clean/react/image","modules/clean/react/modal","modules/clean/static_urls","modules/clean/stormcrow/experiment","modules/clean/stormcrow/stormcrow_exposure_logger","modules/constants/teams","modules/constants/trademark","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,r,i,s,a,o,l,c,d,u,p,h,m,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),m=n.__importStar(m);var g;(function(e){e[e.CLICK_CREATE=0]="CLICK_CREATE",e[e.DISMISS=1]="DISMISS",e[e.CLICK_NEXT_TIME=2]="CLICK_NEXT_TIME"})(g||(g={}));var S=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCreate=function(){var e;if(t.isNbgWebClientFolderShareModal.variantIs("V1"))e=new f.URI({path:"/business/try"});else{var n=t.props.invitedMembers.map(function(e){return e.email}).filter(function(e){return"string"==typeof e&&""!==e});e=new f.URI({path:"/team",query:{tk:"tib_upsell",invite_members:n.join(",")}})}m.redirect(e.toString()),t.logClick(g.CLICK_CREATE)},t.onClickNextTime=function(){l.Modal.close(),t.logClick(g.CLICK_NEXT_TIME)},t.onDismiss=function(){i.WebRequest({url:"/team/stop_show_create_team_modal"}),t.logClick(g.DISMISS)},t}return n.__extends(t,e),Object.defineProperty(t.prototype,"isNbgWebClientFolderShareModal",{get:function(){return d.Experiment(p.NBG_WEB_CLIENT_FOLDER_SHARE_MODAL)},enumerable:!0,configurable:!0}),t.prototype.componentDidMount=function(){u.logVariantExposure("nbg_web_client_folder_share_modal",p.NBG_WEB_CLIENT_FOLDER_SHARE_MODAL)},t.prototype.logClick=function(e){s.TeamsWebActionsLogger.log("share_crt_team_modal",{num_shared:this.props.invitedMembers.length,clicked_create:e===g.CLICK_CREATE,clicked_nxt_time:e===g.CLICK_NEXT_TIME,dismissed:e===g.DISMISS})},t.prototype.renderButtons=function(){return r.default.createElement("div",{className:"db-modal-buttons"},r.default.createElement(a.Button,{className:"dbmodal-button",importance:"primary",onClick:this.onClickCreate},this.isNbgWebClientFolderShareModal.variantIs("V1")?_._("Try %(trademark_business)s free").format({trademark_business:h.TRADEMARK_BUSINESS}):_._("Create free work Dropbox")),r.default.createElement(a.Button,{className:"dbmodal-button",importance:"tertiary",onClick:this.onClickNextTime},_._("Ask me next time")))},t.prototype.render=function(){for(var e=[],t=0,n=this.props.invitedMembers;t<n.length;t++){var i=n[t];i.name&&i.name!==i.email&&e.push(i.name)}var s=_._("Work with these people often?");return 2===e.length&&2===this.props.invitedMembers.length?s=_._("Work with %(firstname_1)s and %(firstname_2)s often?").format({firstname_1:e[0],firstname_2:e[1]}):3===e.length&&3===this.props.invitedMembers.length&&(s=_._("Work with %(firstname_1)s, %(firstname_2)s, and %(firstname_3)s often?").format({firstname_1:e[0],firstname_2:e[1],firstname_3:e[2]})),r.default.createElement(l.Modal,{style:"clean",className:"create-team-modal-after-sharing",buttonComponent:this.renderButtons(),onDismiss:this.onDismiss,clickOutToClose:!1,showX:!0,width:500},r.default.createElement("div",null,this.isNbgWebClientFolderShareModal.variantIs("V1")?r.default.createElement(o.Image,{className:"create-team-modal__team-illo u-mar-top-l",alt:_._("Try %(trademark_business)s").format({trademark_business:h.TRADEMARK_BUSINESS}),src:c.static_url("/static/images/teams/modals/illo_create_team-vfloYU16I.png"),srcHiRes:c.static_url("/static/images/teams/modals/illo_create_team-vfloYU16I.png")}):r.default.createElement(o.Image,{className:"create-team-modal__team-illo u-mar-top-l",alt:_._("Work together"),src:c.static_url("/static/images/teams/modals/illo_how-create-vflQTQkfN.png"),srcHiRes:c.static_url("/static/images/teams/modals/illo_how-create@2x-vfld7opTv.png")}),r.default.createElement("h1",{className:"create-team-modal__header u-mar-top-m u-mar-bottom-s"},s),this.isNbgWebClientFolderShareModal.variantIs("V1")?r.default.createElement("div",{className:"create-team-modal__subheader create-team-modal__subheader--nbg-web-client-folder-share-modal"},_._("Join %(trademark_business)s to make collaborating easier, with more space to share files,                 more control, and dedicated support to help your team thrive.").format({trademark_business:h.TRADEMARK_BUSINESS})):r.default.createElement("div",{className:"create-team-modal__subheader"},_._("Get a free 2 GB work Dropbox to organize projects in one place,                 collaborate from anywhere, and stay in sync."))))},t})(r.default.Component);t.CreateTeamPromptModal=S}),define("spectrum-sharing/card/card",["require","exports","tslib","classnames","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseClassName="scl-card";var s=(function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(s,e),s.prototype.render=function(){var e=this.props.className,n=r(t.baseClassName,e);return i.createElement("div",{className:n},this.renderHeader(),this.renderBody())},s.prototype.renderHeader=function(){if(this.props.icon||this.props.title||this.props.actions)return i.createElement("div",{className:t.baseClassName+"__header"},this.props.icon&&i.createElement("div",{className:t.baseClassName+"__icon"},this.props.icon),this.props.title&&i.createElement("div",{className:t.baseClassName+"__title"},this.props.title),this.props.actions&&i.createElement("div",{className:t.baseClassName+"__actions"},this.props.actions))},s.prototype.renderBody=function(){return i.createElement("div",{className:t.baseClassName+"__body"},this.props.children)},s.displayName="Card",s})(i.PureComponent);t.Card=s}),define("spectrum-sharing/card",["require","exports","tslib","spectrum-sharing/card/card"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/fixed_tabbed_container/fixed_tabbed_container",["require","exports","tslib","classnames","react","spectrum/tabbed_header"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.activeTabId,n=e.className,a=e.onTabSelected,o=e.tabs,l=r("scl-fixed-tabbed-container",n);return i.createElement("div",{className:l},i.createElement("div",{className:"scl-fixed-tabbed-container__tabbed-header"},i.createElement(s.TabbedHeader,{onSelection:a,activeTabId:t},o.map(function(e){return i.createElement(s.Tab,{active:t===e.id,className:"sharing-settings-modal__tab-header",id:e.id,key:e.id},e.label)}))),i.createElement("div",{className:"scl-fixed-tabbed-container__content"},this.props.children))},t.displayName="FixedTabbedContainer",t})(i.PureComponent);t.FixedTabbedContainer=a}),define("spectrum-sharing/fixed_tabbed_container",["require","exports","tslib","spectrum-sharing/fixed_tabbed_container/fixed_tabbed_container"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/icons/icon_dropdown_caret",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconDropdownCaretOsx=function(e){var t=e.className,r=e.variant,i=void 0===r?"default":r;return n.createElement("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"9",height:"5",viewBox:"0 0 9 5"},n.createElement("path",{fill:"none",fillRule:"evenodd",stroke:"highlighted"===i?"#0269D9":"#3E3E3E",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8 1L4.5 4 1 1"}))},t.IconDropdownCaretWin=function(e){var t=e.className,r=e.variant,i=void 0===r?"default":r;return n.createElement("svg",{className:t,width:"12px",height:"6px",viewBox:"0 0 12 6",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"highlighted"===i?"#0269D9":"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",fillOpacity:"0.8"},n.createElement("g",{fill:"#000000"},n.createElement("polygon",{points:"6 5.01369863 11.4626866 0 12 0.493150685 6 6 0 0.493150685 0.537313433 0"}))))},t.IconDropdownCaretWeb=function(e){var t=e.className;return n.createElement("svg",{className:t,width:"7px",height:"4px",viewBox:"0 0 7 4",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-509.000000, -24.000000)",fill:"#637282"},n.createElement("g",{transform:"translate(444.000000, 16.000000)"},n.createElement("polygon",{points:"65 8 72 8 68.5 12"})))))},t.IconDropdownCaretBlueWeb=function(e){var t=e.className;return n.createElement("svg",{className:t,width:"7px",height:"4px",viewBox:"0 0 7 4",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-509.000000, -128.000000)",fill:"#007AF5"},n.createElement("polygon",{id:"Arrow",points:"509 128 516 128 512.5 132"}))))},t.IconDropdownCaretOsx.displayName="IconDropdownCaretOsx",t.IconDropdownCaretWin.displayName="IconDropdownCaretWin",t.IconDropdownCaretWeb.displayName="IconDropdownCaretWeb",t.IconDropdownCaretBlueWeb.displayName="IconDropdownCaretBlueWeb"}),define("spectrum-sharing/icons/icon_dropdown_selected",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconDropdownSelected=function(e){var t=e.className;return n.createElement("svg",{className:t,width:"12px",height:"12px",viewBox:"0 0 12 12",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{fill:"#3E3E3E",fillRule:"nonzero"},n.createElement("path",{d:"M2.25927473,6.3493149 C1.89985258,5.92998906 1.2685526,5.88142752 0.849226756,6.24084967\n                  C0.429900914,6.60027182 0.381339377,7.2315718 0.740761528,7.65089765 L3.65485393,11.0506721\n                  C3.75823486,11.1606625 3.75823486,11.1606625 3.87986598,11.2500569 C4.38534754,11.5870446\n                  5.06830382,11.4504534 5.40529152,10.9449718 L11.3320684,2.05480647 C11.6384209,1.59527778\n                  11.514247,0.974408438 11.0547183,0.668055979 C10.5951896,0.36170352 9.97432029,0.485877389\n                  9.66796784,0.945406077 L4.40019879,8.84705964 L2.25927473,6.3493149 Z"}))))},t.IconDropdownSelected.displayName="IconDropdownSelected",t.IconDropdownSelectedBlue=function(e){var t=e.className;return n.createElement("svg",{className:t,width:"14px",height:"11px",viewBox:"0 0 14 11",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-3.000000, -5.000000)",fill:"#0070E0"},n.createElement("path",{d:"M11,13 L11,3 L13,3 L13,13 L13,15 L7,15 L7,13 L11,13 Z",id:"Icon",transform:"translate(10.000000, 9.000000) rotate(-315.000000) translate(-10.000000, -9.000000) "}))))},t.IconDropdownSelectedBlue.displayName="IconDropdownSelectedBlue"}),define("spectrum-sharing/icons/icon_link",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={default:"transparent",active:"#D0D4D9",edit:"transparent",view:"transparent"},i=function(e){switch(e){case"edit":return s();case"view":return a();default:return o()}},s=function(){return n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-24.000000, -8.000000)"},n.createElement("g",null,n.createElement("g",{transform:"translate(24.000000, 8.000000)"},n.createElement("circle",{stroke:"#D0D4D9",strokeWidth:"1.32",cx:"16",cy:"16",r:"15.34"}),n.createElement("path",{d:"M21.0859375,13.1015625 L20.0195312,14.1679688 L17.8320312,11.9804688\n                L18.8984375,10.9140625 C19.007813,10.804687 19.1445304,10.75 19.3085938,10.75\n                C19.4726571,10.75 19.6093745,10.804687 19.71875,10.9140625 L21.0859375,12.28125\n                C21.195313,12.3906255 21.25,12.5273429 21.25,12.6914062 C21.25,12.8554696\n                21.195313,12.992187 21.0859375,13.1015625 Z M10.75,19.0625 L17.203125,12.609375\n                L19.390625,14.796875 L12.9375,21.25 L10.75,21.25 L10.75,19.0625 Z",fill:"#6A7C8F"})))))},a=function(){return n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-24.000000, -8.000000)"},n.createElement("g",null,n.createElement("g",{transform:"translate(24.000000, 8.000000)"},n.createElement("circle",{stroke:"#D0D4D9",strokeWidth:"1.32",cx:"16",cy:"16",r:"15.34"}),n.createElement("path",{d:"M14.7695312,14.7695312 C15.1158871,14.4231754 15.5260393,14.25 16,14.25\n                  C16.4739607,14.25 16.8841129,14.4231754 17.2304688,14.7695312 C17.5768246,\n                  15.1158871 17.75,15.5260393 17.75,16 C17.75,16.4739607 17.5768246,16.8841129\n                  17.2304688,17.2304688 C16.8841129,17.5768246 16.4739607,17.75 16,17.75 C15.5260393,\n                  17.75 15.1158871,17.5768246 14.7695312,17.2304688 C14.4231754,16.8841129 14.25,\n                  16.4739607 14.25,16 C14.25,15.5260393 14.4231754,15.1158871 14.7695312,14.7695312\n                  Z M13.921875,18.078125 C14.5052113,18.643232 15.1979127,18.9257812 16,18.9257812\n                  C16.8020873,18.9257812 17.4902315,18.6386747 18.0644531,18.0644531 C18.6386747,\n                  17.4902315 18.9257812,16.8020873 18.9257812,16 C18.9257812,15.1979127 18.6386747,\n                  14.5097685 18.0644531,13.9355469 C17.4902315,13.3613253 16.8020873,13.0742188 16,\n                  13.0742188 C15.1979127,13.0742188 14.5097685,13.3613253 13.9355469,13.9355469\n                  C13.3613253,14.5097685 13.0742188,15.1979127 13.0742188,16 C13.0742188,16.8020873\n                  13.356768,17.4947887 13.921875,18.078125 Z M12.0898438,12.828125 C13.2565163,\n                  12.0260377 14.5598886,11.625 16,11.625 C17.4401114,11.625 18.7434837,12.0260377\n                  19.9101562,12.828125 C21.0768288,13.6302123 21.915362,14.6874934 22.4257812,16\n                  C21.915362,17.3125066 21.0768288,18.3697877 19.9101562,19.171875 C18.7434837,\n                  19.9739623 17.4401114,20.375 16,20.375 C14.5598886,20.375 13.2565163,19.9739623\n                  12.0898438,19.171875 C10.9231712,18.3697877 10.084638,17.3125066 9.57421875,\n                  16 C10.084638,14.6874934 10.9231712,13.6302123 12.0898438,12.828125 Z",fill:"#667C91"})))))},o=function(){return n.createElement("g",{fill:"#6A7C8F",transform:"translate(16.071068, 16.071068) rotate(-315.000000)\n                  translate(-16.071068, -16.071068) translate(13.071068, 9.071068)"},n.createElement("path",{d:"M5.98487348,4.76239943 L4.58487348,4.76239943 L4.58487348,3.36107038\n                      C4.58487348,2.58309388 3.95807213,1.96239943 3.18487348,1.96239943\n                      C2.40628423,1.96239943 1.78487348,2.58860575 1.78487348,3.36107038\n                      L1.78487348,6.16372849 C1.78487348,6.94170499 2.41167483,7.56239943\n                      3.18487348,7.56239943 L3.18487348,8.96239943 C1.63847618,8.96239943\n                      0.384873479,7.70483456 0.384873479,6.16532106 L0.384873479,3.3594778\n                      C0.384873479,1.81469408 1.64162279,0.562399434 3.18487348,0.562399434\n                      C4.73127078,0.562399434 5.98487348,1.81996431 5.98487348,3.3594778\n                      L5.98487348,4.76239943 Z"}),n.createElement("path",{d:"M0.384873479,9.66239943 L1.78487348,9.66239943 L1.78487348,11.0637285\n                      C1.78487348,11.841705 2.41167483,12.4623994 3.18487348,12.4623994\n                      C3.96346273,12.4623994 4.58487348,11.8361931 4.58487348,11.0637285\n                      L4.58487348,8.26107038 C4.58487348,7.48309388 3.95807213,6.86239943\n                      3.18487348,6.86239943 L3.18487348,5.46239943 C4.73127078,5.46239943\n                      5.98487348,6.71996431 5.98487348,8.2594778 L5.98487348,11.0653211\n                      C5.98487348,12.6101048 4.72812417,13.8623994 3.18487348,13.8623994\n                      C1.63847618,13.8623994 0.384873479,12.6048346 0.384873479,11.0653211\n                      L0.384873479,9.66239943 Z"}))},l=function(e){var t=e.className,s=e.variant;return n.createElement("svg",{className:t,width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("circle",{stroke:"#D0D4D9",strokeWidth:"1.32",cx:"16",cy:"16",r:"15.34",fill:r[s||"default"]}),i(s||"default")))};t.IconLink=l}),define("spectrum-sharing/icons/icon_settings_gear",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return n.createElement("svg",{width:"24",height:"24",viewBox:"-4 -4 24 24"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-8.000000, -8.000000)",fill:"#6A7C8F"},n.createElement("path",{d:"M24,15.2 L24,17.1428571 L21.4857143,17.1428571 C21.2888229,17.8170566 21.0206419,\n            18.4683533 20.6857143,19.0857143 L22.0571429,21.0285714 L20.6857143,22.4 L18.8571429,\n            21.0285714 C18.2754139,21.325336 17.6619932,21.5553687 17.0285714,21.7142857 L16.8,24\n            L14.8571429,24 L14.5142857,21.8285714 C13.8530915,21.7734369 13.2201272,21.5360752\n            12.6857143,21.1428571 L10.8571429,22.5142857 L9.6,21.1428571 L10.9714286,19.0857143\n            C10.6251458,18.4858566 10.3926725,17.8271824 10.2857143,17.1428571 L8,17.0285714\n            L8,14.9714286 L10.2857143,14.7428571 C10.4547526,14.0951222 10.7247251,13.4780422\n            11.0857143,12.9142857 L9.6,11.0857143 L10.9714286,9.6 L12.8,10.9714286 C13.3973396,\n            10.711597 14.0076729,10.4827221 14.6285714,10.2857143 L14.9714286,8 L16.9142857,8\n            17.2571429,10.2857143 C17.9212591,10.4043389 18.5478652,10.678479 19.0857143,11.0857143\n            L20.9142857,9.6 L22.2857143,10.9714286 L20.9142857,12.9142857 C21.3270172,13.533851\n            21.5999981,14.2358018 21.7142857,14.9714286 L24,15.2 Z M16,19.4285714 C17.8935477,\n            19.4285714 19.4285714,17.8935477 19.4285714,16 C19.4285714,14.1064523 17.8935477,\n            12.5714286 16,12.5714286 C14.1064523,12.5714286 12.5714286,14.1064523 12.5714286,16\n            C12.5714286,17.8935477 14.1064523,19.4285714 16,19.4285714 Z"}))))};t.IconSettingsGear=r}),define("spectrum-sharing/input",["require","exports","tslib","spectrum-sharing/input/input"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/input/input",["require","exports","tslib","classnames","react","spectrum/input"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=e.variant,o=n.__rest(e,["className","variant"]),l=r("scl-input",t,"scl-input--"+a),c="borderless"===a?"default":a;return i.createElement(s.Input,n.__assign({className:l,variant:c},o))},t.displayName="Input",t})(i.PureComponent);t.Input=a}),define("spectrum-sharing/member_row",["require","exports","tslib","spectrum-sharing/member_row/member_row"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/member_row/member_row",["require","exports","tslib","classnames","react","spectrum/avatar","spectrum-sharing/scooter_loader","spectrum-sharing/sharing_avatar_initials","spectrum-sharing/sharing_portal_dropdown"],function(e,t,n,r,i,s,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDropdownChange=function(e){var n=t.props,r=n.id,i=n.onChange;i&&i(r,e)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.variant,s=void 0===n?"default":n,a=e.position,o=void 0===a?"default":a,l=e.tag,c=l||"li",d=r(t,{"scl-member-row":!0,"scl-member-row-borderless":"borderless"===s,"scl-member-row-default":"default"===s,"scl-member-row-narrow":"narrow"===s},{"scl-member-row-positioned":"bottom"===o||"middle"===o,"scl-member-row-bottom":"bottom"===o});return i.createElement(c,{className:d},i.createElement("div",{className:"scl-member-row-outer"},this.renderAvatar(),i.createElement("div",{className:"scl-member-row-info"},this.renderDisplayName(),this.renderMemberDetails())),this.renderRightSideElement())},t.prototype.renderAvatar=function(){var e=this.props,t=e.avatarHidden,n=e.avatarUrl,r=e.avatarElement,a=e.displayName,l=e.id,c=e.initials,d=e.initialAvatarShape;return t?i.createElement("div",{className:"scl-member-row-avatar-empty"}):r?r:n?i.createElement(s.Avatar,{src:n,className:"scl-member-row-avatar"}):i.createElement(o.SharingAvatarInitials,{avatarSize:32,backgroundColor:s.avatarColorForUserIdentifier(a||l),className:"scl-member-row-avatar",shape:d},c)},t.prototype.renderRightSideElement=function(){var e=this.props,t=e.id,n=e.loadingSpinnerVisible,r=e.optionGroup;return n?i.createElement(a.ScooterLoader,null):r&&1===r.options.length?i.createElement("div",null," ",r.label," "):r?i.createElement(l.SharingPortalDropdown,{id:t,optionGroup:r,onSelection:this.handleDropdownChange}):null},t.prototype.renderDisabledMessage=function(){return this.props.disabledMessage?[i.createElement("span",{className:"u-font-meta dot"}," · "),i.createElement("span",{className:"u-font-danger"}," ",this.props.disabledMessage)]:null},t.prototype.renderNameTitleAndText=function(){return i.createElement("span",{className:"scl-member-row-info-display-name-title",title:this.props.displayName},this.props.truncatedDisplayName||this.props.displayName)},t.prototype.renderPASSDot=function(){return this.props.passString?i.createElement("span",{className:"scl-member-row-dot"}," · "):null},t.prototype.renderOffTeamDot=function(){return this.props.offTeamMessage&&this.props.description?i.createElement("span",{className:"u-font-meta"}," · "):null},t.prototype.renderPASS=function(){var e=this.props,t=e.present,n=e.passString;if(n){var s=r({"scl-member-row-last-seen":!0,"scl-member-row-last-seen-not-present":!t});return i.createElement("span",{className:s},n)}return null},t.prototype.renderDisplayName=function(){return i.createElement("div",{className:"scl-member-row-display-name"},this.renderNameTitleAndText(),this.renderDisabledMessage(),this.renderPASSDot(),this.renderPASS())},t.prototype.renderOffTeamMessage=function(e){return e?i.createElement("span",{className:"u-font-meta"},e):null},t.prototype.renderMemberDetails=function(){var e=this.props,t=e.description,n=e.offTeamMessage,r=e.truncatedDescription;return i.createElement("div",{className:"scl-member-row-details"},i.createElement("span",{className:"scl-member-row-details-span",title:t},r||t),this.renderOffTeamDot(),this.renderOffTeamMessage(n))},t.displayName="MemberRow",t})(i.PureComponent);t.MemberRow=c}),define("spectrum-sharing/scooter_loader",["require","exports","tslib","spectrum-sharing/scooter_loader/scooter_loader"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/scooter_loader/scooter_loader",["require","exports","tslib","classnames","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScooterLoader=function(e){var t=e.className,s=n.__rest(e,["className"]);return i.createElement("div",n.__assign({className:r("scl-scooter-loader",t)},s),i.createElement("div",{className:"scl-scooter-loader-animation"}))},t.ScooterLoader.displayName="ScooterLoader"}),define("spectrum-sharing/sharing_avatar_initials",["require","exports","tslib","spectrum-sharing/sharing_avatar_initials/sharing_avatar_initials"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_avatar_initials/sharing_avatar_initials",["require","exports","tslib","classnames","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingAvatarInitials=function(e){var t=e.children,s=e.className,a=e.backgroundColor,o=e.avatarSize,l=void 0===o?32:o,c=e.variant,d=e.shape,u=n.__rest(e,["children","className","backgroundColor","avatarSize","variant","shape"]),p=r("scl-sharing-avatar-initials-"+l+"-"+d,{"scl-avatar-text-inactive":"inactive"===c,"scl-sharing-avatar-text":!0},s),h={background:""+a,border:"1px solid "+a,borderRadius:"square"===d?"12%":"50%",height:l+"px",width:l+"px"};return i.createElement("div",n.__assign({className:p,style:h},u),t)},t.SharingAvatarInitials.displayName="SharingAvatarInitials"}),
define("spectrum-sharing/sharing_contact_token",["require","exports","tslib","spectrum-sharing/sharing_contact_token/sharing_contact_token"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_contact_token/sharing_contact_token",["require","exports","tslib","react","spectrum/avatar","spectrum/tooltip"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.avatarUrl,n=e.displayName,a=e.validation,o=r.createElement("div",{style:{display:"flex",maxWidth:"200px"}},t&&r.createElement(i.Avatar,{size:16,src:t}),r.createElement("div",{style:{flex:"auto",marginLeft:"5px",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},n));return a&&"invalid"==a.state?r.createElement(s.Tooltip,{tooltipContent:a.msg?a.msg:""},o):o},t.displayName="SharingContactToken",t})(r.PureComponent);t.SharingContactToken=a}),define("spectrum-sharing/sharing_dropdown_menu",["require","exports","tslib","spectrum-sharing/sharing_dropdown_menu/sharing_dropdown_menu","spectrum-sharing/sharing_dropdown_menu/sharing_dropdown_menu_button","spectrum-sharing/sharing_dropdown_menu/sharing_dropdown_menu_item"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t),n.__exportStar(i,t),n.__exportStar(s,t)}),define("spectrum-sharing/sharing_dropdown_menu/sharing_dropdown_menu",["require","exports","tslib","classnames","react","spectrum/dropdown_menu"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseClassName="scl-sharing-dropdown-menu",t.SharingDropdownMenu=function(e){var a,o=e.position,l=e.className,c=n.__rest(e,["position","className"]),d=r(t.baseClassName,l,(a={},a[t.baseClassName+"--right"]="right"===o,a));return i.createElement(s.DropdownMenu,n.__assign({className:d},c))},t.SharingDropdownMenu.displayName="SharingDropdownMenu"}),define("spectrum-sharing/sharing_dropdown_menu/sharing_dropdown_menu_button",["require","exports","tslib","classnames","react","spectrum/dropdown_menu","spectrum-sharing/icons/icon_dropdown_caret"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="scl-sharing-dropdown-menu-button",l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,l=e.className,c=n.__rest(e,["children","className"]),d=r(o,l);return i.createElement(s.DropdownMenuButton,n.__assign({className:d},c),t,i.createElement(a.IconDropdownCaretOsx,{className:o+"__icon "+o+"__icon--osx"}),i.createElement(a.IconDropdownCaretWin,{className:o+"__icon "+o+"__icon--win"}))},t.displayName="SharingDropdownMenuButton",t})(i.PureComponent);t.SharingDropdownMenuButton=l}),define("spectrum-sharing/sharing_dropdown_menu/sharing_dropdown_menu_item",["require","exports","tslib","classnames","react","spectrum/dropdown_menu","spectrum-sharing/icons/icon_dropdown_selected"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="scl-sharing-dropdown-menu-item";t.SharingDropdownMenuItem=function(e){var t,l=e.description,c=e.label,d=e.selected,u=e.value,p=n.__rest(e,["description","label","selected","value"]);return i.createElement(s.MenuItem,n.__assign({className:o,key:u,value:u,text:c,selected:d},p),d&&i.createElement(a.IconDropdownSelected,{className:o+"__selected-icon"}),i.createElement("div",{className:r(o+"__wrapper",(t={},t[o+"__wrapper-selected"]=d,t))},i.createElement("div",{className:o+"__label"},c),l&&i.createElement("div",{className:o+"__description"},l)))},t.SharingDropdownMenuItem.displayName="SharingDropdownMenuItem"}),define("spectrum-sharing/sharing_menu",["require","exports","tslib","spectrum-sharing/sharing_menu/sharing_menu","spectrum-sharing/sharing_menu/sharing_menu_item"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t),n.__exportStar(i,t)}),define("spectrum-sharing/sharing_menu/sharing_menu",["require","exports","tslib","react","classnames","spectrum/dropdown_menu"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingMenu=function(e){var t=e.className,a=n.__rest(e,["className"]),o=i(t,"scl-sharing-menu");return r.createElement(s.Menu,n.__assign({className:o},a))},t.SharingMenu.displayName="SharingMenu"}),define("spectrum-sharing/sharing_menu/sharing_menu_item",["require","exports","tslib","classnames","react","spectrum/dropdown_menu","spectrum-sharing/icons/icon_dropdown_selected"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){var t=e.value,o=e.label,l=e.description,c=e.selected,d=e.variant,u=void 0===d?"default":d;n.__rest(e,["value","label","description","selected","variant"]);return i.createElement(s.MenuItem,{className:r({"scl-sharing-menu-item-border":"border"===u}),key:t,value:t,text:o,selected:c},c&&i.createElement(a.IconDropdownSelectedBlue,{className:"scl-sharing-menu-item-selected-icon"}),i.createElement("div",{className:r("scl-sharing-menu-item-wrapper",{"scl-sharing-menu-item-wrapper-selected":c})},i.createElement("div",{className:r("scl-sharing-menu-item-label",{"scl-sharing-menu-item-label-default":"default"===u,"scl-sharing-menu-item-label-red":"red"===u})},o),i.createElement("div",{className:"scl-sharing-menu-item-description"},l)))};t.SharingMenuItem=o}),define("spectrum-sharing/sharing_modal_checkbox_row/index",["require","exports","tslib","spectrum-sharing/sharing_modal_checkbox_row/sharing_modal_checkbox_row"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_modal_checkbox_row/sharing_modal_checkbox_row",["require","exports","tslib","classnames","react","spectrum/checkbox","spectrum/tooltip","spectrum/util/uuid_generator"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(t){var n=e.call(this,t)||this;return n.onCheckChanged=function(e){n.props.onCheckChanged("checked"===e)},n.checkboxId=o.generateUUID("scl-sharing-modal-checkbox-row"),n}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.checked,n=e.className,o=e.disabled,l=e.labelText,c=e.tooltipData,d=r("scl-sharing-modal-checkbox-row",n,{"scl-sharing-modal-checkbox-row--disabled":o}),u=i.createElement(s.Checkbox,{id:this.checkboxId,checked:t?"checked":"unchecked",disabled:o,onChange:this.onCheckChanged}),p=!(!c||!c.alwaysShow),h=c?i.createElement(a.Tooltip,{className:c.className,tooltipContent:c.content,isShowInitially:p,showOnMouseMove:!p,closeOnBlur:!p,positioning:c.positioning},u):u;return i.createElement("div",{className:d},h,i.createElement("label",{className:"scl-sharing-modal-checkbox-row__label",htmlFor:this.checkboxId},l))},t})(i.PureComponent);t.SharingModalCheckboxRow=l}),define("spectrum-sharing/sharing_modal_contacts_field",["require","exports","tslib","spectrum-sharing/sharing_modal_contacts_field/sharing_modal_contacts_field"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_modal_contacts_field/sharing_modal_contacts_field",["require","exports","tslib","classnames","react","spectrum/dropdown_menu","spectrum/tooltip","spectrum-sharing/sharing_dropdown_menu"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseClassName="scl-sharing-modal-contacts-field";var l=(function(e){function l(t){var n=e.call(this,t)||this;return n.renderDropdown=function(){var e=n.props,t=(e.className,e.labelledAccessTypes),r=e.selectedAccessType,l=e.showNoEditTooltip,c=e.noEditText,d=r?r.label:void 0,u=i.createElement(o.SharingDropdownMenu,{position:"right",onSelection:n.handleChange},i.createElement(o.SharingDropdownMenuButton,{disabled:l},d),i.createElement(s.Menu,null,t.map(function(e){return i.createElement(o.SharingDropdownMenuItem,{"aria-label":e.ariaLabel,description:e.details,key:e.apiId,label:e.label,selected:r&&r.apiId===e.apiId,value:e.apiId})})));return l?i.createElement(a.Tooltip,{positioning:"below",tooltipContent:c},u):u},n.handleChange=function(e){n.props.onAccessTypeChange&&n.props.onAccessTypeChange(e)},n}return n.__extends(l,e),l.prototype.render=function(){var e=this.props,n=e.className,s=e.toLabel,a=r(t.baseClassName,n);return i.createElement("div",{className:a},i.createElement("div",{className:t.baseClassName+"__left"},i.createElement("div",{className:t.baseClassName+"__to-label"},s),i.createElement("div",{className:t.baseClassName+"__input"},this.props.contactsField)),i.createElement("div",{className:t.baseClassName+"__right"},this.renderDropdown()))},l})(i.Component);t.SharingModalContactsField=l}),define("spectrum-sharing/sharing_modal_footer_inband",["require","exports","tslib","spectrum-sharing/sharing_modal_footer_inband/sharing_modal_footer_inband"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_modal_footer_inband/sharing_modal_footer_inband",["require","exports","tslib","classnames","react","spectrum/button"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.children,a=e.textButtonShare,o=e.isButtonShareDisabled,l=e.onClickButtonShare,c=r("scl-sharing-modal-footer-inband",t);return i.createElement("div",{className:c},n,i.createElement("div",{className:"scl-sharing-modal-footer-inband__spacer"}),i.createElement(s.Button,{variant:"primary",className:"scl-sharing-modal-footer-inband__button","aria-label":a,onClick:l,disabled:o},a))},t.defaultProps={isButtonShareDisabled:!1},t})(i.PureComponent);t.SharingModalFooterInband=a}),define("spectrum-sharing/sharing_modal_footer_link",["require","exports","tslib","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_create","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_disabled","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_loading","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_options","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_copy"],function(e,t,n,r,i,s,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t),n.__exportStar(i,t),n.__exportStar(s,t),n.__exportStar(a,t),n.__exportStar(o,t),n.__exportStar(l,t)}),define("spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link",["require","exports","tslib","classnames","react","spectrum-sharing/icons/icon_link"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseClassName="scl-sharing-modal-footer-link";var a=(function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(a,e),a.prototype.render=function(){var e=r(t.baseClassName,this.props.className);return i.createElement("div",{className:e},this.props.isIconHidden!==!0&&i.createElement("div",{className:t.baseClassName+"__icon"},this.props.icon?this.props.icon:i.createElement(s.IconLink,null)),i.createElement("div",{className:t.baseClassName+"__body"},this.props.body),i.createElement("div",{className:t.baseClassName+"__actions"},this.props.actions))},a})(i.PureComponent);t.SharingModalFooterLink=a}),define("spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_copy",["require","exports","tslib","react","classnames","spectrum/button","spectrum-sharing/icons/icon_link","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=i(o.baseClassName,o.baseClassName+"--copy",e.className);return r.createElement(o.SharingModalFooterLink,{className:t,icon:e.icon?e.icon:r.createElement(a.IconLink,{variant:"active"}),isIconHidden:e.isIconHidden,body:r.createElement("input",n.__assign({readOnly:!0,autoFocus:!0,value:e.sharedLinkUrl,onClick:c,onFocus:c,"aria-label":e.labelSharedLinkUrl,ref:e.textInputRef},e.inputProps)),actions:r.createElement(s.Button,{variant:"borderless",onClick:e.onClickButton},e.textButton)})};t.SharingModalFooterLinkCopy=l;var c=function(e){e.currentTarget.select()}}),define("spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_create",["require","exports","react","spectrum/button","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return n.createElement(i.SharingModalFooterLink,{className:e.className,icon:e.icon,body:e.statusNoLinkCreated,actions:n.createElement(r.Button,{variant:"borderless",onClick:e.onClickButtonCreateLink},e.textButtonCreateLink)})};t.SharingModalFooterLinkCreate=s}),define("spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_disabled",["require","exports","react","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return n.createElement(r.SharingModalFooterLink,{className:e.className,icon:e.icon,body:n.createElement("div",null,e.statusDisabledLink)})};t.SharingModalFooterLinkDisabled=i}),define("spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_loading",["require","exports","classnames","react","spectrum-sharing/scooter_loader","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){var t=n(s.baseClassName,s.baseClassName+"--loading",e.className);return r.createElement(s.SharingModalFooterLink,{className:t,icon:e.icon,body:r.createElement("div",{className:s.baseClassName+"--loading-body"},r.createElement("span",null,e.statusCreatingLink),r.createElement(i.ScooterLoader,null))})};t.SharingModalFooterLinkLoading=a}),define("spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link_options",["require","exports","react","spectrum/button","spectrum-sharing/sharing_modal_footer_link/sharing_modal_footer_link","spectrum-sharing/icons/icon_link"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return n.createElement(i.SharingModalFooterLink,{className:e.className,icon:e.icon?e.icon:n.createElement(s.IconLink,{variant:"active"}),body:e.statusLinkCreated,actions:n.createElement("div",null,n.createElement(r.Button,{key:"settings",variant:"borderless",onClick:e.onClickButtonLinkSettings},e.textButtonLinkSettings),n.createElement("span",{key:"separator",className:"scl-sharing-modal-footer-link__sep"},"•"),n.createElement(r.Button,{className:e.buttonCopyClassName,key:"copy",variant:"borderless",onClick:e.onClickButtonCopyLink},e.textButtonCopyLink))})};t.SharingModalFooterLinkOptions=a}),define("spectrum-sharing/sharing_modal_footer_link_list",["require","exports","tslib","spectrum-sharing/sharing_modal_footer_link_list/sharing_modal_footer_link_list"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_modal_footer_link_list/sharing_modal_footer_link_list",["require","exports","tslib","classnames","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseClassName="scl-sharing-modal-footer-link-list";var s=(function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(s,e),s.prototype.render=function(){var e=r(t.baseClassName,this.props.className);return i.createElement("div",{className:e},i.createElement("div",{className:t.baseClassName+"__header"},i.createElement("div",{className:t.baseClassName+"__title"},this.props.title),i.createElement("div",{className:t.baseClassName+"__actions"},this.props.actions)),i.createElement("div",{className:t.baseClassName+"__items"},this.props.children))},s})(i.PureComponent);t.SharingModalFooterLinkList=s}),define("spectrum-sharing/sharing_modal_header",["require","exports","tslib","spectrum-sharing/sharing_modal_header/sharing_modal_header","spectrum-sharing/sharing_modal_header/sharing_modal_header_title","spectrum-sharing/sharing_modal_header/sharing_modal_header_input"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t),n.__exportStar(i,t),n.__exportStar(s,t)}),define("spectrum-sharing/sharing_modal_header/sharing_modal_header",["require","exports","tslib","classnames","react","spectrum/button","spectrum/icon_form","spectrum-sharing/icons/icon_settings_gear"],function(e,t,n,r,i,s,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseClassName="scl-sharing-modal-header";var l=(function(e){function l(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(l,e),l.prototype.render=function(){var e=this.props,n=e.children,s=e.className,a=e.closeButtonVisible,o=e.icon,l=e.settingsButtonVisible,c=r(t.baseClassName,s);return i.createElement("div",{className:c},i.createElement("div",{className:t.baseClassName+"__icon"},o),i.createElement("div",{className:t.baseClassName+"__children"},n),l&&this.renderSettingsButton(),a&&this.renderCloseButton())},l.prototype.renderSettingsButton=function(){return i.createElement(s.Button,{"aria-label":"settings",className:t.baseClassName+"__settings",onClick:this.props.onClickSettingsButton,variant:"styleless"},i.createElement(o.IconSettingsGear,null))},l.prototype.renderCloseButton=function(){return i.createElement(s.Button,{"aria-label":"close",className:t.baseClassName+"__close",onClick:this.props.onClickCloseButton,variant:"styleless"},i.createElement(a.IconForm,{name:"cancel"}))},l.defaultProps={closeButtonVisible:!1,settingsButtonVisible:!1},l})(i.PureComponent);t.SharingModalHeader=l}),define("spectrum-sharing/sharing_modal_header/sharing_modal_header_input",["require","exports","tslib","react","spectrum-sharing/input","spectrum-sharing/sharing_modal_header/sharing_modal_header"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setInputRef=function(e){t.input=e},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.inputAriaLabel,a=e.inputAutoFocus,o=e.inputPlaceholder,l=e.onInputBlur,c=e.onInputChange,d=e.onInputFocus,u=e.onInputKeyUp,p=n.__rest(e,["inputAriaLabel","inputAutoFocus","inputPlaceholder","onInputBlur","onInputChange","onInputFocus","onInputKeyUp"]);return r.createElement(s.SharingModalHeader,n.__assign({closeButtonVisible:!0},p),r.createElement(i.Input,{ref:this.setInputRef,className:s.baseClassName+"__input",variant:"borderless","aria-label":t,autoFocus:a,onChange:c,onFocus:d,onBlur:l,onKeyUp:u,placeholder:o}),this.props.children)},t.displayName="SharingModalHeaderInput",t})(r.PureComponent);t.SharingModalHeaderInput=a}),define("spectrum-sharing/sharing_modal_header/sharing_modal_header_title",["require","exports","tslib","react","spectrum-sharing/sharing_modal_header/sharing_modal_header"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.title,s=e.subTitle,a=n.__rest(e,["title","subTitle"]);return r.createElement(i.SharingModalHeader,n.__assign({},a),r.createElement("div",{className:i.baseClassName+"__title"},t),s&&r.createElement("div",{className:i.baseClassName+"__sub-title"},s))},t.displayName="SharingModalHeaderTitle",t})(r.PureComponent);t.SharingModalHeaderTitle=s}),define("spectrum-sharing/sharing_modal_message_field",["require","exports","tslib","spectrum-sharing/sharing_modal_message_field/sharing_modal_message_field"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_modal_message_field/sharing_modal_message_field",["require","exports","tslib","classnames","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.children,s=e.onChange,a=e.value,o=e.placeholder,l=r("scl-sharing-modal-message-field",t);return i.createElement("div",{className:l},i.createElement("textarea",{"aria-label":o,className:"scl-textarea",placeholder:o,onChange:s,value:a}),n)},t.displayName="SharingModalMessageField",t})(i.PureComponent);t.SharingModalMessageField=s}),define("spectrum-sharing/sharing_modal_settings_row",["require","exports","tslib","spectrum-sharing/sharing_modal_settings_row/sharing_modal_settings_row"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_modal_settings_row/sharing_modal_settings_row",["require","exports","tslib","classnames","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleLinkClicked=function(e){e.preventDefault(),t.props.descriptionLinkOnClicked&&t.props.descriptionLinkUrl&&t.props.descriptionLinkOnClicked(t.props.descriptionLinkUrl)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.rightSideElement,s=e.bottomElement,a=r("scl-sharing-modal-settings-row",t);return i.createElement("div",{className:a},i.createElement("div",{className:"scl-sharing-modal-settings-row-outer"},i.createElement("div",{className:"scl-sharing-modal-settings-row-info"},i.createElement("div",{className:"scl-sharing-modal-settings-row-display-name"},i.createElement("span",{className:"scl-sharing-modal-settings-row-info-display-name-title",title:this.props.displayNameTitle},this.props.displayName)),i.createElement("div",{className:"scl-sharing-modal-settings-row-details"},i.createElement("span",{className:"scl-sharing-modal-settings-row-details-span",title:this.props.description},this.props.description,this.props.descriptionLinkUrl&&this.props.descriptionLinkText&&i.createElement("span",null," ",i.createElement("a",{className:"scl-sharing-modal-settings-row-description-link",href:"#",onClick:this.handleLinkClicked},this.props.descriptionLinkText))))),n&&i.createElement("div",{className:"scl-sharing-modal-settings-right-element"},n)),s&&i.createElement("div",{className:"scl-sharing-modal-settings-bottom-element"},s))},t.displayName="SharingModalSettingsRow",t})(i.PureComponent);t.SharingModalSettingsRow=s}),define("spectrum-sharing/sharing_portal_dropdown",["require","exports","tslib","spectrum-sharing/sharing_portal_dropdown/sharing_portal_dropdown"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(r,t)}),define("spectrum-sharing/sharing_portal_dropdown/sharing_portal_dropdown",["require","exports","tslib","classnames","react","react-dom","react-aria-menubutton","spectrum/util/uuid_generator","spectrum/positioned_portal","spectrum/button","spectrum-sharing/icons/icon_dropdown_caret","spectrum-sharing/sharing_menu"],function(e,t,n,r,i,s,a,o,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.dropdownId=o.generateUUID("portalDropdown"),n.handleResizeEvent=function(){n.state.isOpen&&n.resolvePortalPosition()},n.handleScrollEvent=function(){n.state.isOpen&&n.resolvePortalPosition()},n.onMenuToggle=function(e){var t=e.isOpen;t||n.positionedPortalEl.hidePortal(),n.setState({isOpen:t})},n.handlePortalDidShow=function(){a.openMenu(n.dropdownId,{focusMenu:!1})},n.state={isOpen:!1},n}return n.__extends(t,e),t.prototype.componentDidUpdate=function(e,t){this.state.isOpen&&this.positionedPortalEl?(this.mountListeners(),this.resolvePortalPosition()):this.positionedPortalEl&&this.unMountListeners()},t.prototype.componentWillUnmount=function(){this.unMountListeners()},t.prototype.mountListeners=function(){document.addEventListener("scroll",this.handleScrollEvent,!1),window.addEventListener("resize",this.handleResizeEvent,!1)},t.prototype.unMountListeners=function(){document.removeEventListener("scroll",this.handleScrollEvent,!1),window.removeEventListener("resize",this.handleResizeEvent,!1)},t.prototype.resolvePortalPosition=function(){if(this.positionedPortalEl&&this.positionedPortalEl.portalInstance.portalContentElementRef){var e=s.findDOMNode(this.positionedPortalEl);if(!(e instanceof Element))throw new Error("Unable to find PositionedPortal DOM node - check if this SharingPortalDropdown is still mounted");var t=e.getElementsByClassName("scl-sharing-portal-dropdown-button");if(!t.length)throw new Error("Unable to find SharingPortalDropdownButton - check if this SharingPortalDropdown is still mounted");var n=t[0],r=this.positionedPortalEl.portalInstance.portalContentElementRef,i=n.getBoundingClientRect(),a=r.getBoundingClientRect(),o={top:0,left:0};o=i.bottom+a.height>window.innerHeight?{top:i.top-a.height-10,left:i.left+i.width-a.width}:{top:i.top+i.height+10,left:i.left+i.width-a.width},r.style.top=o.top+"px",r.style.left=o.left+"px"}},t.prototype.render=function(){var e=this,t=this.props,n=t.optionGroup,s=t.onSelection,o=(t.id,n.options.filter(function(e){return n.selectedApiId===e.apiId})[0]),p=function(){return i.createElement(a.Wrapper,{id:e.dropdownId,onSelection:s,onMenuToggle:e.onMenuToggle},i.createElement(a.Button,{className:"scl-sharing-portal-dropdown-button-invisible"},o.label),i.createElement(u.SharingMenu,{className:"scl-sharing-portal-menu"},n.options.map(function(e){return i.createElement(u.SharingMenuItem,{description:e.tooltip,key:e.apiId,label:e.label,selected:n.selectedApiId===e.apiId,value:e.apiId,variant:e.variant})})))},h=function(){return e.state.isOpen?i.createElement(d.IconDropdownCaretBlueWeb,{className:"scl-sharing-portal-dropdown-icon scl-sharing-portal-dropdown-icon-web"}):i.createElement(d.IconDropdownCaretWeb,{className:"scl-sharing-portal-dropdown-icon scl-sharing-portal-dropdown-icon-web"})};return i.createElement(l.PositionedPortal,{closeOnBlur:!1,ref:function(t){return e.positionedPortalEl=t},renderContent:p,role:"sharing-dropdown",showOnMouseMove:!1,showOnClick:!0,onDidShow:this.handlePortalDidShow},i.createElement(c.Button,{className:r("scl-sharing-portal-dropdown-button",{"scl-sharing-portal-dropdown-button-expanded":this.state.isOpen}),variant:"styleless"},o.label,h()))},t})(i.PureComponent);t.SharingPortalDropdown=p}),define("spectrum/icon_acl",["require","exports","tslib","tslib","react","spectrum/icon_templates/stateless","spectrum/icon_bundles/acl"],function(e,t,n,r,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importStar(i),t.ICONS=a.ICONS,t.IconAcl=function(e){var t=e.name,n=a.ICONS[t],o=n.attrs,l=n.innerHtml,c=i.createElement("svg",r.__assign({focusable:"false"},o,{dangerouslySetInnerHTML:{__html:l}}));return i.createElement(s.Component,r.__assign({icon:c},e))},t.IconAcl.displayName="IconAcl"}),define("spectrum/icon_bundles/acl",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS={"link-edit":{attrs:{width:"32",height:"32",viewBox:"0 0 32 32"},innerHtml:'<path fill-rule="evenodd" clip-rule="evenodd" d="M19.9 9.17l1.377-1.377a1 1 0 0 1 1.415 0l1.364 1.364a1 1 0 0 1 0 1.414l-1.377 1.377L19.9 9.17zM9.653 19.415l9.193-9.192 2.779 2.779-9.193 9.192-2.779-2.779zM8.6 20.441l2.778 2.779-3.219 1.073a.5.5 0 0 1-.632-.633L8.6 20.441z" fill="#000"></path>'},"link-small":{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<g fill="none" fill-rule="evenodd"><path d="M5 12c0-1.657 1.347-3 2.997-3h3.006A3 3 0 0 1 14 12v3H7.997A3 3 0 0 1 5 12zm1.5 0c0 .834.672 1.5 1.5 1.5h1.5V15H14v-2.5h-1.5v-.505c0-.818-.67-1.495-1.499-1.495H8c-.834 0-1.499.672-1.499 1.5z" fill="#637282"></path><path d="M19 12c0 1.657-1.347 3-2.997 3h-3.006A3 3 0 0 1 10 12V9h6.003A3 3 0 0 1 19 12zm-1.5 0c0-.834-.672-1.5-1.5-1.5h-1.5V9H10v2.5h1.5v.505c0 .818.67 1.495 1.499 1.495H16c.834 0 1.499-.672 1.499-1.5z" fill="#637282"></path></g>'},"link-view":{attrs:{width:"32",height:"32",viewBox:"0 0 32 32"},innerHtml:'<path fill-rule="evenodd" clip-rule="evenodd" d="M16 22c3.524 0 6.612-2.572 8.324-4.348a2.354 2.354 0 0 0 0-3.304C22.612 12.572 19.524 10 16 10s-6.612 2.572-8.324 4.348a2.354 2.354 0 0 0 0 3.304C9.388 19.428 12.476 22 16 22zm0-2c2.153 0 3.899-1.79 3.899-4S18.153 12 16 12s-3.899 1.79-3.899 4 1.746 4 3.899 4z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16 18.5c1.346 0 2.437-1.12 2.437-2.5S17.346 13.5 16 13.5c-1.346 0-2.437 1.12-2.437 2.5s1.091 2.5 2.437 2.5z" fill="#000"></path>'},link:{attrs:{width:"32",height:"32",viewBox:"0 0 32 32"},innerHtml:'<g fill="none" fill-rule="evenodd"><g fill="#637282"><path d="M6 16c0-2.21 1.794-4 4.007-4h4.986A4.006 4.006 0 0 1 19 16v4h-8.993A4.006 4.006 0 0 1 6 16zm2 0c0 1.112.898 2 2.005 2H13v2h6v-3h-2v-.999c0-1.1-.894-2.001-1.997-2.001H9.997A2 2 0 0 0 8 16z"></path><path d="M26 16c0 2.21-1.794 4-4.007 4h-4.986A4.006 4.006 0 0 1 13 16v-4h8.993A4.006 4.006 0 0 1 26 16zm-2 0c0-1.112-.898-2-2.005-2H19v-2h-6v3h2v.999c0 1.1.894 2.001 1.997 2.001h5.006A2 2 0 0 0 24 16z"></path></g></g>'}}});
//# sourceMappingURL=pkg-sharing.min.js-vfltNKqAR.map