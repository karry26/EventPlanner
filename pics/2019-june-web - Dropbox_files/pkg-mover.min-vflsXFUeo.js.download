define("modules/clean/react/dropins_v3/mover/api_client",["require","exports","tslib","modules/clean/react/dropins_v3/shared/user_friendly_error","modules/clean/react/fileops_actions","modules/clean/cloud_docs/utils"],function(e,t,o,r,n,a){"use strict";function i(e){return void 0!==e.cloud_doc_id}function s(e){return void 0!==e.id}function l(){return o.__awaiter(this,void 0,Promise,function(){var t;return o.__generator(this,function(r){switch(r.label){case 0:return[4,new Promise(function(t,o){e(["modules/clean/api_v2/user_client"],t,o)}).then(o.__importStar)];case 1:return t=r.sent().UserApiV2Client,[2,(new t).ns("cloud_docs")]}})})}function c(){return o.__awaiter(this,void 0,Promise,function(){var t;return o.__generator(this,function(r){switch(r.label){case 0:return[4,new Promise(function(t,o){e(["modules/clean/api_v2/user_client"],t,o)}).then(o.__importStar)];case 1:return t=r.sent().UserApiV2Client,[2,(new t).ns("files")]}})})}function d(e,t,r){return o.__awaiter(this,void 0,Promise,function(){var n;return o.__generator(this,function(o){switch(o.label){case 0:return n=a.replaceInvalidFilenameChars(t.name),[4,l()];case 1:return[2,o.sent().rpc("alpha/dropin_move",{cloud_doc_id:t.cloud_doc_id,to_path:r+"/"+n},{subjectUserId:e.id})]}})})}function u(e,t){return o.__awaiter(this,void 0,Promise,function(){var r;return o.__generator(this,function(o){switch(o.label){case 0:return r={"Dropbox-API-Path-Root":'{".tag": "root", "root": "'+e.root_ns_id+'"}'},[4,c()];case 1:return[2,o.sent().rpc("get_metadata_batch",{paths:t.map(function(e){return e.id})},{subjectUserId:e.id,headers:r})]}})})}function f(e,t,o){return Promise.all(t.map(function(t){return d(e,t,o)}))}function p(e,t,a){return o.__awaiter(this,void 0,Promise,function(){var i,s,l;return o.__generator(this,function(c){switch(c.label){case 0:return 0===t.length?[2,Promise.resolve([])]:(i=u(e,t),[4,i.then(function(e){return e.entries.map(function(e){if(void 0!==e.path_lower)return{fq_path:e.path_lower};throw new r.UserFriendlyError("path_lower is undefined","Oops! Seems like the file does not exist!")})})]);case 1:return s=c.sent(),l={user:e,path:"",files:s,newPath:a,checkFSWs:!0},[2,new Promise(function(e,t){n.moveFiles(o.__assign({},l,{onSuccess:e,onRequestNotSent:t}))})]}})})}function m(e,t,o){var r=t.filter(function(e){return i(e)}),n=t.filter(function(e){return s(e)});return Promise.all([f(e,r,o),p(e,n,o)]).then(function(){})}Object.defineProperty(t,"__esModule",{value:!0}),n=o.__importStar(n),t.entryIsCloudDoc=i,t.entryIsFile=s,t.moveEntriesToFolder=m}),define("modules/clean/react/dropins_v3/mover/host_site",["require","exports","tslib","modules/clean/react/dropins_v3/shared/host_site"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.onSuccess=function(){this.sendMessage("success"),this.closeDialog()},t.prototype.onCancel=function(){this.sendMessage("cancel"),this.closeDialog()},t.prototype.onError=function(e){this.sendMessage("error",e.message),this.closeDialog()},t})(r.BaseHostSite);t.HostSite=n}),define("modules/clean/react/dropins_v3/mover/mover_page",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/folder_dialog/api","modules/clean/react/dropins_v3/mover/api_client","modules/clean/react/dropins_v3/mover/host_site","modules/clean/web_timing_logger","modules/core/notify","modules/clean/react/dropins_v3/mover/mover_parent","modules/clean/react/dropins_v3/shared/vortex_logger","modules/clean/react/dropins_v3/shared/timeout","modules/clean/viewer"],function(e,t,o,r,n,a,i,s,l,c,d,u,f,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importDefault(r);var m=(function(e){function t(t){var o=e.call(this,t)||this;return o.state={accountId:t.accountId,initialFolderSelection:t.initialFolderSelection,entries:null},o.vortexLogger=new u.VortexLogger(t.appKey,t.statPrefix),o.hostSite=new s.HostSite(t.origin,c.Notify),o.hostSite.listen({onState:function(e){return o.setState(e)},onClose:function(){return window.close()}}),o.hostSite.ready(),o}return o.__extends(t,e),t.prototype.render=function(){var e={moveEntriesToFolder:i.moveEntriesToFolder,getFolderContents:a.getFolderContents};return r.default.createElement("div",{className:"dropins-mover-page"},r.default.createElement(d.MoverParent,{viewer:p.Viewer.get_viewer(),hostSite:this.hostSite,apiClient:e,webTimer:l.get_timer(),vortexLogger:this.vortexLogger,timeout:f.timeout,accountId:this.state.accountId,entries:this.state.entries,initialFolderSelection:this.state.initialFolderSelection}))},t.displayName="MoverPage",t})(r.default.Component);t.MoverPage=n.requireCssWithComponent(m,["/static/css/dropins_v3/mover/mover-vfleqj52c.css","/static/css/foundation-vfl3eJ4da.css","/static/css/notify-vfla0opVr.css"])}),define("modules/clean/react/dropins_v3/mover/mover_parent",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/dropins_v3/shared/vortex_logger","modules/clean/react/folder_dialog/move_dialog","modules/clean/react/folder_dialog/constants","modules/clean/react/dropins_v3/mover/api_client"],function(e,t,o,r,n,a,i,s,l){"use strict";function c(e,t){for(var o=t.get_users(!1),r=0,n=o;r<n.length;r++){var a=n[r];if(e===a.account_id)return a}return null}function d(e){if("string"!=typeof e.accountId)return new Error("accountId must be provided, and it must be a string");if(null!==e.entries){if(!(e.entries instanceof Array))return new Error("entries must be provided, and they must be an array");for(var t=0,o=e.entries;t<o.length;t++){var r=o[t];if(l.entryIsCloudDoc(r)){if("string"!=typeof r.cloud_doc_id)return new Error("cloud doc must have a cloud_doc_id of type string");if("string"!=typeof r.name)return new Error("cloud doc must have a name of type string")}else{if(!l.entryIsFile(r))return new Error("entry must be a file with field id or cloud doc with field cloud_doc_id");if("string"!=typeof r.id)return new Error("entry must have an id of type string");if("boolean"!=typeof r.is_dir)return new Error("file must have field is_dir of type boolean")}}}return"string"!=typeof e.initialFolderSelection?new Error("initialFolderSelection must be provided, and it must be a string"):null}Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importDefault(r);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSuccess=function(){var e=t.props,o=e.hostSite,r=e.timeout,n=e.vortexLogger;a.logRateBeforeCallback(n,r,"move_success",function(){o.onSuccess()})},t.handleCancel=function(){var e=t.props,o=e.hostSite,r=e.timeout,n=e.vortexLogger;a.logRateBeforeCallback(n,r,"move_cancel",function(){o.onCancel()})},t.handleError=function(e){var o=t.props,r=o.hostSite,n=o.timeout,i=o.vortexLogger;a.logRateBeforeCallback(i,n,"move_error",function(){r.onError(e)})},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.webTimer.waitForTTI().then(function(){e.props.vortexLogger&&e.props.vortexLogger.logRate("page_start",1)})},t.prototype.getDialogProps=function(e){var t=this.props,o=t.apiClient,r=t.entries,n=t.initialFolderSelection,a=t.webTimer,i=r&&r.map(function(e){return l.entryIsCloudDoc(e)?{is_dir:!1}:{is_dir:e.is_dir}}),c={getFolderContents:o.getFolderContents,moveToFolder:function(){return Promise.resolve()}};if(r&&r.length>0){var d=r;c.moveToFolder=function(t){return o.moveEntriesToFolder(e,d,t)}}return{apiClient:c,user:e,initialFolderSelection:n,operation:s.Operation.MOVE,entries:i,webTimer:a,onSuccess:this.handleSuccess,onCancel:this.handleCancel,onError:this.handleError}},t.prototype.render=function(){var e=this.props,t=e.accountId,n=e.hostSite,a=e.viewer,s=d(this.props);if(s)return this.props.hostSite.onError(s),null;var l=c(t,a);return l?r.default.createElement("div",{className:"dropins-mover-parent"},r.default.createElement(i.MoveDialog,o.__assign({},this.getDialogProps(l)))):(n.onError(new Error("user with given accountId is not logged in")),null)},t.displayName="Mover",t})(r.default.Component);t.MoverParent=n.requireCssWithComponent(u,["/static/css/dropins_v3/mover/mover-vfleqj52c.css","/static/css/foundation-vfl3eJ4da.css","/static/css/notify-vfla0opVr.css"])}),define("modules/clean/react/folder_dialog/api",["require","exports","tslib","modules/clean/ajax","modules/clean/api_v2/user_client"],function(e,t,o,r,n){"use strict";function a(e,t){var o={folder:t};return new Promise(function(t,n){r.WebRequestOref({url:"/browse_util/tree_view_folders",type:"POST",subject_user:e,data:o,dataType:"json",skipNotifyError:!0}).then(t,function(e,t,o){return n(o)})})}function i(e,t,o){return(new n.UserApiV2Client).ns("ml").rpc("get_folder_suggestion",{paths:t,action:o},{subjectUserId:e})}Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importStar(r),t.getFolderContents=a,t.getFolderSuggestion=i}),define("modules/clean/react/folder_dialog/constants",["require","exports","modules/core/i18n"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_SCOPE="folder_picker_keyboard_selection",t.INVALID_FOCUS_INDEX=-1,t.MAX_FOLDER_NAME_LENGTH=20,t.TEAM_MEMBER="team_member";(function(e){e[e.ACCESS=0]="ACCESS",e.LIMITED_ACCESS="locked",e.NO_ACCESS="no_access"})(t.ACCESS_LEVEL||(t.ACCESS_LEVEL={}));(function(e){e[e.COPY=0]="COPY",e[e.MOVE=1]="MOVE",e[e.UPLOAD=2]="UPLOAD",e[e.EXPORT_LEGAL_HOLD=3]="EXPORT_LEGAL_HOLD"})(t.Operation||(t.Operation={}));(function(e){e[e.LOADING=0]="LOADING",e[e.ERROR=1]="ERROR",e[e.LOADED=2]="LOADED"})(t.FolderPickerLoadingState||(t.FolderPickerLoadingState={})),t.errorDialogProps={primaryAction:o._("Try again"),secondaryAction:o._("Cancel"),title:o._("Something went wrong on our end"),ariaLabel:"",open:!0,variant:"regular"},t.DIALOG_HEAD_HEIGHT=64,t.DIALOG_ACTIONS_HEIGHT=64,t.PATH_BREADCRUMB_HEIGHT=40,t.DIALOG_BODY_PADDING=26,t.LOADING_MIN_TIME=200,t.FOLDER_SUGGESTION_HEIGHT=89,t.DEFAULT_REVISION_ID="0000000000000000"}),define("modules/clean/react/folder_dialog/folder_picker",["require","exports","tslib","external/classnames","external/keymaster","react","external/react-dom","external/lodash","spectrum/button","spectrum/dimensions","spectrum/tooltip","spectrum/icon_global","spectrum/icon_arrow","spectrum/icon_content","spectrum/media_table","spectrum/table","spectrum/table/table_head_cell","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/css","modules/clean/react/folder_dialog/constants","modules/clean/react/icon/folder_icon","modules/clean/react/path_breadcrumbs","modules/clean/react/selectable_list","modules/core/exception","modules/core/i18n","modules/clean/static_urls","modules/clean/react/image"],function(e,t,o,r,n,a,i,s,l,c,d,u,f,p,m,h,g,_,S,v,E,C,F,b,w,L,y,P,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importDefault(r),n=o.__importDefault(n),a=o.__importDefault(a),i=o.__importStar(i),s=o.__importStar(s),L=o.__importStar(L);var I="",D=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.props.onClick(t.props.folder,t.props.index)},t.handleMouseOver=function(){t.props.onHover(t.props.folder)},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.folder,n=e.isSelected,i=e.isFocused,s=S.Emstring.em_snippet(v.filename(t.path),C.MAX_FOLDER_NAME_LENGTH),l=[a.default.createElement(m.MediaCell,{key:s,icon:a.default.createElement(p.IconContent,{name:t.icon,disabled:!t.isClickable}),title:s}),a.default.createElement(m.MediaCell,{key:"has_subdirs",icon:t.hasSubfolders&&t.isClickable?a.default.createElement(f.IconArrow,{name:"right"}):void 0})],c={className:r.default({folder_picker_row:!0,read_only:!t.isClickable,focused:i,selected:n}),variant:n?"selected":"default"};t.isClickable&&(c=o.__assign({},c,{onClick:this.handleClick,onMouseOver:this.handleMouseOver}));var d=(c.ref,o.__rest(c,["ref"]));return a.default.createElement(m.MediaRow,o.__assign({},d),l)},t})(a.default.Component);t.FolderPickerRow=D;var k=(function(e){function t(t){var c=e.call(this,t)||this;return c.preloadErrorImages=function(){var e=new Image;e.src=P.static_url("/static/images/illustration_catalog/dropbox_somethings_not_working-vfl2QXPxi.png"),e.srcset=P.static_url("/static/images/illustration_catalog/dropbox_somethings_not_working@2x-vflkcbmXv.png")+" 2x"},c.setStatus=function(e,t){e!==c.state.loadingState&&(c.cancelStatusTimeout(),t?c.setState({loadingState:e,loadingStateShown:e}):(c.setState({loadingState:e}),c.statusTimeout=setTimeout(function(){c.setState({loadingStateShown:e})},C.LOADING_MIN_TIME)))},c.cancelStatusTimeout=function(){void 0!==c.statusTimeout&&clearTimeout(c.statusTimeout),c.statusTimeout=void 0},c.setPathWithErrorHandling=function(e){c.setPath(e).catch(c.handleError)},c.handleError=function(e){c.props.onError(e),c.props.onFolderSelected(),c.setStatus(C.FolderPickerLoadingState.ERROR)},c.canInstantlySetPath=function(e){if(c.cachedFolders.has(v.normalize(e).toLowerCase())&&c.cachedFolders.has(v.normalize(v.parent_dir(e)).toLowerCase()))return!0;if(c.cachedFolders.has(v.normalize(v.parent_dir(e)).toLowerCase())){var t=s.find(c.cachedFolders.get(v.normalize(v.parent_dir(e)).toLowerCase()),function(t){return t.path===e});if(t&&!t.hasSubfolders)return!0}return!1},c.setPath=function(e){return o.__awaiter(c,void 0,void 0,function(){var t,r,n,a,i,l,c,d,u,f,p;return o.__generator(this,function(o){switch(o.label){case 0:return t=this.props,r=t.onFolderSelected,n=t.onDataLoaded,a=t.user,i=[],l=!1,this.setState({loadingPath:e}),d=this.canInstantlySetPath(e),this.setStatus(C.FolderPickerLoadingState.LOADING,!0),d||r(void 0,void 0),v.paths_are_equal(e,"/")?[4,this.fetchFolderContents("/")]:[3,3];case 1:return i=o.sent(),[4,this.canSelectRoot()];case 2:return l=o.sent(),c=a.root_ns_id,[3,11];case 3:return[4,this.fetchFolderContents(v.parent_dir(e))];case 4:if(u=o.sent(),f=s.find(u,function(t){return v.paths_are_equal(t.path,e)}),!f)throw new Error("Could not find folder in API response");return c=f.nsId,l=f.isSelectable,f.hasSubfolders?[4,this.fetchFolderContents(e)]:[3,6];case 5:return p=o.sent(),[3,8];case 6:return[4,this.fetchFolderContents(v.parent_dir(e))];case 7:p=o.sent(),o.label=8;case 8:return i=p,f.hasSubfolders&&0===i.length?(f.hasSubfolders=!1,[4,this.fetchFolderContents(v.parent_dir(e))]):[3,11];case 9:return i=o.sent(),[4,this.fetchFolderContents(v.parent_dir(v.parent_dir(e)))];case 10:o.sent(),o.label=11;case 11:return d||n(e),this.setStatus(C.FolderPickerLoadingState.LOADED,d),this.setState({path:e,folders:i,focusIndex:this.getFolderIndex(i,e),isFolderSuggestionSelected:!1}),l?r(e,c):r(void 0,void 0),[2]}})})},c.setupKeyboardShortcuts=function(){I=n.default.getScope(),I!==C.KEY_SCOPE&&n.default.setScope(C.KEY_SCOPE),n.default("up",C.KEY_SCOPE,c.handleFocusPrevious),n.default("down",C.KEY_SCOPE,c.handleFocusNext),n.default("left",C.KEY_SCOPE,c.handleSelectParent),n.default("right",C.KEY_SCOPE,c.handleSelectCurrentFolder),n.default("space",C.KEY_SCOPE,c.handleSelectCurrentFolder),n.default("enter",C.KEY_SCOPE,c.handleSelect)},c.cleanupKeyboardShortcuts=function(){n.default.clearScope(C.KEY_SCOPE),I&&n.default.setScope(I),n.default.resetFilter()},c.getUrlForBreadcrumb=function(){return"#"},c.getAccessLevel=function(e){return e.icon.endsWith(C.ACCESS_LEVEL.NO_ACCESS)?C.ACCESS_LEVEL.NO_ACCESS:e.icon.endsWith(C.ACCESS_LEVEL.LIMITED_ACCESS)||e.read_only?C.ACCESS_LEVEL.LIMITED_ACCESS:C.ACCESS_LEVEL.ACCESS},c.convertJsonFolderToFolder=function(e){var t=c.props.canSelectReadonly,o=e.path,r=e.icon,n=e.has_subdirs,a=e.contained_ns,i=c.getAccessLevel(e);return{path:o,icon:F.convertLegacyFolderIconToSpectrum(r,"small"),hasSubfolders:n,isSelectable:i===C.ACCESS_LEVEL.ACCESS||i===C.ACCESS_LEVEL.LIMITED_ACCESS&&t,isClickable:i===C.ACCESS_LEVEL.ACCESS||i===C.ACCESS_LEVEL.LIMITED_ACCESS&&(t||n),nsId:a}},c.fetchFolderSuggestion=function(){return o.__awaiter(c,void 0,void 0,function(){var e,t,r,n,a,i,s;return o.__generator(this,function(o){switch(o.label){case 0:e=this.props,t=e.apiClient,r=e.user,n=e.onFetchFolderSuggestionSuccess,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.fetchFolderSuggestion(r.id)];case 2:return a=o.sent().path,n(a),this.setState({isFolderSuggestionLoading:!1,folderSuggestion:a}),[3,4];case 3:return i=o.sent(),s=i.raw?i.raw.responseBody:"Received error response from folder suggestion API",L.reportException({err:new Error(s),tags:["folder_suggestion"],severity:L.SEVERITY.NONCRITICAL}),this.setState({isFolderSuggestionLoading:!1}),[3,4];case 4:return[2]}})})},c.handleFolderHover=function(e){var t=c.state,o=t.folders,r=t.focusIndex,n=c.getFolderIndex(o,e.path);n!==r&&c.setState({focusIndex:n})},c.handleFolderClick=function(e,t,o){c.props.onRowClicked(e.path,t,!!o),c.setPathWithErrorHandling(e.path)},c.handleBreadcrumbClick=function(e){var t=e.path;c.props.onBreadcrumbClicked(t),c.setPathWithErrorHandling(t)},c.handleFocusPrevious=function(){c.hasNotLoaded||c.focusNeighboringItem(w.SelectDirection.PREV)},c.handleFocusNext=function(){c.hasNotLoaded||c.focusNeighboringItem(w.SelectDirection.NEXT)},c.handleSelectParent=function(){c.hasNotLoaded||c.setPathWithErrorHandling(v.parent_dir(c.state.path))},c.handleSelectCurrentFolder=function(){var e=c.state,t=e.focusIndex,o=e.folders,r=e.path,n=c.getFolderIndex(o,r);c.hasNotLoaded||t===n||c.handleSelect()},c.handleSelect=function(){if(!c.hasNotLoaded){var e=c.state,t=e.focusIndex,o=e.folders,r=e.path;c.getFolderIndex(o,r)===t?c.props.onSuccess():c.handleFolderClick(o[t],t,!0)}},c.handleTryAgainClick=function(){c.cachedFolders.delete(v.normalize(c.state.loadingPath).toLowerCase()),c.cachedFolders.delete(v.parent_dir(c.state.loadingPath).toLowerCase()),c.setPathWithErrorHandling(c.state.loadingPath)},c.setTableRef=function(e){c.table=e?i.findDOMNode(e):void 0},c.handleFolderSuggestionClick=function(e){c.props.onFolderSuggestionClick(),c.setState({isFolderSuggestionSelected:!0}),c.props.onFolderSelected(e)},c.handleFolderSuggestionLocationClick=function(e){c.props.onFolderSuggestionLocationClick(),c.setPathWithErrorHandling(e)},c.renderErrorMessage=function(){return c.state.loadingStateShown!==C.FolderPickerLoadingState.ERROR?null:a.default.createElement("div",{className:"folder-picker__error"},a.default.createElement(O.Image,{src:P.static_url("/static/images/illustration_catalog/dropbox_somethings_not_working-vfl2QXPxi.png"),srcHiRes:P.static_url("/static/images/illustration_catalog/dropbox_somethings_not_working@2x-vflkcbmXv.png"),alt:""}),a.default.createElement("span",null,y._("Something went wrong on our end.")),a.default.createElement(l.Button,{variant:"primary",onClick:c.handleTryAgainClick},y._("Try again")))},c.renderLoadingMessage=function(){return c.state.loadingStateShown===C.FolderPickerLoadingState.LOADING||c.state.isFolderSuggestionLoading?a.default.createElement("tr",{className:"folder-picker-loading"},a.default.createElement("td",null,a.default.createElement("span",{className:"folder-picker-view__loading-label"},y._("Loading your folders…")))):null},c.renderFolders=function(){if(c.hasNotLoaded)return null;var e=c.state,t=e.focusIndex,o=e.loadingStateShown,r=e.isFolderSuggestionSelected;return c.state.folders.map(function(e,n){return a.default.createElement(D,{key:e.path,folder:e,index:n,isSelected:v.paths_are_equal(c.state.path,e.path)&&o===C.FolderPickerLoadingState.LOADED&&!r,isFocused:n===t,onClick:c.handleFolderClick,onHover:c.handleFolderHover})})},c.renderEmptyMessage=function(){return c.hasNotLoaded?null:c.state.folders.length||!v.paths_are_equal(c.state.path,"/")?null:a.default.createElement("tr",{className:"folder-picker__empty-message"},a.default.createElement("td",{className:"u-font-center u-pad-top-xl"},a.default.createElement(O.Image,{src:P.static_url("/static/images/empty_states/folder-picker-vfl3_Hwxf.png"),srcHiRes:P.static_url("/static/images/empty_states/folder-picker@2x-vfl7Aum9o.png"),alt:""}),a.default.createElement("h2",{className:"u-pad-top-l"},y._("This is the only folder there is."))))},c.renderFolderSuggestion=function(){var e=c.state.folderSuggestion;return c.state.loadingStateShown!==C.FolderPickerLoadingState.ERROR&&e?c.renderFolderSuggestionTable(e):null},c.renderFolderSuggestionTable=function(e){var t=c.state.isFolderSuggestionSelected,o=r.default("brws-file-row folder-suggestion-row",{"brws-file-row-selected":t});return a.default.createElement(h.Table,{className:"brws-files-view-list folder-suggestion-table","aria-rowcount":1},a.default.createElement(h.TableHead,null,a.default.createElement(g.TableHeadCell,{className:"brws-column-header-table-cell",role:"columnheader",scope:"col"},c.renderFolderSuggestionHeadText(),c.renderFolderSuggestionHeadInfoIcon())),a.default.createElement(h.TableBody,null,a.default.createElement(m.CulledMediaRow,{className:o,topOffset:0,onClick:function(){return c.handleFolderSuggestionClick(e)}},function(t){var o=t.isHovered;return c.renderFolderSuggestionRow(e,o)})))},c.renderFolderSuggestionHeadText=function(){var e=y._("Suggested location");return a.default.createElement("span",null,e," ")},c.renderFolderSuggestionHeadInfoIcon=function(){var e=y._("Based on previous activity and file type");return a.default.createElement(d.Tooltip,{positioning:"above",tooltipContent:e},a.default.createElement(u.IconGlobal,{name:"help",className:"icon-help"}))},c.renderFolderSuggestionRow=function(e,t){return a.default.createElement(m.MediaCell,{className:"brws-file-name-cell folder-suggestion-name-cell",icon:c.renderFolderSuggestionIcon()},a.default.createElement("div",{className:"brws-file-name-cell-text brws-vertically-center"},c.renderFolderSuggestionTitle(e,t),c.renderFolderSuggestionSubtitle(e)))},c.renderFolderSuggestionIcon=function(){return a.default.createElement(p.IconContent,{className:"brws-file-name-cell-icon",name:"folder-small"})},c.renderFolderSuggestionTitle=function(e,t){var o=v.filename(e);return a.default.createElement(m.MediaCellText,{key:"title",highlight:t},a.default.createElement("div",{className:"brws-file-name-element"},a.default.createElement("span",null,o)))},c.renderFolderSuggestionSubtitle=function(e){var t=c.props.user,o=v.parent_dir(e),r=v.paths_are_equal(o,"/")?_.get_browse_root_name(t):o.slice(1),n=y._("in %(location)s",{comment:"Describes the parent directory of a folder."}).format({location:r}),i=function(e){e.stopPropagation(),e.preventDefault(),c.handleFolderSuggestionLocationClick(o)};return a.default.createElement(m.MediaCellText,{key:"subtitle",variant:"subtitle"},a.default.createElement("a",{role:"button",className:"brws-file-name-cell-location folder-suggestion-location",href:"#",onClick:i},n))},c.cachedFolders=new Map,c.state={folders:[],focusIndex:C.INVALID_FOCUS_INDEX,loadingState:C.FolderPickerLoadingState.LOADING,loadingStateShown:C.FolderPickerLoadingState.LOADING,path:t.initialPath,loadingPath:t.initialPath,folderSuggestion:void 0,isFolderSuggestionLoading:!!t.showFolderSuggestion&&!!t.apiClient.fetchFolderSuggestion,isFolderSuggestionSelected:!1},c}return o.__extends(t,e),t.prototype.componentDidMount=function(){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.setPath(v.normalize(this.props.initialPath))];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),this.handleError(e),[3,3];case 3:return this.state.isFolderSuggestionLoading?[4,this.fetchFolderSuggestion()]:[3,5];case 4:t.sent(),t.label=5;case 5:return this.preloadErrorImages(),[2]}})})},t.prototype.componentWillUnmount=function(){this.cancelStatusTimeout()},Object.defineProperty(t.prototype,"hasNotLoaded",{get:function(){return this.state.loadingStateShown!==C.FolderPickerLoadingState.LOADED||this.state.isFolderSuggestionLoading},enumerable:!0,configurable:!0}),t.prototype.canSelectRoot=function(){var e=this.props,t=e.user;return e.canSelectReadonly||!t.is_cdm_member||t.is_cdm_member&&"edit"===t.user_root_permissions},t.prototype.getFolderIndex=function(e,t){return s.findIndex(e,function(e){return v.paths_are_equal(e.path,t)})},t.prototype.focusNeighboringItem=function(e){var t=this,o=this.state,r=o.folders,n=o.focusIndex,a=r.length,i=n;e===w.SelectDirection.PREV&&n===C.INVALID_FOCUS_INDEX&&i++;for(var s=0;s<a;s++)if(e===w.SelectDirection.PREV?i=(i+a-1)%a:e===w.SelectDirection.NEXT&&(i=(i+1)%a),r[i].isClickable){this.setState({focusIndex:i});break}setTimeout(function(){return t.scrollToFocused()})},t.prototype.scrollToFocused=function(){if(this.table){var e=this.table.getElementsByTagName("tbody").item(0);if(e){var t=this.table.getElementsByClassName("focused").item(0);if(t){var o=t.getBoundingClientRect().top,r=t.getBoundingClientRect().bottom,n=e.getBoundingClientRect().top,a=e.getBoundingClientRect().bottom;o<n||o>a?e.scrollTop+=o-n:r>a&&(e.scrollTop+=r-a)}}}},t.prototype.fetchFolderData=function(e){return o.__awaiter(this,void 0,Promise,function(){var t,r,n,a,i,s;return o.__generator(this,function(o){switch(o.label){case 0:return t=this.props,r=t.apiClient,n=t.user,[4,r.getFolderContents(n.id,e)];case 1:return a=o.sent(),i=a.map(this.convertJsonFolderToFolder),s=n.cdm_tmf_path&&v.paths_are_equal(e,"/")?i.filter(function(e){return v.paths_are_equal(e.path,n.cdm_tmf_path)}).concat(i.filter(function(e){return!v.paths_are_equal(e.path,n.cdm_tmf_path)})):i,this.cachedFolders.set(v.normalize(e).toLowerCase(),s),[2,s]}})})},t.prototype.fetchFolderContents=function(e){return o.__awaiter(this,void 0,Promise,function(){var t;return o.__generator(this,function(o){return t=v.normalize(e),[2,this.cachedFolders.get(t.toLowerCase())||this.fetchFolderData(t)]})})},t.prototype.renderTable=function(e){var t=this.props.rootName,o=this.state.path;if(!e||this.state.loadingStateShown===C.FolderPickerLoadingState.ERROR)return null;var r=e-C.PATH_BREADCRUMB_HEIGHT-(this.state.folderSuggestion?C.FOLDER_SUGGESTION_HEIGHT:0);return a.default.createElement(h.Table,{columnFlex:[9,1],className:"folder-picker-table",ref:this.setTableRef},a.default.createElement(h.TableHead,null,a.default.createElement(g.TableHeadCell,{className:"folder-picker__breadcrumbs"},a.default.createElement(b.PathBreadcrumbs,{firstBreadcrumbName:t,firstBreadcrumbAlt:t,getUrlForPath:this.getUrlForBreadcrumb,setUrl:this.handleBreadcrumbClick,path:o,size:b.PathBreadcrumbsSize.SMALL}))),a.default.createElement(h.TableBody,{tabIndex:0,className:"folder-picker-view",style:{height:r},onFocus:this.setupKeyboardShortcuts,onBlur:this.cleanupKeyboardShortcuts},this.renderLoadingMessage(),this.renderFolders(),this.renderEmptyMessage()))},t.prototype.render=function(){var e=this;return a.default.createElement(c.Dimensions,{className:"folder-picker-container"},function(t){var o=t.height;return a.default.createElement("div",{className:"folder-picker"},e.renderErrorMessage(),e.renderFolderSuggestion(),e.renderTable(o))})},t.defaultProps={initialPath:"/",onDataLoaded:s.noop,onRowClicked:s.noop,onBreadcrumbClicked:s.noop,onFetchFolderSuggestionSuccess:s.noop,onFolderSuggestionClick:s.noop,onFolderSuggestionLocationClick:s.noop},t})(a.default.Component);t.FolderPicker=E.requireCssWithComponent(k,["/static/css/browse/browse-vfl6zoniw.css","/static/css/react/folder_picker-vflIBh6K8.css","/static/css/scooter/scooter-scoped-vflWuydQl.css"])}),define("modules/clean/react/folder_dialog/move_dialog",["require","exports","tslib","react","external/lodash","spectrum/button","spectrum/dimensions","modules/clean/filepath","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/browse/actions","modules/clean/react/css","modules/clean/react/folder_dialog/constants","modules/clean/react/folder_dialog/folder_picker","modules/clean/react/folder_dialog/utils","modules/clean/sharing/browse_exports","modules/clean/viewer","modules/core/i18n"],function(e,t,o,r,n,a,i,s,l,c,d,u,f,p,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importDefault(r),n=o.__importStar(n);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.handleSuccess=function(){var e=t.state.selectedPath,o=t.state.containedNsID;if(!t.isPrimaryButtonDisabled()){var r=t.props,n=r.onSuccess,a=r.apiClient,i=r.onError;(0,r.onPrimaryButtonClick)(e),a.moveToFolder(e,o).then(n,i)}},t.handleCancelClick=function(){var e=t.props,o=e.onCancel;(0,e.onSecondaryButtonClick)(),o()},t.handleFolderSelected=function(e,o){t.setState({selectedPath:e}),t.setState({containedNsID:o})},t.shouldShowFolderSuggestion=function(){var e=t.props,o=e.apiClient,r=e.entries,n=e.operation;return!!e.showFolderSuggestion&&!!o.getFolderSuggestion&&(n===u.Operation.COPY||n===u.Operation.MOVE)&&!!r&&r.length>0},t.fetchFolderSuggestion=function(e){return o.__awaiter(t,void 0,void 0,function(){var t,r,n,a,i,s;return o.__generator(this,function(o){switch(o.label){case 0:return t=this.props,r=t.apiClient,n=t.entries,a=t.operation,i=n.map(function(e){return e.fq_path}),s=a===u.Operation.MOVE?"MOVE":"COPY",[4,r.getFolderSuggestion(e,i,s)];case 1:return[2,o.sent()]}})})},t.handleCreateNewFolderClick=function(){var e=t.state.selectedPath;if(void 0!==e){t.handleCancelClick();var o=t.props.user,r=function(e){t.showMoveDialog(e)},n=function(){t.showMoveDialog(e)},a=function(t){var a=t.folderName;c.browseActions.createFolderInNewFolderModal({folderName:a,isConfidential:!1,user:o,context:null,redirectOnSuccess:r,redirectOnCancel:n,fqPath:e,selectCreatedFolder:!1})};m.asyncShowCdmNewFolderModal(a,o,null,!1,!1,!1,void 0,n)}},t.showMoveDialog=function(e){var o=t.props,r=o.operation,n=o.user,a=o.apiClient,i=o.entries,s=o.initialFolderSelection,c=o.onSuccess,d=o.onCancel,f=o.showFolderSuggestion,p=o.createNewFolderInMoveDialog,m=o.showMoveDialogOnRedirect;m&&m({operation:r,modalName:r===u.Operation.MOVE?l.ModalName.MOVE:l.ModalName.COPY,user:n,apiClient:a,entries:i,initialFolderSelection:s,onSuccess:c,onCancel:d,showFolderSuggestion:f,createNewFolderInMoveDialog:p,initialFolderSelectionOnRedirect:e})},t.isPrimaryButtonDisabled=function(){return void 0===t.state.selectedPath||t.props.operation===u.Operation.MOVE&&!!n.filter(t.props.entries,function(e){return"fq_path"in e&&s.paths_are_equal(s.parent_dir(e.fq_path),t.state.selectedPath)}).length},t}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.user,s=t.initialFolderSelection,l=t.webTimer,c=t.apiClient,d=t.entries,m=t.operation,_=t.modalTitle,S=t.onError,v=t.onDataLoaded,E=t.onBreadcrumbClicked,C=t.onRowClicked,F=t.onFetchFolderSuggestionSuccess,b=t.onFolderSuggestionClick,w=t.onFolderSuggestionLocationClick,L=t.createNewFolderInMoveDialog,y=this.state.selectedPath,P=o.__assign({},c,{fetchFolderSuggestion:this.shouldShowFolderSuggestion()?this.fetchFolderSuggestion:void 0});return r.default.createElement(i.Dimensions,{className:"move_dialog mc-util-modal"},function(t){var o=t.height;return[r.default.createElement("div",{key:"header",className:"move_dialog-header mc-util-modal-header"},p.createFolderPickerDialogTitle(d,m,_)),o&&r.default.createElement("div",{key:"body",className:"move_dialog-body mc-util-modal-body",style:{height:o-(u.DIALOG_HEAD_HEIGHT+u.DIALOG_ACTIONS_HEIGHT+u.DIALOG_BODY_PADDING)}},r.default.createElement(f.FolderPicker,{user:n,apiClient:P,webTimer:l,initialPath:s,rootName:h.Viewer.get_role_title(n)||g._("Dropbox"),canSelectReadonly:!1,onFolderSelected:e.handleFolderSelected,onSuccess:e.handleSuccess,onError:S,showFolderSuggestion:e.shouldShowFolderSuggestion(),onFetchFolderSuggestionSuccess:F,onFolderSuggestionClick:b,onFolderSuggestionLocationClick:w,onDataLoaded:v,onBreadcrumbClicked:E,onRowClicked:C})),r.default.createElement("div",{key:"footer",className:"move_dialog-actions mc-util-modal-actions"},L&&void 0!==y?r.default.createElement("div",null,r.default.createElement("a",{role:"button",href:"#",onClick:e.handleCreateNewFolderClick,id:"create-new-folder"},g._("Create new folder"))):r.default.createElement("div",null),r.default.createElement("div",{className:"mc-util-modal-actions-buttons"},r.default.createElement(a.Button,{variant:"secondary",
onClick:e.handleCancelClick},g._("Cancel")),r.default.createElement(a.Button,{variant:"primary",onClick:e.handleSuccess,disabled:e.isPrimaryButtonDisabled()},p.createFolderPickerDialogButtonLabel(m))))]})},t.defaultProps={onPrimaryButtonClick:n.noop,onSecondaryButtonClick:n.noop,onError:n.noop},t})(r.default.Component);t.MoveDialogComponent=_,t.MoveDialog=d.requireCssWithComponent(_,["/static/css/react/move_dialog-vflP2sgGJ.css"])}),define("modules/clean/react/folder_dialog/utils",["require","exports","modules/core/i18n","modules/clean/react/folder_dialog/constants","modules/clean/filepath"],function(e,t,o,r,n){"use strict";function a(e,t,n){if(void 0!==n)return n;if(!e||0===e.length){if(t===r.Operation.MOVE)return o._("Move to…");if(t===r.Operation.COPY)return o._("Copy to…");if(t===r.Operation.UPLOAD)return o._("Upload to…");if(t===r.Operation.EXPORT_LEGAL_HOLD)return o._("Export to…")}var a,i=e?e.length:0;return t===r.Operation.MOVE?a=o.ungettext("Move %(num)s item to…","Move %(num)s items to…",i,{comment:'"items" is a (potential) mix of files and folders'}):t===r.Operation.COPY?a=o.ungettext("Copy %(num)s item to…","Copy %(num)s items to…",i,{comment:'"items" is a (potential) mix of files and folders'}):t===r.Operation.UPLOAD&&(a=o.ungettext("Upload %(num)s item to…","Upload %(num)s items to…",i,{comment:'"items" is a (potential) mix of files and folders'})),a.format({num:i})}function i(e){return e===r.Operation.COPY?o._("Copy"):e===r.Operation.EXPORT_LEGAL_HOLD?o._("Export"):o._("Move")}function s(e){switch(e){case r.Operation.MOVE:return"move-fileops-modal";case r.Operation.COPY:return"copy-fileops-modal";case r.Operation.UPLOAD:return"upload-fileops-modal";default:return""}}function l(e,t,o){if(void 0!==o)return o;if(e&&0!==e.length){for(var r=n.parent_dir(e[0].fq_path),a=e.length,i=1;i<a;i++)if(r!==n.parent_dir(e[i].fq_path))return t;return r}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.createFolderPickerDialogTitle=a,t.createFolderPickerDialogButtonLabel=i,t.getModalId=s,t.getInitialFolderSelection=l});
//# sourceMappingURL=pkg-mover.min.js-vflvopYV9.map