define(["require","exports","tslib","react","spectrum/dimensions","spectrum/icon_content","spectrum/icon_global","spectrum/media_table","spectrum/table","spectrum/table/table_head_cell","modules/clean/browse_interface","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/filetypes","modules/clean/search/models","modules/clean/react/icon/file_folder_icon","modules/clean/react/title_bubble","modules/clean/search/types","modules/clean/search/search_helpers","modules/core/i18n","modules/clean/search/constants"],function(e,t,l,a,n,r,i,c,s,o,m,u,d,f,_,p,b,E,h,N,T,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=l.__importDefault(a),f=l.__importStar(f),N=l.__importStar(N);var I=(function(e){function t(t){var l=e.call(this,t)||this;return l.renderRecentFilesTable=function(){return a.default.createElement(s.Table,{className:"brws-files-view-list","aria-rowcount":l.props.recentItems.size},a.default.createElement(s.TableHead,{className:"brws-column-header"},a.default.createElement(o.TableHeadCell,{className:"brws-column-header-table-cell",role:"columnheader",scope:"col"},a.default.createElement("span",null,T._("Recent"),"Â "),a.default.createElement(E.TitleBubble,{content:T._("Based on previous activity"),position:E.TitleBubble.POSITIONS.TOP},a.default.createElement("div",{className:"search-bar__dropdown-recent-files-help-icon"},a.default.createElement(i.IconGlobal,{name:"help"})))),a.default.createElement(o.TableHeadCell,{className:"brws-column-header-table-cell",role:"columnheader",scope:"col"},a.default.createElement("span",null,l.props.expRecentFiles===h.RecentFilesVariants.ON_VIEWED_DATE?T._("Viewed"):T._("Modified")))),a.default.createElement(s.TableBody,null,l.renderTableBody()))},l.renderTableBody=function(){var e=[];return l.props.recentItems.forEach(function(t){e.push(t)}),e.map(function(e,t){var n=function(a){a.stopPropagation(),a.preventDefault();var n=l.props.onRecentItemClick;n&&n(e,t)};return a.default.createElement(c.MediaRow,{className:"brws-file-row search__recent-item",onClick:n,key:"fileRow"+t},function(a){var r=a.isHovered;return[l.renderNameCell(e,t,r,n),l.renderDateCell(e)]})})},l.renderNameCell=function(e,t,r,i){return a.default.createElement(c.MediaCell,{highlight:r,icon:l.renderNameCellIcon(e,i),key:"fileName"},a.default.createElement(n.Dimensions,{className:"brws-file-name-container"},function(n){var s=n.width;return a.default.createElement("div",{className:"brws-file-name-cell-text brws-vertically-center"},a.default.createElement(c.MediaCellText,{highlight:r},l.renderNameCellTitle(e,i,s)),a.default.createElement(c.MediaCellText,{highlight:r,variant:"subtitle"},l.renderNameCellSubtitle(e,t,s)))}))},l.renderNameCellTitle=function(e,t,n){if(e instanceof p.RecentFile){var r=f.filename(e.fq_path),i=l._truncateTextInNameCell(r,C.FILE_NAME_FONT_SIZE,C.FILE_NAME_CONST_CELL_BUFFER_EM,n),c=a.default.createElement("a",{className:"brws-file-name-cell-filename",href:m.browse_uri_for_fq_path(l.props.user,e.fq_path).toString(),onClick:t},a.default.createElement("span",null,i));if(r!==i){var s=r.length<=C.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?r:a.default.createElement("div",{className:"brws-file-name-cell-tooltip"},r);c=a.default.createElement(E.TitleBubble,{content:s,position:E.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},c)}return c}var o=e instanceof p.RecentPaper?e.title:e.name,u=N.buildPaperUrl(e),i=l._truncateTextInNameCell(o,C.FILE_NAME_FONT_SIZE,C.FILE_NAME_CONST_CELL_BUFFER_EM,n);return a.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:u,onClick:t},a.default.createElement("span",null,i))},l.renderNameCellSubtitle=function(e,t,n){if(e instanceof p.RecentFile){var r=l.props.user,i=f.parent_dir(e.fq_path),c="/"===i?m.get_browse_root_name(l.props.user):i.slice(1),s=T._("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:c}),o=l._truncateTextInNameCell(s,C.FILE_LOCATION_FONT_SIZE,C.FILE_LOCATION_CONST_CELL_BUFFER_EM,n),u=m.browse_uri_for_fq_path(r,i),d=function(e){e.stopPropagation(),e.preventDefault();var a=l.props.onRecentFileLocationClick;a&&a(i,t)};return a.default.createElement("a",{className:"brws-file-name-cell-location",href:u.toString(),onClick:d},o)}return a.default.createElement("span",null,T._("in Paper",{comment:"The Dropbox Paper page"}))},l.renderNameCellIcon=function(e,t){if(e instanceof p.RecentFile){var l=e.is_dir?_.FileTypes.FOLDER:_.FileTypes.FILE;return a.default.createElement(b.FileOrFolderIcon,{className:"brws-file-name-cell-icon",file:{type:l,icon:"",fq_path:e.fq_path,thumbnail_url_tmpl:e.thumbnail_url_tmpl},showPreview:!0,variant:"small",onClick:t})}return e instanceof p.RecentPaper?a.default.createElement(r.IconContent,{className:"brws-file-name-cell-icon",name:"paper-small"}):a.default.createElement(r.IconContent,{className:"brws-file-name-cell-icon",name:"folder-small"})},l.renderDateCell=function(e){var t=l.props.expRecentFiles,n=a.default.createElement("span",{"aria-hidden":!0},"--"),r=t===h.RecentFilesVariants.ON_VIEWED_DATE?e.last_viewed_date:e.last_modified_date,i=null!==r&&void 0!==r?u.getActingTimeWithAgoEnabled(r,!1,!0,0,!0,!0,!0):n,s=t===h.RecentFilesVariants.ON_MODIFIED_DATE&&e.last_modified_name?T._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:e.last_modified_name}):void 0;return a.default.createElement(c.MediaCell,{className:"brws-file-modified-at-cell",title:i,subtitle:s,key:"fileDate"})},l}return l.__extends(t,e),t.prototype._truncateTextInNameCell=function(e,t,l,a){if(a){var n=a/t,r=Math.max(l,n-l);return d.Emstring.em_snippet(e,Math.floor(r),.5)}return e},t.prototype.render=function(){return this.props.recentItems.size>0?this.renderRecentFilesTable():null},t})(a.default.Component);t.RecentFilesTable=I});
//# sourceMappingURL=recent_files_table.min.js-vflsaEIOq.map